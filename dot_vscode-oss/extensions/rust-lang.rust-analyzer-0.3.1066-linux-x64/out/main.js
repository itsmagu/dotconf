var mv=Object.create;var li=Object.defineProperty,vv=Object.defineProperties,yv=Object.getOwnPropertyDescriptor,Cv=Object.getOwnPropertyDescriptors,wv=Object.getOwnPropertyNames,ro=Object.getOwnPropertySymbols,Rv=Object.getPrototypeOf,Rs=Object.prototype.hasOwnProperty,Hc=Object.prototype.propertyIsEnumerable;var $c=(n,e,t)=>e in n?li(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Fr=(n,e)=>{for(var t in e||(e={}))Rs.call(e,t)&&$c(n,t,e[t]);if(ro)for(var t of ro(e))Hc.call(e,t)&&$c(n,t,e[t]);return n},io=(n,e)=>vv(n,Cv(e));var Wc=(n,e)=>{var t={};for(var r in n)Rs.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&ro)for(var r of ro(n))e.indexOf(r)<0&&Hc.call(n,r)&&(t[r]=n[r]);return t};var x=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports),bv=(n,e)=>{for(var t in e)li(n,t,{get:e[t],enumerable:!0})},zc=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of wv(e))!Rs.call(n,i)&&i!==t&&li(n,i,{get:()=>e[i],enumerable:!(r=yv(e,i))||r.enumerable});return n};var qe=(n,e,t)=>(t=n!=null?mv(Rv(n)):{},zc(e||!n||!n.__esModule?li(t,"default",{value:n,enumerable:!0}):t,n)),Tv=n=>zc(li({},"__esModule",{value:!0}),n);var di=x((US,Uc)=>{var Dv="2.0.0",Sv=Number.MAX_SAFE_INTEGER||9007199254740991,_v=16;Uc.exports={SEMVER_SPEC_VERSION:Dv,MAX_LENGTH:256,MAX_SAFE_INTEGER:Sv,MAX_SAFE_COMPONENT_LENGTH:_v}});var fi=x((KS,Kc)=>{var Pv=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};Kc.exports=Pv});var pr=x((Yn,Vc)=>{var{MAX_SAFE_COMPONENT_LENGTH:bs}=di(),Ev=fi();Yn=Vc.exports={};var xv=Yn.re=[],B=Yn.src=[],G=Yn.t={},kv=0,ae=(n,e,t)=>{let r=kv++;Ev(r,e),G[n]=r,B[r]=e,xv[r]=new RegExp(e,t?"g":void 0)};ae("NUMERICIDENTIFIER","0|[1-9]\\d*");ae("NUMERICIDENTIFIERLOOSE","[0-9]+");ae("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*");ae("MAINVERSION",`(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})\\.(${B[G.NUMERICIDENTIFIER]})`);ae("MAINVERSIONLOOSE",`(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})\\.(${B[G.NUMERICIDENTIFIERLOOSE]})`);ae("PRERELEASEIDENTIFIER",`(?:${B[G.NUMERICIDENTIFIER]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASEIDENTIFIERLOOSE",`(?:${B[G.NUMERICIDENTIFIERLOOSE]}|${B[G.NONNUMERICIDENTIFIER]})`);ae("PRERELEASE",`(?:-(${B[G.PRERELEASEIDENTIFIER]}(?:\\.${B[G.PRERELEASEIDENTIFIER]})*))`);ae("PRERELEASELOOSE",`(?:-?(${B[G.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${B[G.PRERELEASEIDENTIFIERLOOSE]})*))`);ae("BUILDIDENTIFIER","[0-9A-Za-z-]+");ae("BUILD",`(?:\\+(${B[G.BUILDIDENTIFIER]}(?:\\.${B[G.BUILDIDENTIFIER]})*))`);ae("FULLPLAIN",`v?${B[G.MAINVERSION]}${B[G.PRERELEASE]}?${B[G.BUILD]}?`);ae("FULL",`^${B[G.FULLPLAIN]}$`);ae("LOOSEPLAIN",`[v=\\s]*${B[G.MAINVERSIONLOOSE]}${B[G.PRERELEASELOOSE]}?${B[G.BUILD]}?`);ae("LOOSE",`^${B[G.LOOSEPLAIN]}$`);ae("GTLT","((?:<|>)?=?)");ae("XRANGEIDENTIFIERLOOSE",`${B[G.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ae("XRANGEIDENTIFIER",`${B[G.NUMERICIDENTIFIER]}|x|X|\\*`);ae("XRANGEPLAIN",`[v=\\s]*(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:\\.(${B[G.XRANGEIDENTIFIER]})(?:${B[G.PRERELEASE]})?${B[G.BUILD]}?)?)?`);ae("XRANGEPLAINLOOSE",`[v=\\s]*(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[G.XRANGEIDENTIFIERLOOSE]})(?:${B[G.PRERELEASELOOSE]})?${B[G.BUILD]}?)?)?`);ae("XRANGE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAIN]}$`);ae("XRANGELOOSE",`^${B[G.GTLT]}\\s*${B[G.XRANGEPLAINLOOSE]}$`);ae("COERCE",`(^|[^\\d])(\\d{1,${bs}})(?:\\.(\\d{1,${bs}}))?(?:\\.(\\d{1,${bs}}))?(?:$|[^\\d])`);ae("COERCERTL",B[G.COERCE],!0);ae("LONETILDE","(?:~>?)");ae("TILDETRIM",`(\\s*)${B[G.LONETILDE]}\\s+`,!0);Yn.tildeTrimReplace="$1~";ae("TILDE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAIN]}$`);ae("TILDELOOSE",`^${B[G.LONETILDE]}${B[G.XRANGEPLAINLOOSE]}$`);ae("LONECARET","(?:\\^)");ae("CARETTRIM",`(\\s*)${B[G.LONECARET]}\\s+`,!0);Yn.caretTrimReplace="$1^";ae("CARET",`^${B[G.LONECARET]}${B[G.XRANGEPLAIN]}$`);ae("CARETLOOSE",`^${B[G.LONECARET]}${B[G.XRANGEPLAINLOOSE]}$`);ae("COMPARATORLOOSE",`^${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]})$|^$`);ae("COMPARATOR",`^${B[G.GTLT]}\\s*(${B[G.FULLPLAIN]})$|^$`);ae("COMPARATORTRIM",`(\\s*)${B[G.GTLT]}\\s*(${B[G.LOOSEPLAIN]}|${B[G.XRANGEPLAIN]})`,!0);Yn.comparatorTrimReplace="$1$2$3";ae("HYPHENRANGE",`^\\s*(${B[G.XRANGEPLAIN]})\\s+-\\s+(${B[G.XRANGEPLAIN]})\\s*$`);ae("HYPHENRANGELOOSE",`^\\s*(${B[G.XRANGEPLAINLOOSE]})\\s+-\\s+(${B[G.XRANGEPLAINLOOSE]})\\s*$`);ae("STAR","(<|>)?=?\\s*\\*");ae("GTE0","^\\s*>=\\s*0.0.0\\s*$");ae("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$")});var pi=x((VS,Bc)=>{var qv=["includePrerelease","loose","rtl"],Ov=n=>n?typeof n!="object"?{loose:!0}:qv.filter(e=>n[e]).reduce((e,t)=>(e[t]=!0,e),{}):{};Bc.exports=Ov});var oo=x((BS,Qc)=>{var Gc=/^[0-9]+$/,Xc=(n,e)=>{let t=Gc.test(n),r=Gc.test(e);return t&&r&&(n=+n,e=+e),n===e?0:t&&!r?-1:r&&!t?1:n<e?-1:1},Iv=(n,e)=>Xc(e,n);Qc.exports={compareIdentifiers:Xc,rcompareIdentifiers:Iv}});var Ct=x((GS,eu)=>{var so=fi(),{MAX_LENGTH:Jc,MAX_SAFE_INTEGER:ao}=di(),{re:Yc,t:Zc}=pr(),Nv=pi(),{compareIdentifiers:hi}=oo(),Qt=class{constructor(e,t){if(t=Nv(t),e instanceof Qt){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid Version: ${e}`);if(e.length>Jc)throw new TypeError(`version is longer than ${Jc} characters`);so("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let r=e.trim().match(t.loose?Yc[Zc.LOOSE]:Yc[Zc.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>ao||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ao||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ao||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let o=+i;if(o>=0&&o<ao)return o}return i}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(so("SemVer.compare",this.version,this.options,e),!(e instanceof Qt)){if(typeof e=="string"&&e===this.version)return 0;e=new Qt(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof Qt||(e=new Qt(e,this.options)),hi(this.major,e.major)||hi(this.minor,e.minor)||hi(this.patch,e.patch)}comparePre(e){if(e instanceof Qt||(e=new Qt(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let r=this.prerelease[t],i=e.prerelease[t];if(so("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return hi(r,i)}while(++t)}compareBuild(e){e instanceof Qt||(e=new Qt(e,this.options));let t=0;do{let r=this.build[t],i=e.build[t];if(so("prerelease compare",t,r,i),r===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(r===void 0)return-1;if(r===i)continue;return hi(r,i)}while(++t)}inc(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t),this.inc("pre",t);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{let r=this.prerelease.length;for(;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}t&&(this.prerelease[0]===t?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error(`invalid increment argument: ${e}`)}return this.format(),this.raw=this.version,this}};eu.exports=Qt});var hr=x((XS,iu)=>{var{MAX_LENGTH:Fv}=di(),{re:tu,t:nu}=pr(),ru=Ct(),Lv=pi(),Av=(n,e)=>{if(e=Lv(e),n instanceof ru)return n;if(typeof n!="string"||n.length>Fv||!(e.loose?tu[nu.LOOSE]:tu[nu.FULL]).test(n))return null;try{return new ru(n,e)}catch{return null}};iu.exports=Av});var su=x((QS,ou)=>{var Mv=hr(),jv=(n,e)=>{let t=Mv(n,e);return t?t.version:null};ou.exports=jv});var cu=x((JS,au)=>{var $v=hr(),Hv=(n,e)=>{let t=$v(n.trim().replace(/^[=v]+/,""),e);return t?t.version:null};au.exports=Hv});var lu=x((YS,uu)=>{var Wv=Ct(),zv=(n,e,t,r)=>{typeof t=="string"&&(r=t,t=void 0);try{return new Wv(n,t).inc(e,r).version}catch{return null}};uu.exports=zv});var Jt=x((ZS,fu)=>{var du=Ct(),Uv=(n,e,t)=>new du(n,t).compare(new du(e,t));fu.exports=Uv});var co=x((e_,pu)=>{var Kv=Jt(),Vv=(n,e,t)=>Kv(n,e,t)===0;pu.exports=Vv});var mu=x((t_,gu)=>{var hu=hr(),Bv=co(),Gv=(n,e)=>{if(Bv(n,e))return null;{let t=hu(n),r=hu(e),i=t.prerelease.length||r.prerelease.length,o=i?"pre":"",s=i?"prerelease":"";for(let a in t)if((a==="major"||a==="minor"||a==="patch")&&t[a]!==r[a])return o+a;return s}};gu.exports=Gv});var yu=x((n_,vu)=>{var Xv=Ct(),Qv=(n,e)=>new Xv(n,e).major;vu.exports=Qv});var wu=x((r_,Cu)=>{var Jv=Ct(),Yv=(n,e)=>new Jv(n,e).minor;Cu.exports=Yv});var bu=x((i_,Ru)=>{var Zv=Ct(),ey=(n,e)=>new Zv(n,e).patch;Ru.exports=ey});var Du=x((o_,Tu)=>{var ty=hr(),ny=(n,e)=>{let t=ty(n,e);return t&&t.prerelease.length?t.prerelease:null};Tu.exports=ny});var _u=x((s_,Su)=>{var ry=Jt(),iy=(n,e,t)=>ry(e,n,t);Su.exports=iy});var Eu=x((a_,Pu)=>{var oy=Jt(),sy=(n,e)=>oy(n,e,!0);Pu.exports=sy});var uo=x((c_,ku)=>{var xu=Ct(),ay=(n,e,t)=>{let r=new xu(n,t),i=new xu(e,t);return r.compare(i)||r.compareBuild(i)};ku.exports=ay});var Ou=x((u_,qu)=>{var cy=uo(),uy=(n,e)=>n.sort((t,r)=>cy(t,r,e));qu.exports=uy});var Nu=x((l_,Iu)=>{var ly=uo(),dy=(n,e)=>n.sort((t,r)=>ly(r,t,e));Iu.exports=dy});var gi=x((d_,Fu)=>{var fy=Jt(),py=(n,e,t)=>fy(n,e,t)>0;Fu.exports=py});var lo=x((f_,Lu)=>{var hy=Jt(),gy=(n,e,t)=>hy(n,e,t)<0;Lu.exports=gy});var Ts=x((p_,Au)=>{var my=Jt(),vy=(n,e,t)=>my(n,e,t)!==0;Au.exports=vy});var fo=x((h_,Mu)=>{var yy=Jt(),Cy=(n,e,t)=>yy(n,e,t)>=0;Mu.exports=Cy});var po=x((g_,ju)=>{var wy=Jt(),Ry=(n,e,t)=>wy(n,e,t)<=0;ju.exports=Ry});var Ds=x((m_,$u)=>{var by=co(),Ty=Ts(),Dy=gi(),Sy=fo(),_y=lo(),Py=po(),Ey=(n,e,t,r)=>{switch(e){case"===":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n===t;case"!==":return typeof n=="object"&&(n=n.version),typeof t=="object"&&(t=t.version),n!==t;case"":case"=":case"==":return by(n,t,r);case"!=":return Ty(n,t,r);case">":return Dy(n,t,r);case">=":return Sy(n,t,r);case"<":return _y(n,t,r);case"<=":return Py(n,t,r);default:throw new TypeError(`Invalid operator: ${e}`)}};$u.exports=Ey});var Wu=x((v_,Hu)=>{var xy=Ct(),ky=hr(),{re:ho,t:go}=pr(),qy=(n,e)=>{if(n instanceof xy)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;e=e||{};let t=null;if(!e.rtl)t=n.match(ho[go.COERCE]);else{let r;for(;(r=ho[go.COERCERTL].exec(n))&&(!t||t.index+t[0].length!==n.length);)(!t||r.index+r[0].length!==t.index+t[0].length)&&(t=r),ho[go.COERCERTL].lastIndex=r.index+r[1].length+r[2].length;ho[go.COERCERTL].lastIndex=-1}return t===null?null:ky(`${t[2]}.${t[3]||"0"}.${t[4]||"0"}`,e)};Hu.exports=qy});var Uu=x((y_,zu)=>{"use strict";zu.exports=function(n){n.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}});var Vu=x((C_,Ku)=>{"use strict";Ku.exports=ve;ve.Node=gr;ve.create=ve;function ve(n){var e=this;if(e instanceof ve||(e=new ve),e.tail=null,e.head=null,e.length=0,n&&typeof n.forEach=="function")n.forEach(function(i){e.push(i)});else if(arguments.length>0)for(var t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);return e}ve.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var e=n.next,t=n.prev;return e&&(e.prev=t),t&&(t.next=e),n===this.head&&(this.head=e),n===this.tail&&(this.tail=t),n.list.length--,n.next=null,n.prev=null,n.list=null,e};ve.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var e=this.head;n.list=this,n.next=e,e&&(e.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};ve.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var e=this.tail;n.list=this,n.prev=e,e&&(e.next=n),this.tail=n,this.head||(this.head=n),this.length++}};ve.prototype.push=function(){for(var n=0,e=arguments.length;n<e;n++)Iy(this,arguments[n]);return this.length};ve.prototype.unshift=function(){for(var n=0,e=arguments.length;n<e;n++)Ny(this,arguments[n]);return this.length};ve.prototype.pop=function(){if(!!this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};ve.prototype.shift=function(){if(!!this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};ve.prototype.forEach=function(n,e){e=e||this;for(var t=this.head,r=0;t!==null;r++)n.call(e,t.value,r,this),t=t.next};ve.prototype.forEachReverse=function(n,e){e=e||this;for(var t=this.tail,r=this.length-1;t!==null;r--)n.call(e,t.value,r,this),t=t.prev};ve.prototype.get=function(n){for(var e=0,t=this.head;t!==null&&e<n;e++)t=t.next;if(e===n&&t!==null)return t.value};ve.prototype.getReverse=function(n){for(var e=0,t=this.tail;t!==null&&e<n;e++)t=t.prev;if(e===n&&t!==null)return t.value};ve.prototype.map=function(n,e){e=e||this;for(var t=new ve,r=this.head;r!==null;)t.push(n.call(e,r.value,this)),r=r.next;return t};ve.prototype.mapReverse=function(n,e){e=e||this;for(var t=new ve,r=this.tail;r!==null;)t.push(n.call(e,r.value,this)),r=r.prev;return t};ve.prototype.reduce=function(n,e){var t,r=this.head;if(arguments.length>1)t=e;else if(this.head)r=this.head.next,t=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;r!==null;i++)t=n(t,r.value,i),r=r.next;return t};ve.prototype.reduceReverse=function(n,e){var t,r=this.tail;if(arguments.length>1)t=e;else if(this.tail)r=this.tail.prev,t=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;r!==null;i--)t=n(t,r.value,i),r=r.prev;return t};ve.prototype.toArray=function(){for(var n=new Array(this.length),e=0,t=this.head;t!==null;e++)n[e]=t.value,t=t.next;return n};ve.prototype.toArrayReverse=function(){for(var n=new Array(this.length),e=0,t=this.tail;t!==null;e++)n[e]=t.value,t=t.prev;return n};ve.prototype.slice=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(;i!==null&&r<e;r++,i=i.next)t.push(i.value);return t};ve.prototype.sliceReverse=function(n,e){e=e||this.length,e<0&&(e+=this.length),n=n||0,n<0&&(n+=this.length);var t=new ve;if(e<n||e<0)return t;n<0&&(n=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;i!==null&&r>e;r--)i=i.prev;for(;i!==null&&r>n;r--,i=i.prev)t.push(i.value);return t};ve.prototype.splice=function(n,e,...t){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var r=0,i=this.head;i!==null&&r<n;r++)i=i.next;for(var o=[],r=0;i&&r<e;r++)o.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var r=0;r<t.length;r++)i=Oy(this,i,t[r]);return o};ve.prototype.reverse=function(){for(var n=this.head,e=this.tail,t=n;t!==null;t=t.prev){var r=t.prev;t.prev=t.next,t.next=r}return this.head=e,this.tail=n,this};function Oy(n,e,t){var r=e===n.head?new gr(t,null,e,n):new gr(t,e,e.next,n);return r.next===null&&(n.tail=r),r.prev===null&&(n.head=r),n.length++,r}function Iy(n,e){n.tail=new gr(e,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function Ny(n,e){n.head=new gr(e,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function gr(n,e,t,r){if(!(this instanceof gr))return new gr(n,e,t,r);this.list=r,this.value=n,e?(e.next=this,this.prev=e):this.prev=null,t?(t.prev=this,this.next=t):this.next=null}try{Uu()(ve)}catch{}});var Zu=x((w_,Yu)=>{"use strict";var Fy=Vu(),mr=Symbol("max"),Ln=Symbol("length"),Lr=Symbol("lengthCalculator"),vi=Symbol("allowStale"),vr=Symbol("maxAge"),Fn=Symbol("dispose"),Bu=Symbol("noDisposeOnSet"),ot=Symbol("lruList"),sn=Symbol("cache"),Xu=Symbol("updateAgeOnGet"),Ss=()=>1,Qu=class{constructor(e){if(typeof e=="number"&&(e={max:e}),e||(e={}),e.max&&(typeof e.max!="number"||e.max<0))throw new TypeError("max must be a non-negative number");let t=this[mr]=e.max||1/0,r=e.length||Ss;if(this[Lr]=typeof r!="function"?Ss:r,this[vi]=e.stale||!1,e.maxAge&&typeof e.maxAge!="number")throw new TypeError("maxAge must be a number");this[vr]=e.maxAge||0,this[Fn]=e.dispose,this[Bu]=e.noDisposeOnSet||!1,this[Xu]=e.updateAgeOnGet||!1,this.reset()}set max(e){if(typeof e!="number"||e<0)throw new TypeError("max must be a non-negative number");this[mr]=e||1/0,mi(this)}get max(){return this[mr]}set allowStale(e){this[vi]=!!e}get allowStale(){return this[vi]}set maxAge(e){if(typeof e!="number")throw new TypeError("maxAge must be a non-negative number");this[vr]=e,mi(this)}get maxAge(){return this[vr]}set lengthCalculator(e){typeof e!="function"&&(e=Ss),e!==this[Lr]&&(this[Lr]=e,this[Ln]=0,this[ot].forEach(t=>{t.length=this[Lr](t.value,t.key),this[Ln]+=t.length})),mi(this)}get lengthCalculator(){return this[Lr]}get length(){return this[Ln]}get itemCount(){return this[ot].length}rforEach(e,t){t=t||this;for(let r=this[ot].tail;r!==null;){let i=r.prev;Gu(this,e,r,t),r=i}}forEach(e,t){t=t||this;for(let r=this[ot].head;r!==null;){let i=r.next;Gu(this,e,r,t),r=i}}keys(){return this[ot].toArray().map(e=>e.key)}values(){return this[ot].toArray().map(e=>e.value)}reset(){this[Fn]&&this[ot]&&this[ot].length&&this[ot].forEach(e=>this[Fn](e.key,e.value)),this[sn]=new Map,this[ot]=new Fy,this[Ln]=0}dump(){return this[ot].map(e=>mo(this,e)?!1:{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[ot]}set(e,t,r){if(r=r||this[vr],r&&typeof r!="number")throw new TypeError("maxAge must be a number");let i=r?Date.now():0,o=this[Lr](t,e);if(this[sn].has(e)){if(o>this[mr])return Ar(this,this[sn].get(e)),!1;let c=this[sn].get(e).value;return this[Fn]&&(this[Bu]||this[Fn](e,c.value)),c.now=i,c.maxAge=r,c.value=t,this[Ln]+=o-c.length,c.length=o,this.get(e),mi(this),!0}let s=new Ju(e,t,o,i,r);return s.length>this[mr]?(this[Fn]&&this[Fn](e,t),!1):(this[Ln]+=s.length,this[ot].unshift(s),this[sn].set(e,this[ot].head),mi(this),!0)}has(e){if(!this[sn].has(e))return!1;let t=this[sn].get(e).value;return!mo(this,t)}get(e){return _s(this,e,!0)}peek(e){return _s(this,e,!1)}pop(){let e=this[ot].tail;return e?(Ar(this,e),e.value):null}del(e){Ar(this,this[sn].get(e))}load(e){this.reset();let t=Date.now();for(let r=e.length-1;r>=0;r--){let i=e[r],o=i.e||0;if(o===0)this.set(i.k,i.v);else{let s=o-t;s>0&&this.set(i.k,i.v,s)}}}prune(){this[sn].forEach((e,t)=>_s(this,t,!1))}},_s=(n,e,t)=>{let r=n[sn].get(e);if(r){let i=r.value;if(mo(n,i)){if(Ar(n,r),!n[vi])return}else t&&(n[Xu]&&(r.value.now=Date.now()),n[ot].unshiftNode(r));return i.value}},mo=(n,e)=>{if(!e||!e.maxAge&&!n[vr])return!1;let t=Date.now()-e.now;return e.maxAge?t>e.maxAge:n[vr]&&t>n[vr]},mi=n=>{if(n[Ln]>n[mr])for(let e=n[ot].tail;n[Ln]>n[mr]&&e!==null;){let t=e.prev;Ar(n,e),e=t}},Ar=(n,e)=>{if(e){let t=e.value;n[Fn]&&n[Fn](t.key,t.value),n[Ln]-=t.length,n[sn].delete(t.key),n[ot].removeNode(e)}},Ju=class{constructor(e,t,r,i,o){this.key=e,this.value=t,this.length=r,this.now=i,this.maxAge=o||0}},Gu=(n,e,t,r)=>{let i=t.value;mo(n,i)&&(Ar(n,t),n[vi]||(i=void 0)),i&&e.call(r,i.value,i.key,n)};Yu.exports=Qu});var Yt=x((R_,rl)=>{var Mr=class{constructor(e,t){if(t=Ay(t),e instanceof Mr)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Mr(e.raw,t);if(e instanceof Ps)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e,this.set=e.split(/\s*\|\|\s*/).map(r=>this.parseRange(r.trim())).filter(r=>r.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${e}`);if(this.set.length>1){let r=this.set[0];if(this.set=this.set.filter(i=>!tl(i[0])),this.set.length===0)this.set=[r];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&Wy(i[0])){this.set=[i];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){e=e.trim();let r=`parseRange:${Object.keys(this.options).join(",")}:${e}`,i=el.get(r);if(i)return i;let o=this.options.loose,s=o?wt[lt.HYPHENRANGELOOSE]:wt[lt.HYPHENRANGE];e=e.replace(s,Yy(this.options.includePrerelease)),Ke("hyphen replace",e),e=e.replace(wt[lt.COMPARATORTRIM],jy),Ke("comparator trim",e,wt[lt.COMPARATORTRIM]),e=e.replace(wt[lt.TILDETRIM],$y),e=e.replace(wt[lt.CARETTRIM],Hy),e=e.split(/\s+/).join(" ");let a=o?wt[lt.COMPARATORLOOSE]:wt[lt.COMPARATOR],c=e.split(" ").map(h=>zy(h,this.options)).join(" ").split(/\s+/).map(h=>Jy(h,this.options)).filter(this.options.loose?h=>!!h.match(a):()=>!0).map(h=>new Ps(h,this.options)),l=c.length,g=new Map;for(let h of c){if(tl(h))return[h];g.set(h.value,h)}g.size>1&&g.has("")&&g.delete("");let v=[...g.values()];return el.set(r,v),v}intersects(e,t){if(!(e instanceof Mr))throw new TypeError("a Range is required");return this.set.some(r=>nl(r,t)&&e.set.some(i=>nl(i,t)&&r.every(o=>i.every(s=>o.intersects(s,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new My(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(Zy(this.set[t],e,this.options))return!0;return!1}};rl.exports=Mr;var Ly=Zu(),el=new Ly({max:1e3}),Ay=pi(),Ps=yi(),Ke=fi(),My=Ct(),{re:wt,t:lt,comparatorTrimReplace:jy,tildeTrimReplace:$y,caretTrimReplace:Hy}=pr(),tl=n=>n.value==="<0.0.0-0",Wy=n=>n.value==="",nl=(n,e)=>{let t=!0,r=n.slice(),i=r.pop();for(;t&&r.length;)t=r.every(o=>i.intersects(o,e)),i=r.pop();return t},zy=(n,e)=>(Ke("comp",n,e),n=Vy(n,e),Ke("caret",n),n=Uy(n,e),Ke("tildes",n),n=Gy(n,e),Ke("xrange",n),n=Qy(n,e),Ke("stars",n),n),Pt=n=>!n||n.toLowerCase()==="x"||n==="*",Uy=(n,e)=>n.trim().split(/\s+/).map(t=>Ky(t,e)).join(" "),Ky=(n,e)=>{let t=e.loose?wt[lt.TILDELOOSE]:wt[lt.TILDE];return n.replace(t,(r,i,o,s,a)=>{Ke("tilde",n,r,i,o,s,a);let c;return Pt(i)?c="":Pt(o)?c=`>=${i}.0.0 <${+i+1}.0.0-0`:Pt(s)?c=`>=${i}.${o}.0 <${i}.${+o+1}.0-0`:a?(Ke("replaceTilde pr",a),c=`>=${i}.${o}.${s}-${a} <${i}.${+o+1}.0-0`):c=`>=${i}.${o}.${s} <${i}.${+o+1}.0-0`,Ke("tilde return",c),c})},Vy=(n,e)=>n.trim().split(/\s+/).map(t=>By(t,e)).join(" "),By=(n,e)=>{Ke("caret",n,e);let t=e.loose?wt[lt.CARETLOOSE]:wt[lt.CARET],r=e.includePrerelease?"-0":"";return n.replace(t,(i,o,s,a,c)=>{Ke("caret",n,i,o,s,a,c);let l;return Pt(o)?l="":Pt(s)?l=`>=${o}.0.0${r} <${+o+1}.0.0-0`:Pt(a)?o==="0"?l=`>=${o}.${s}.0${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.0${r} <${+o+1}.0.0-0`:c?(Ke("replaceCaret pr",c),o==="0"?s==="0"?l=`>=${o}.${s}.${a}-${c} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a}-${c} <${+o+1}.0.0-0`):(Ke("no pr"),o==="0"?s==="0"?l=`>=${o}.${s}.${a}${r} <${o}.${s}.${+a+1}-0`:l=`>=${o}.${s}.${a}${r} <${o}.${+s+1}.0-0`:l=`>=${o}.${s}.${a} <${+o+1}.0.0-0`),Ke("caret return",l),l})},Gy=(n,e)=>(Ke("replaceXRanges",n,e),n.split(/\s+/).map(t=>Xy(t,e)).join(" ")),Xy=(n,e)=>{n=n.trim();let t=e.loose?wt[lt.XRANGELOOSE]:wt[lt.XRANGE];return n.replace(t,(r,i,o,s,a,c)=>{Ke("xRange",n,r,i,o,s,a,c);let l=Pt(o),g=l||Pt(s),v=g||Pt(a),h=v;return i==="="&&h&&(i=""),c=e.includePrerelease?"-0":"",l?i===">"||i==="<"?r="<0.0.0-0":r="*":i&&h?(g&&(s=0),a=0,i===">"?(i=">=",g?(o=+o+1,s=0,a=0):(s=+s+1,a=0)):i==="<="&&(i="<",g?o=+o+1:s=+s+1),i==="<"&&(c="-0"),r=`${i+o}.${s}.${a}${c}`):g?r=`>=${o}.0.0${c} <${+o+1}.0.0-0`:v&&(r=`>=${o}.${s}.0${c} <${o}.${+s+1}.0-0`),Ke("xRange return",r),r})},Qy=(n,e)=>(Ke("replaceStars",n,e),n.trim().replace(wt[lt.STAR],"")),Jy=(n,e)=>(Ke("replaceGTE0",n,e),n.trim().replace(wt[e.includePrerelease?lt.GTE0PRE:lt.GTE0],"")),Yy=n=>(e,t,r,i,o,s,a,c,l,g,v,h,C)=>(Pt(r)?t="":Pt(i)?t=`>=${r}.0.0${n?"-0":""}`:Pt(o)?t=`>=${r}.${i}.0${n?"-0":""}`:s?t=`>=${t}`:t=`>=${t}${n?"-0":""}`,Pt(l)?c="":Pt(g)?c=`<${+l+1}.0.0-0`:Pt(v)?c=`<${l}.${+g+1}.0-0`:h?c=`<=${l}.${g}.${v}-${h}`:n?c=`<${l}.${g}.${+v+1}-0`:c=`<=${c}`,`${t} ${c}`.trim()),Zy=(n,e,t)=>{for(let r=0;r<n.length;r++)if(!n[r].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let r=0;r<n.length;r++)if(Ke(n[r].semver),n[r].semver!==Ps.ANY&&n[r].semver.prerelease.length>0){let i=n[r].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var yi=x((b_,cl)=>{var Ci=Symbol("SemVer ANY"),wi=class{static get ANY(){return Ci}constructor(e,t){if(t=eC(t),e instanceof wi){if(e.loose===!!t.loose)return e;e=e.value}xs("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Ci?this.value="":this.value=this.operator+this.semver.version,xs("comp",this)}parse(e){let t=this.options.loose?il[ol.COMPARATORLOOSE]:il[ol.COMPARATOR],r=e.match(t);if(!r)throw new TypeError(`Invalid comparator: ${e}`);this.operator=r[1]!==void 0?r[1]:"",this.operator==="="&&(this.operator=""),r[2]?this.semver=new sl(r[2],this.options.loose):this.semver=Ci}toString(){return this.value}test(e){if(xs("Comparator.test",e,this.options.loose),this.semver===Ci||e===Ci)return!0;if(typeof e=="string")try{e=new sl(e,this.options)}catch{return!1}return Es(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof wi))throw new TypeError("a Comparator is required");if((!t||typeof t!="object")&&(t={loose:!!t,includePrerelease:!1}),this.operator==="")return this.value===""?!0:new al(e.value,t).test(this.value);if(e.operator==="")return e.value===""?!0:new al(this.value,t).test(e.semver);let r=(this.operator===">="||this.operator===">")&&(e.operator===">="||e.operator===">"),i=(this.operator==="<="||this.operator==="<")&&(e.operator==="<="||e.operator==="<"),o=this.semver.version===e.semver.version,s=(this.operator===">="||this.operator==="<=")&&(e.operator===">="||e.operator==="<="),a=Es(this.semver,"<",e.semver,t)&&(this.operator===">="||this.operator===">")&&(e.operator==="<="||e.operator==="<"),c=Es(this.semver,">",e.semver,t)&&(this.operator==="<="||this.operator==="<")&&(e.operator===">="||e.operator===">");return r||i||o&&s||a||c}};cl.exports=wi;var eC=pi(),{re:il,t:ol}=pr(),Es=Ds(),xs=fi(),sl=Ct(),al=Yt()});var Ri=x((T_,ul)=>{var tC=Yt(),nC=(n,e,t)=>{try{e=new tC(e,t)}catch{return!1}return e.test(n)};ul.exports=nC});var dl=x((D_,ll)=>{var rC=Yt(),iC=(n,e)=>new rC(n,e).set.map(t=>t.map(r=>r.value).join(" ").trim().split(" "));ll.exports=iC});var pl=x((S_,fl)=>{var oC=Ct(),sC=Yt(),aC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new sC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===-1)&&(r=s,i=new oC(r,t))}),r};fl.exports=aC});var gl=x((__,hl)=>{var cC=Ct(),uC=Yt(),lC=(n,e,t)=>{let r=null,i=null,o=null;try{o=new uC(e,t)}catch{return null}return n.forEach(s=>{o.test(s)&&(!r||i.compare(s)===1)&&(r=s,i=new cC(r,t))}),r};hl.exports=lC});var yl=x((P_,vl)=>{var ks=Ct(),dC=Yt(),ml=gi(),fC=(n,e)=>{n=new dC(n,e);let t=new ks("0.0.0");if(n.test(t)||(t=new ks("0.0.0-0"),n.test(t)))return t;t=null;for(let r=0;r<n.set.length;++r){let i=n.set[r],o=null;i.forEach(s=>{let a=new ks(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!o||ml(a,o))&&(o=a);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${s.operator}`)}}),o&&(!t||ml(t,o))&&(t=o)}return t&&n.test(t)?t:null};vl.exports=fC});var wl=x((E_,Cl)=>{var pC=Yt(),hC=(n,e)=>{try{return new pC(n,e).range||"*"}catch{return null}};Cl.exports=hC});var vo=x((x_,Dl)=>{var gC=Ct(),Tl=yi(),{ANY:mC}=Tl,vC=Yt(),yC=Ri(),Rl=gi(),bl=lo(),CC=po(),wC=fo(),RC=(n,e,t,r)=>{n=new gC(n,r),e=new vC(e,r);let i,o,s,a,c;switch(t){case">":i=Rl,o=CC,s=bl,a=">",c=">=";break;case"<":i=bl,o=wC,s=Rl,a="<",c="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(yC(n,e,r))return!1;for(let l=0;l<e.set.length;++l){let g=e.set[l],v=null,h=null;if(g.forEach(C=>{C.semver===mC&&(C=new Tl(">=0.0.0")),v=v||C,h=h||C,i(C.semver,v.semver,r)?v=C:s(C.semver,h.semver,r)&&(h=C)}),v.operator===a||v.operator===c||(!h.operator||h.operator===a)&&o(n,h.semver))return!1;if(h.operator===c&&s(n,h.semver))return!1}return!0};Dl.exports=RC});var _l=x((k_,Sl)=>{var bC=vo(),TC=(n,e,t)=>bC(n,e,">",t);Sl.exports=TC});var El=x((q_,Pl)=>{var DC=vo(),SC=(n,e,t)=>DC(n,e,"<",t);Pl.exports=SC});var ql=x((O_,kl)=>{var xl=Yt(),_C=(n,e,t)=>(n=new xl(n,t),e=new xl(e,t),n.intersects(e));kl.exports=_C});var Il=x((I_,Ol)=>{var PC=Ri(),EC=Jt();Ol.exports=(n,e,t)=>{let r=[],i=null,o=null,s=n.sort((g,v)=>EC(g,v,t));for(let g of s)PC(g,e,t)?(o=g,i||(i=g)):(o&&r.push([i,o]),o=null,i=null);i&&r.push([i,null]);let a=[];for(let[g,v]of r)g===v?a.push(g):!v&&g===s[0]?a.push("*"):v?g===s[0]?a.push(`<=${v}`):a.push(`${g} - ${v}`):a.push(`>=${g}`);let c=a.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return c.length<l.length?c:e}});var Ml=x((N_,Al)=>{var Nl=Yt(),yo=yi(),{ANY:qs}=yo,bi=Ri(),Os=Jt(),xC=(n,e,t={})=>{if(n===e)return!0;n=new Nl(n,t),e=new Nl(e,t);let r=!1;e:for(let i of n.set){for(let o of e.set){let s=kC(i,o,t);if(r=r||s!==null,s)continue e}if(r)return!1}return!0},kC=(n,e,t)=>{if(n===e)return!0;if(n.length===1&&n[0].semver===qs){if(e.length===1&&e[0].semver===qs)return!0;t.includePrerelease?n=[new yo(">=0.0.0-0")]:n=[new yo(">=0.0.0")]}if(e.length===1&&e[0].semver===qs){if(t.includePrerelease)return!0;e=[new yo(">=0.0.0")]}let r=new Set,i,o;for(let C of n)C.operator===">"||C.operator===">="?i=Fl(i,C,t):C.operator==="<"||C.operator==="<="?o=Ll(o,C,t):r.add(C.semver);if(r.size>1)return null;let s;if(i&&o){if(s=Os(i.semver,o.semver,t),s>0)return null;if(s===0&&(i.operator!==">="||o.operator!=="<="))return null}for(let C of r){if(i&&!bi(C,String(i),t)||o&&!bi(C,String(o),t))return null;for(let b of e)if(!bi(C,String(b),t))return!1;return!0}let a,c,l,g,v=o&&!t.includePrerelease&&o.semver.prerelease.length?o.semver:!1,h=i&&!t.includePrerelease&&i.semver.prerelease.length?i.semver:!1;v&&v.prerelease.length===1&&o.operator==="<"&&v.prerelease[0]===0&&(v=!1);for(let C of e){if(g=g||C.operator===">"||C.operator===">=",l=l||C.operator==="<"||C.operator==="<=",i){if(h&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===h.major&&C.semver.minor===h.minor&&C.semver.patch===h.patch&&(h=!1),C.operator===">"||C.operator===">="){if(a=Fl(i,C,t),a===C&&a!==i)return!1}else if(i.operator===">="&&!bi(i.semver,String(C),t))return!1}if(o){if(v&&C.semver.prerelease&&C.semver.prerelease.length&&C.semver.major===v.major&&C.semver.minor===v.minor&&C.semver.patch===v.patch&&(v=!1),C.operator==="<"||C.operator==="<="){if(c=Ll(o,C,t),c===C&&c!==o)return!1}else if(o.operator==="<="&&!bi(o.semver,String(C),t))return!1}if(!C.operator&&(o||i)&&s!==0)return!1}return!(i&&l&&!o&&s!==0||o&&g&&!i&&s!==0||h||v)},Fl=(n,e,t)=>{if(!n)return e;let r=Os(n.semver,e.semver,t);return r>0?n:r<0||e.operator===">"&&n.operator===">="?e:n},Ll=(n,e,t)=>{if(!n)return e;let r=Os(n.semver,e.semver,t);return r<0?n:r>0||e.operator==="<"&&n.operator==="<="?e:n};Al.exports=xC});var $l=x((F_,jl)=>{var Is=pr();jl.exports={re:Is.re,src:Is.src,tokens:Is.t,SEMVER_SPEC_VERSION:di().SEMVER_SPEC_VERSION,SemVer:Ct(),compareIdentifiers:oo().compareIdentifiers,rcompareIdentifiers:oo().rcompareIdentifiers,parse:hr(),valid:su(),clean:cu(),inc:lu(),diff:mu(),major:yu(),minor:wu(),patch:bu(),prerelease:Du(),compare:Jt(),rcompare:_u(),compareLoose:Eu(),compareBuild:uo(),sort:Ou(),rsort:Nu(),gt:gi(),lt:lo(),eq:co(),neq:Ts(),gte:fo(),lte:po(),cmp:Ds(),coerce:Wu(),Comparator:yi(),Range:Yt(),satisfies:Ri(),toComparators:dl(),maxSatisfying:pl(),minSatisfying:gl(),minVersion:yl(),validRange:wl(),outside:vo(),gtr:_l(),ltr:El(),intersects:ql(),simplifyRange:Il(),subset:Ml()}});var Rn=x(We=>{"use strict";Object.defineProperty(We,"__esModule",{value:!0});We.asPromise=We.thenable=We.typedArray=We.stringArray=We.array=We.func=We.error=We.number=We.string=We.boolean=void 0;function qC(n){return n===!0||n===!1}We.boolean=qC;function Hl(n){return typeof n=="string"||n instanceof String}We.string=Hl;function OC(n){return typeof n=="number"||n instanceof Number}We.number=OC;function IC(n){return n instanceof Error}We.error=IC;function Wl(n){return typeof n=="function"}We.func=Wl;function zl(n){return Array.isArray(n)}We.array=zl;function NC(n){return zl(n)&&n.every(e=>Hl(e))}We.stringArray=NC;function FC(n,e){return Array.isArray(n)&&n.every(e)}We.typedArray=FC;function Ul(n){return n&&Wl(n.then)}We.thenable=Ul;function LC(n){return n instanceof Promise?n:Ul(n)?new Promise((e,t)=>{n.then(r=>e(r),r=>t(r))}):Promise.resolve(n)}We.asPromise=LC});var An=x(Ls=>{"use strict";Object.defineProperty(Ls,"__esModule",{value:!0});var Ns;function Fs(){if(Ns===void 0)throw new Error("No runtime abstraction layer installed");return Ns}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");Ns=t}n.install=e})(Fs||(Fs={}));Ls.default=Fs});var As=x(Ti=>{"use strict";Object.defineProperty(Ti,"__esModule",{value:!0});Ti.Disposable=void 0;var AC;(function(n){function e(t){return{dispose:t}}n.create=e})(AC=Ti.Disposable||(Ti.Disposable={}))});var Vl=x(Co=>{"use strict";Object.defineProperty(Co,"__esModule",{value:!0});Co.AbstractMessageBuffer=void 0;var MC=13,jC=10,$C=`\r
`,Kl=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(){if(this._chunks.length===0)return;let e=0,t=0,r=0,i=0;e:for(;t<this._chunks.length;){let c=this._chunks[t];r=0;t:for(;r<c.length;){switch(c[r]){case MC:switch(e){case 0:e=1;break;case 2:e=3;break;default:e=0}break;case jC:switch(e){case 1:e=2;break;case 3:e=4,r++;break e;default:e=0}break;default:e=0}r++}i+=c.byteLength,t++}if(e!==4)return;let o=this._read(i+r),s=new Map,a=this.toString(o,"ascii").split($C);if(a.length<2)return s;for(let c=0;c<a.length-2;c++){let l=a[c],g=l.indexOf(":");if(g===-1)throw new Error("Message header must separate key and value using :");let v=l.substr(0,g),h=l.substr(g+1).trim();s.set(v,h)}return s}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let o=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(o)}if(this._chunks[0].byteLength>e){let o=this._chunks[0],s=this.asNative(o,e);return this._chunks[0]=o.slice(e),this._totalLength-=e,s}let t=this.allocNative(e),r=0,i=0;for(;e>0;){let o=this._chunks[i];if(o.byteLength>e){let s=o.slice(0,e);t.set(s,r),r+=e,this._chunks[i]=o.slice(e),this._totalLength-=e,e-=e}else t.set(o,r),r+=o.byteLength,this._chunks.shift(),this._totalLength-=o.byteLength,e-=o.byteLength}return t}};Co.AbstractMessageBuffer=Kl});var Jl=x(js=>{"use strict";Object.defineProperty(js,"__esModule",{value:!0});var HC=An(),Bl=require("util"),yr=As(),WC=Vl(),Di=class extends WC.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return Di.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new Bl.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Di.emptyBuffer=Buffer.allocUnsafe(0);var Gl=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),yr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),yr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),yr.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),yr.Disposable.create(()=>this.stream.off("data",e))}},Xl=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),yr.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),yr.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),yr.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((r,i)=>{let o=s=>{s==null?r():i(s)};typeof e=="string"?this.stream.write(e,t,o):this.stream.write(e,o)})}end(){this.stream.end()}},Ql=Object.freeze({messageBuffer:Object.freeze({create:n=>new Di(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(n,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{try{return n instanceof Buffer?Promise.resolve(JSON.parse(n.toString(e.charset))):Promise.resolve(JSON.parse(new Bl.TextDecoder(e.charset).decode(n)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:n=>new Gl(n),asWritableStream:n=>new Xl(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){let r=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(r)}},setImmediate(n,...e){let t=setImmediate(n,...e);return{dispose:()=>clearImmediate(t)}},setInterval(n,e,...t){let r=setInterval(n,e,...t);return{dispose:()=>clearInterval(r)}}})});function Ms(){return Ql}(function(n){function e(){HC.default.install(Ql)}n.install=e})(Ms||(Ms={}));js.default=Ms});var jr=x(Rt=>{"use strict";Object.defineProperty(Rt,"__esModule",{value:!0});Rt.stringArray=Rt.array=Rt.func=Rt.error=Rt.number=Rt.string=Rt.boolean=void 0;function zC(n){return n===!0||n===!1}Rt.boolean=zC;function Yl(n){return typeof n=="string"||n instanceof String}Rt.string=Yl;function UC(n){return typeof n=="number"||n instanceof Number}Rt.number=UC;function KC(n){return n instanceof Error}Rt.error=KC;function VC(n){return typeof n=="function"}Rt.func=VC;function Zl(n){return Array.isArray(n)}Rt.array=Zl;function BC(n){return Zl(n)&&n.every(e=>Yl(e))}Rt.stringArray=BC});var $s=x(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.Message=Q.NotificationType9=Q.NotificationType8=Q.NotificationType7=Q.NotificationType6=Q.NotificationType5=Q.NotificationType4=Q.NotificationType3=Q.NotificationType2=Q.NotificationType1=Q.NotificationType0=Q.NotificationType=Q.RequestType9=Q.RequestType8=Q.RequestType7=Q.RequestType6=Q.RequestType5=Q.RequestType4=Q.RequestType3=Q.RequestType2=Q.RequestType1=Q.RequestType=Q.RequestType0=Q.AbstractMessageSignature=Q.ParameterStructures=Q.ResponseError=Q.ErrorCodes=void 0;var Cr=jr(),ed;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=n.jsonrpcReservedErrorRangeStart,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=n.jsonrpcReservedErrorRangeEnd})(ed=Q.ErrorCodes||(Q.ErrorCodes={}));var wo=class extends Error{constructor(e,t,r){super(t);this.code=Cr.number(e)?e:ed.UnknownErrorCode,this.data=r,Object.setPrototypeOf(this,wo.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};Q.ResponseError=wo;var dt=class{constructor(e){this.kind=e}static is(e){return e===dt.auto||e===dt.byName||e===dt.byPosition}toString(){return this.kind}};Q.ParameterStructures=dt;dt.auto=new dt("auto");dt.byPosition=new dt("byPosition");dt.byName=new dt("byName");var Ie=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return dt.auto}};Q.AbstractMessageSignature=Ie;var td=class extends Ie{constructor(e){super(e,0)}};Q.RequestType0=td;var nd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType=nd;var rd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType1=rd;var id=class extends Ie{constructor(e){super(e,2)}};Q.RequestType2=id;var od=class extends Ie{constructor(e){super(e,3)}};Q.RequestType3=od;var sd=class extends Ie{constructor(e){super(e,4)}};Q.RequestType4=sd;var ad=class extends Ie{constructor(e){super(e,5)}};Q.RequestType5=ad;var cd=class extends Ie{constructor(e){super(e,6)}};Q.RequestType6=cd;var ud=class extends Ie{constructor(e){super(e,7)}};Q.RequestType7=ud;var ld=class extends Ie{constructor(e){super(e,8)}};Q.RequestType8=ld;var dd=class extends Ie{constructor(e){super(e,9)}};Q.RequestType9=dd;var fd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType=fd;var pd=class extends Ie{constructor(e){super(e,0)}};Q.NotificationType0=pd;var hd=class extends Ie{constructor(e,t=dt.auto){super(e,1);this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType1=hd;var gd=class extends Ie{constructor(e){super(e,2)}};Q.NotificationType2=gd;var md=class extends Ie{constructor(e){super(e,3)}};Q.NotificationType3=md;var vd=class extends Ie{constructor(e){super(e,4)}};Q.NotificationType4=vd;var yd=class extends Ie{constructor(e){super(e,5)}};Q.NotificationType5=yd;var Cd=class extends Ie{constructor(e){super(e,6)}};Q.NotificationType6=Cd;var wd=class extends Ie{constructor(e){super(e,7)}};Q.NotificationType7=wd;var Rd=class extends Ie{constructor(e){super(e,8)}};Q.NotificationType8=Rd;var bd=class extends Ie{constructor(e){super(e,9)}};Q.NotificationType9=bd;var GC;(function(n){function e(i){let o=i;return o&&Cr.string(o.method)&&(Cr.string(o.id)||Cr.number(o.id))}n.isRequest=e;function t(i){let o=i;return o&&Cr.string(o.method)&&i.id===void 0}n.isNotification=t;function r(i){let o=i;return o&&(o.result!==void 0||!!o.error)&&(Cr.string(o.id)||Cr.number(o.id)||o.id===null)}n.isResponse=r})(GC=Q.Message||(Q.Message={}))});var Ws=x(Mn=>{"use strict";var Td;Object.defineProperty(Mn,"__esModule",{value:!0});Mn.LRUCache=Mn.LinkedMap=Mn.Touch=void 0;var Et;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Et=Mn.Touch||(Mn.Touch={}));var Hs=class{constructor(){this[Td]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Et.None){let r=this._map.get(e);if(!!r)return t!==Et.None&&this.touch(r,t),r.value}set(e,t,r=Et.None){let i=this._map.get(e);if(i)i.value=t,r!==Et.None&&this.touch(i,r);else{switch(i={key:e,value:t,next:void 0,previous:void 0},r){case Et.None:this.addItemLast(i);break;case Et.First:this.addItemFirst(i);break;case Et.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(!!t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let r=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==r)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}values(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}entries(){let e=this._state,t=this._head,r={[Symbol.iterator]:()=>r,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return r}[(Td=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,r=this.size;for(;t&&r>e;)this._map.delete(t.key),t=t.next,r--;this._head=t,this._size=r,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,r=e.previous;if(!t||!r)throw new Error("Invalid list");t.previous=r,r.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Et.First&&t!==Et.Last)){if(t===Et.First){if(e===this._head)return;let r=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(r.previous=i,i.next=r),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Et.Last){if(e===this._tail)return;let r=e.next,i=e.previous;e===this._head?(r.previous=void 0,this._head=r):(r.previous=i,i.next=r),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,r)=>{e.push([r,t])}),e}fromJSON(e){this.clear();for(let[t,r]of e)this.set(t,r)}};Mn.LinkedMap=Hs;var Dd=class extends Hs{constructor(e,t=1){super();this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Et.AsNew){return super.get(e,t)}peek(e){return super.get(e,Et.None)}set(e,t){return super.set(e,t,Et.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Mn.LRUCache=Dd});var $r=x(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.Emitter=wr.Event=void 0;var XC=An(),QC;(function(n){let e={dispose(){}};n.None=function(){return e}})(QC=wr.Event||(wr.Event={}));var Sd=class{add(e,t=null,r){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(r)&&r.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let r=!1;for(let i=0,o=this._callbacks.length;i<o;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else r=!0;if(r)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],r=this._callbacks.slice(0),i=this._contexts.slice(0);for(let o=0,s=r.length;o<s;o++)try{t.push(r[o].apply(i[o],e))}catch(a){(0,XC.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},Si=class{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,r)=>{this._callbacks||(this._callbacks=new Sd),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{!this._callbacks||(this._callbacks.remove(e,t),i.dispose=Si._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(r)&&r.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};wr.Emitter=Si;Si._noop=function(){}});var Vs=x(Rr=>{"use strict";Object.defineProperty(Rr,"__esModule",{value:!0});Rr.CancellationTokenSource=Rr.CancellationToken=void 0;var JC=An(),YC=jr(),zs=$r(),Us;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:zs.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:zs.Event.None});function e(t){let r=t;return r&&(r===n.None||r===n.Cancelled||YC.boolean(r.isCancellationRequested)&&!!r.onCancellationRequested)}n.is=e})(Us=Rr.CancellationToken||(Rr.CancellationToken={}));var ZC=Object.freeze(function(n,e){let t=(0,JC.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}}),Ks=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?ZC:(this._emitter||(this._emitter=new zs.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},_d=class{get token(){return this._token||(this._token=new Ks),this._token}cancel(){this._token?this._token.cancel():this._token=Us.Cancelled}dispose(){this._token?this._token instanceof Ks&&this._token.dispose():this._token=Us.None}};Rr.CancellationTokenSource=_d});var Ed=x(jn=>{"use strict";Object.defineProperty(jn,"__esModule",{value:!0});jn.ReadableStreamMessageReader=jn.AbstractMessageReader=jn.MessageReader=void 0;var Gs=An(),Hr=jr(),Bs=$r(),ew;(function(n){function e(t){let r=t;return r&&Hr.func(r.listen)&&Hr.func(r.dispose)&&Hr.func(r.onError)&&Hr.func(r.onClose)&&Hr.func(r.onPartialMessage)}n.is=e})(ew=jn.MessageReader||(jn.MessageReader={}));var Qs=class{constructor(){this.errorEmitter=new Bs.Emitter,this.closeEmitter=new Bs.Emitter,this.partialMessageEmitter=new Bs.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Hr.string(e.message)?e.message:"unknown"}`)}};jn.AbstractMessageReader=Qs;var Xs;(function(n){function e(t){let r,i,o,s=new Map,a,c=new Map;if(t===void 0||typeof t=="string")r=t??"utf-8";else{if(r=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,s.set(o.name,o)),t.contentDecoders!==void 0)for(let l of t.contentDecoders)s.set(l.name,l);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,c.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let l of t.contentTypeDecoders)c.set(l.name,l)}return a===void 0&&(a=(0,Gs.default)().applicationJson.decoder,c.set(a.name,a)),{charset:r,contentDecoder:o,contentDecoders:s,contentTypeDecoder:a,contentTypeDecoders:c}}n.fromOptions=e})(Xs||(Xs={}));var Pd=class extends Qs{constructor(e,t){super();this.readable=e,this.options=Xs.fromOptions(t),this.buffer=(0,Gs.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(r=>{this.onData(r)});return this.readable.onError(r=>this.fireError(r)),this.readable.onClose(()=>this.fireClose()),t}onData(e){for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let i=this.buffer.tryReadHeaders();if(!i)return;let o=i.get("Content-Length");if(!o)throw new Error("Header must provide a Content-Length property.");let s=parseInt(o);if(isNaN(s))throw new Error("Content-Length value must be a number.");this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1;let r;this.options.contentDecoder!==void 0?r=this.options.contentDecoder.decode(t):r=Promise.resolve(t),r.then(i=>{this.options.contentTypeDecoder.decode(i,this.options).then(o=>{this.callback(o)},o=>{this.fireError(o)})},i=>{this.fireError(i)})}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Gs.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};jn.ReadableStreamMessageReader=Pd});var kd=x(Ro=>{"use strict";Object.defineProperty(Ro,"__esModule",{value:!0});Ro.Semaphore=void 0;var tw=An(),xd=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,tw.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Ro.Semaphore=xd});var Fd=x($n=>{"use strict";Object.defineProperty($n,"__esModule",{value:!0});$n.WriteableStreamMessageWriter=$n.AbstractMessageWriter=$n.MessageWriter=void 0;var qd=An(),_i=jr(),nw=kd(),Od=$r(),rw="Content-Length: ",Id=`\r
`,iw;(function(n){function e(t){let r=t;return r&&_i.func(r.dispose)&&_i.func(r.onClose)&&_i.func(r.onError)&&_i.func(r.write)}n.is=e})(iw=$n.MessageWriter||($n.MessageWriter={}));var Ys=class{constructor(){this.errorEmitter=new Od.Emitter,this.closeEmitter=new Od.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,r){this.errorEmitter.fire([this.asError(e),t,r])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${_i.string(e.message)?e.message:"unknown"}`)}};$n.AbstractMessageWriter=Ys;var Js;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,qd.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,qd.default)().applicationJson.encoder}}n.fromOptions=e})(Js||(Js={}));var Nd=class extends Ys{constructor(e,t){super();this.writable=e,this.options=Js.fromOptions(t),this.errorCount=0,this.writeSemaphore=new nw.Semaphore(1),this.writable.onError(r=>this.fireError(r)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(r=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(r):r).then(r=>{let i=[];return i.push(rw,r.byteLength.toString(),Id),i.push(Id),this.doWrite(e,i,r)},r=>{throw this.fireError(r),r}))}async doWrite(e,t,r){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(r)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};$n.WriteableStreamMessageWriter=Nd});var Wd=x(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.createMessageConnection=Z.ConnectionOptions=Z.CancellationStrategy=Z.CancellationSenderStrategy=Z.CancellationReceiverStrategy=Z.ConnectionStrategy=Z.ConnectionError=Z.ConnectionErrors=Z.LogTraceNotification=Z.SetTraceNotification=Z.TraceFormat=Z.Trace=Z.NullLogger=Z.ProgressType=Z.ProgressToken=void 0;var Ld=An(),nt=jr(),te=$s(),Ad=Ws(),Pi=$r(),Zs=Vs(),xi;(function(n){n.type=new te.NotificationType("$/cancelRequest")})(xi||(xi={}));var Md;(function(n){function e(t){return typeof t=="string"||typeof t=="number"}n.is=e})(Md=Z.ProgressToken||(Z.ProgressToken={}));var Ei;(function(n){n.type=new te.NotificationType("$/progress")})(Ei||(Ei={}));var jd=class{constructor(){}};Z.ProgressType=jd;var ea;(function(n){function e(t){return nt.func(t)}n.is=e})(ea||(ea={}));Z.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var be;(function(n){n[n.Off=0]="Off",n[n.Messages=1]="Messages",n[n.Compact=2]="Compact",n[n.Verbose=3]="Verbose"})(be=Z.Trace||(Z.Trace={}));(function(n){function e(r){if(!nt.string(r))return n.Off;switch(r=r.toLowerCase(),r){case"off":return n.Off;case"messages":return n.Messages;case"compact":return n.Compact;case"verbose":return n.Verbose;default:return n.Off}}n.fromString=e;function t(r){switch(r){case n.Off:return"off";case n.Messages:return"messages";case n.Compact:return"compact";case n.Verbose:return"verbose";default:return"off"}}n.toString=t})(be=Z.Trace||(Z.Trace={}));var an;(function(n){n.Text="text",n.JSON="json"})(an=Z.TraceFormat||(Z.TraceFormat={}));(function(n){function e(t){return nt.string(t)?(t=t.toLowerCase(),t==="json"?n.JSON:n.Text):n.Text}n.fromString=e})(an=Z.TraceFormat||(Z.TraceFormat={}));var $d;(function(n){n.type=new te.NotificationType("$/setTrace")})($d=Z.SetTraceNotification||(Z.SetTraceNotification={}));var ta;(function(n){n.type=new te.NotificationType("$/logTrace")})(ta=Z.LogTraceNotification||(Z.LogTraceNotification={}));var bo;(function(n){n[n.Closed=1]="Closed",n[n.Disposed=2]="Disposed",n[n.AlreadyListening=3]="AlreadyListening"})(bo=Z.ConnectionErrors||(Z.ConnectionErrors={}));var br=class extends Error{constructor(e,t){super(t);this.code=e,Object.setPrototypeOf(this,br.prototype)}};Z.ConnectionError=br;var Hd;(function(n){function e(t){let r=t;return r&&nt.func(r.cancelUndispatched)}n.is=e})(Hd=Z.ConnectionStrategy||(Z.ConnectionStrategy={}));var na;(function(n){n.Message=Object.freeze({createCancellationTokenSource(t){return new Zs.CancellationTokenSource}});function e(t){let r=t;return r&&nt.func(r.createCancellationTokenSource)}n.is=e})(na=Z.CancellationReceiverStrategy||(Z.CancellationReceiverStrategy={}));var ra;(function(n){n.Message=Object.freeze({sendCancellation(t,r){return t.sendNotification(xi.type,{id:r})},cleanup(t){}});function e(t){let r=t;return r&&nt.func(r.sendCancellation)&&nt.func(r.cleanup)}n.is=e})(ra=Z.CancellationSenderStrategy||(Z.CancellationSenderStrategy={}));var ia;(function(n){n.Message=Object.freeze({receiver:na.Message,sender:ra.Message});function e(t){let r=t;return r&&na.is(r.receiver)&&ra.is(r.sender)}n.is=e})(ia=Z.CancellationStrategy||(Z.CancellationStrategy={}));var ow;(function(n){function e(t){let r=t;return r&&(ia.is(r.cancellationStrategy)||Hd.is(r.connectionStrategy))}n.is=e})(ow=Z.ConnectionOptions||(Z.ConnectionOptions={}));var cn;(function(n){n[n.New=1]="New",n[n.Listening=2]="Listening",n[n.Closed=3]="Closed",n[n.Disposed=4]="Disposed"})(cn||(cn={}));function sw(n,e,t,r){let i=t!==void 0?t:Z.NullLogger,o=0,s=0,a=0,c="2.0",l,g=new Map,v,h=new Map,C=new Map,b,k=new Ad.LinkedMap,I=new Map,O=new Set,M=new Map,q=be.Off,$=an.Text,K,fe=cn.New,Y=new Pi.Emitter,He=new Pi.Emitter,Ge=new Pi.Emitter,rt=new Pi.Emitter,Dt=new Pi.Emitter,gt=r&&r.cancellationStrategy?r.cancellationStrategy:ia.Message;function mt(R){if(R===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+R.toString()}function St(R){return R===null?"res-unknown-"+(++a).toString():"res-"+R.toString()}function at(){return"not-"+(++s).toString()}function vt(R,N){te.Message.isRequest(N)?R.set(mt(N.id),N):te.Message.isResponse(N)?R.set(St(N.id),N):R.set(at(),N)}function xn(R){}function Le(){return fe===cn.Listening}function tt(){return fe===cn.Closed}function ct(){return fe===cn.Disposed}function Nt(){(fe===cn.New||fe===cn.Listening)&&(fe=cn.Closed,He.fire(void 0))}function Xe(R){Y.fire([R,void 0,void 0])}function ur(R){Y.fire(R)}n.onClose(Nt),n.onError(Xe),e.onClose(Nt),e.onError(ur);function Vn(){b||k.size===0||(b=(0,Ld.default)().timer.setImmediate(()=>{b=void 0,Bn()}))}function Bn(){if(k.size===0)return;let R=k.shift();try{te.Message.isRequest(R)?qn(R):te.Message.isNotification(R)?Gn(R):te.Message.isResponse(R)?lr(R):Xn(R)}finally{Vn()}}let kn=R=>{try{if(te.Message.isNotification(R)&&R.method===xi.type.method){let N=R.params.id,H=mt(N),V=k.get(H);if(te.Message.isRequest(V)){let ge=r==null?void 0:r.connectionStrategy,me=ge&&ge.cancelUndispatched?ge.cancelUndispatched(V,xn):void 0;if(me&&(me.error!==void 0||me.result!==void 0)){k.delete(H),M.delete(N),me.id=V.id,Mt(me,R.method,Date.now()),e.write(me).catch(()=>i.error("Sending response for canceled message failed."));return}}let he=M.get(N);if(he!==void 0){he.cancel(),Cn(R);return}else O.add(N)}vt(k,R)}finally{Vn()}};function qn(R){if(ct())return;function N(ce,Ce,ue){let p={jsonrpc:c,id:R.id};ce instanceof te.ResponseError?p.error=ce.toJson():p.result=ce===void 0?null:ce,Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}function H(ce,Ce,ue){let p={jsonrpc:c,id:R.id,error:ce.toJson()};Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}function V(ce,Ce,ue){ce===void 0&&(ce=null);let p={jsonrpc:c,id:R.id,result:ce};Mt(p,Ce,ue),e.write(p).catch(()=>i.error("Sending response failed."))}On(R);let he=g.get(R.method),ge,me;he&&(ge=he.type,me=he.handler);let ke=Date.now();if(me||l){let ce=R.id??String(Date.now()),Ce=gt.receiver.createCancellationTokenSource(ce);R.id!==null&&O.has(R.id)&&Ce.cancel(),R.id!==null&&M.set(ce,Ce);try{let ue;if(me)if(R.params===void 0){if(ge!==void 0&&ge.numberOfParams!==0){H(new te.ResponseError(te.ErrorCodes.InvalidParams,`Request ${R.method} defines ${ge.numberOfParams} params but received none.`),R.method,ke);return}ue=me(Ce.token)}else if(Array.isArray(R.params)){if(ge!==void 0&&ge.parameterStructures===te.ParameterStructures.byName){H(new te.ResponseError(te.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by name but received parameters by position`),R.method,ke);return}ue=me(...R.params,Ce.token)}else{if(ge!==void 0&&ge.parameterStructures===te.ParameterStructures.byPosition){H(new te.ResponseError(te.ErrorCodes.InvalidParams,`Request ${R.method} defines parameters by position but received parameters by name`),R.method,ke);return}ue=me(R.params,Ce.token)}else l&&(ue=l(R.method,R.params,Ce.token));let p=ue;ue?p.then?p.then(E=>{M.delete(ce),N(E,R.method,ke)},E=>{M.delete(ce),E instanceof te.ResponseError?H(E,R.method,ke):E&&nt.string(E.message)?H(new te.ResponseError(te.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${E.message}`),R.method,ke):H(new te.ResponseError(te.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,ke)}):(M.delete(ce),N(ue,R.method,ke)):(M.delete(ce),V(ue,R.method,ke))}catch(ue){M.delete(ce),ue instanceof te.ResponseError?N(ue,R.method,ke):ue&&nt.string(ue.message)?H(new te.ResponseError(te.ErrorCodes.InternalError,`Request ${R.method} failed with message: ${ue.message}`),R.method,ke):H(new te.ResponseError(te.ErrorCodes.InternalError,`Request ${R.method} failed unexpectedly without providing any details.`),R.method,ke)}}else H(new te.ResponseError(te.ErrorCodes.MethodNotFound,`Unhandled method ${R.method}`),R.method,ke)}function lr(R){if(!ct())if(R.id===null)R.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(R.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let N=R.id,H=I.get(N);if(jt(R,H),H!==void 0){I.delete(N);try{if(R.error){let V=R.error;H.reject(new te.ResponseError(V.code,V.message,V.data))}else if(R.result!==void 0)H.resolve(R.result);else throw new Error("Should never happen.")}catch(V){V.message?i.error(`Response handler '${H.method}' failed with message: ${V.message}`):i.error(`Response handler '${H.method}' failed unexpectedly.`)}}}}function Gn(R){if(ct())return;let N,H;if(R.method===xi.type.method){let V=R.params.id;O.delete(V),Cn(R);return}else{let V=h.get(R.method);V&&(H=V.handler,N=V.type)}if(H||v)try{if(Cn(R),H)if(R.params===void 0)N!==void 0&&N.numberOfParams!==0&&N.parameterStructures!==te.ParameterStructures.byName&&i.error(`Notification ${R.method} defines ${N.numberOfParams} params but received none.`),H();else if(Array.isArray(R.params)){let V=R.params;R.method===Ei.type.method&&V.length===2&&Md.is(V[0])?H({token:V[0],value:V[1]}):(N!==void 0&&(N.parameterStructures===te.ParameterStructures.byName&&i.error(`Notification ${R.method} defines parameters by name but received parameters by position`),N.numberOfParams!==R.params.length&&i.error(`Notification ${R.method} defines ${N.numberOfParams} params but received ${V.length} arguments`)),H(...V))}else N!==void 0&&N.parameterStructures===te.ParameterStructures.byPosition&&i.error(`Notification ${R.method} defines parameters by position but received parameters by name`),H(R.params);else v&&v(R.method,R.params)}catch(V){V.message?i.error(`Notification handler '${R.method}' failed with message: ${V.message}`):i.error(`Notification handler '${R.method}' failed unexpectedly.`)}else Ge.fire(R)}function Xn(R){if(!R){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(R,null,4)}`);let N=R;if(nt.string(N.id)||nt.number(N.id)){let H=N.id,V=I.get(H);V&&V.reject(new Error("The received response has neither a result nor an error property."))}}function yt(R){if(R!=null)switch(q){case be.Verbose:return JSON.stringify(R,null,4);case be.Compact:return JSON.stringify(R);default:return}}function Bt(R){if(!(q===be.Off||!K))if($===an.Text){let N;(q===be.Verbose||q===be.Compact)&&R.params&&(N=`Params: ${yt(R.params)}

`),K.log(`Sending request '${R.method} - (${R.id})'.`,N)}else Ft("send-request",R)}function Qn(R){if(!(q===be.Off||!K))if($===an.Text){let N;(q===be.Verbose||q===be.Compact)&&(R.params?N=`Params: ${yt(R.params)}

`:N=`No parameters provided.

`),K.log(`Sending notification '${R.method}'.`,N)}else Ft("send-notification",R)}function Mt(R,N,H){if(!(q===be.Off||!K))if($===an.Text){let V;(q===be.Verbose||q===be.Compact)&&(R.error&&R.error.data?V=`Error data: ${yt(R.error.data)}

`:R.result?V=`Result: ${yt(R.result)}

`:R.error===void 0&&(V=`No result returned.

`)),K.log(`Sending response '${N} - (${R.id})'. Processing request took ${Date.now()-H}ms`,V)}else Ft("send-response",R)}function On(R){if(!(q===be.Off||!K))if($===an.Text){let N;(q===be.Verbose||q===be.Compact)&&R.params&&(N=`Params: ${yt(R.params)}

`),K.log(`Received request '${R.method} - (${R.id})'.`,N)}else Ft("receive-request",R)}function Cn(R){if(!(q===be.Off||!K||R.method===ta.type.method))if($===an.Text){let N;(q===be.Verbose||q===be.Compact)&&(R.params?N=`Params: ${yt(R.params)}

`:N=`No parameters provided.

`),K.log(`Received notification '${R.method}'.`,N)}else Ft("receive-notification",R)}function jt(R,N){if(!(q===be.Off||!K))if($===an.Text){let H;if((q===be.Verbose||q===be.Compact)&&(R.error&&R.error.data?H=`Error data: ${yt(R.error.data)}

`:R.result?H=`Result: ${yt(R.result)}

`:R.error===void 0&&(H=`No result returned.

`)),N){let V=R.error?` Request failed: ${R.error.message} (${R.error.code}).`:"";K.log(`Received response '${N.method} - (${R.id})' in ${Date.now()-N.timerStart}ms.${V}`,H)}else K.log(`Received response ${R.id} without active response promise.`,H)}else Ft("receive-response",R)}function Ft(R,N){if(!K||q===be.Off)return;let H={isLSPMessage:!0,type:R,message:N,timestamp:Date.now()};K.log(H)}function Qe(){if(tt())throw new br(bo.Closed,"Connection is closed.");if(ct())throw new br(bo.Disposed,"Connection is disposed.")}function dr(){if(Le())throw new br(bo.AlreadyListening,"Connection is already listening")}function _t(){if(!Le())throw new Error("Call listen() first.")}function $t(R){return R===void 0?null:R}function wn(R){if(R!==null)return R}function In(R){return R!=null&&!Array.isArray(R)&&typeof R=="object"}function Nn(R,N){switch(R){case te.ParameterStructures.auto:return In(N)?wn(N):[$t(N)];case te.ParameterStructures.byName:if(!In(N))throw new Error("Received parameters by name but param is not an object literal.");return wn(N);case te.ParameterStructures.byPosition:return[$t(N)];default:throw new Error(`Unknown parameter structure ${R.toString()}`)}}function Ht(R,N){let H,V=R.numberOfParams;switch(V){case 0:H=void 0;break;case 1:H=Nn(R.parameterStructures,N[0]);break;default:H=[];for(let he=0;he<N.length&&he<V;he++)H.push($t(N[he]));if(N.length<V)for(let he=N.length;he<V;he++)H.push(null);break}return H}let Gt={sendNotification:(R,...N)=>{Qe();let H,V;if(nt.string(R)){H=R;let ge=N[0],me=0,ke=te.ParameterStructures.auto;te.ParameterStructures.is(ge)&&(me=1,ke=ge);let ce=N.length,Ce=ce-me;switch(Ce){case 0:V=void 0;break;case 1:V=Nn(ke,N[me]);break;default:if(ke===te.ParameterStructures.byName)throw new Error(`Received ${Ce} parameters for 'by Name' notification parameter structure.`);V=N.slice(me,ce).map(ue=>$t(ue));break}}else{let ge=N;H=R.method,V=Ht(R,ge)}let he={jsonrpc:c,method:H,params:V};return Qn(he),e.write(he).catch(()=>i.error("Sending notification failed."))},onNotification:(R,N)=>{Qe();let H;return nt.func(R)?v=R:N&&(nt.string(R)?(H=R,h.set(R,{type:void 0,handler:N})):(H=R.method,h.set(R.method,{type:R,handler:N}))),{dispose:()=>{H!==void 0?h.delete(H):v=void 0}}},onProgress:(R,N,H)=>{if(C.has(N))throw new Error(`Progress handler for token ${N} already registered`);return C.set(N,H),{dispose:()=>{C.delete(N)}}},sendProgress:(R,N,H)=>Gt.sendNotification(Ei.type,{token:N,value:H}),onUnhandledProgress:rt.event,sendRequest:(R,...N)=>{Qe(),_t();let H,V,he;if(nt.string(R)){H=R;let ce=N[0],Ce=N[N.length-1],ue=0,p=te.ParameterStructures.auto;te.ParameterStructures.is(ce)&&(ue=1,p=ce);let E=N.length;Zs.CancellationToken.is(Ce)&&(E=E-1,he=Ce);let z=E-ue;switch(z){case 0:V=void 0;break;case 1:V=Nn(p,N[ue]);break;default:if(p===te.ParameterStructures.byName)throw new Error(`Received ${z} parameters for 'by Name' request parameter structure.`);V=N.slice(ue,E).map(S=>$t(S));break}}else{let ce=N;H=R.method,V=Ht(R,ce);let Ce=R.numberOfParams;he=Zs.CancellationToken.is(ce[Ce])?ce[Ce]:void 0}let ge=o++,me;return he&&(me=he.onCancellationRequested(()=>{let ce=gt.sender.sendCancellation(Gt,ge);return ce===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${ge}`),Promise.resolve()):ce.catch(()=>{i.log(`Sending cancellation messages for id ${ge} failed`)})})),new Promise((ce,Ce)=>{let ue={jsonrpc:c,id:ge,method:H,params:V},p=S=>{ce(S),gt.sender.cleanup(ge),me==null||me.dispose()},E=S=>{Ce(S),gt.sender.cleanup(ge),me==null||me.dispose()},z={method:H,timerStart:Date.now(),resolve:p,reject:E};Bt(ue);try{e.write(ue).catch(()=>i.error("Sending request failed."))}catch(S){z.reject(new te.ResponseError(te.ErrorCodes.MessageWriteError,S.message?S.message:"Unknown reason")),z=null}z&&I.set(ge,z)})},onRequest:(R,N)=>{Qe();let H=null;return ea.is(R)?(H=void 0,l=R):nt.string(R)?(H=null,N!==void 0&&(H=R,g.set(R,{handler:N,type:void 0}))):N!==void 0&&(H=R.method,g.set(R.method,{type:R,handler:N})),{dispose:()=>{H!==null&&(H!==void 0?g.delete(H):l=void 0)}}},trace:(R,N,H)=>{let V=!1,he=an.Text;H!==void 0&&(nt.boolean(H)?V=H:(V=H.sendNotification||!1,he=H.traceFormat||an.Text)),q=R,$=he,q===be.Off?K=void 0:K=N,V&&!tt()&&!ct()&&Gt.sendNotification($d.type,{value:be.toString(R)}).catch(()=>{i.error("Sending trace notification failed")})},onError:Y.event,onClose:He.event,onUnhandledNotification:Ge.event,onDispose:Dt.event,end:()=>{e.end()},dispose:()=>{if(ct())return;fe=cn.Disposed,Dt.fire(void 0);let R=new Error("Connection got disposed.");for(let N of I.values())N.reject(R);I=new Map,M=new Map,O=new Set,k=new Ad.LinkedMap,nt.func(e.dispose)&&e.dispose(),nt.func(n.dispose)&&n.dispose()},listen:()=>{Qe(),dr(),fe=cn.Listening,n.listen(kn)},inspect:()=>{(0,Ld.default)().console.log("inspect")}};return Gt.onNotification(ta.type,R=>{if(q===be.Off||!K)return;let N=q===be.Verbose||q===be.Compact;K.log(R.message,N?R.verbose:void 0)}),Gt.onNotification(Ei.type,R=>{let N=C.get(R.token);N?N(R.value):rt.fire(R)}),Gt}Z.createMessageConnection=sw});var ca=x(L=>{"use strict";Object.defineProperty(L,"__esModule",{value:!0});L.SetTraceNotification=L.TraceFormat=L.Trace=L.ProgressType=L.ProgressToken=L.createMessageConnection=L.NullLogger=L.ConnectionOptions=L.ConnectionStrategy=L.WriteableStreamMessageWriter=L.AbstractMessageWriter=L.MessageWriter=L.ReadableStreamMessageReader=L.AbstractMessageReader=L.MessageReader=L.CancellationToken=L.CancellationTokenSource=L.Emitter=L.Event=L.Disposable=L.LRUCache=L.Touch=L.LinkedMap=L.ParameterStructures=L.NotificationType9=L.NotificationType8=L.NotificationType7=L.NotificationType6=L.NotificationType5=L.NotificationType4=L.NotificationType3=L.NotificationType2=L.NotificationType1=L.NotificationType0=L.NotificationType=L.ErrorCodes=L.ResponseError=L.RequestType9=L.RequestType8=L.RequestType7=L.RequestType6=L.RequestType5=L.RequestType4=L.RequestType3=L.RequestType2=L.RequestType1=L.RequestType0=L.RequestType=L.Message=L.RAL=void 0;L.CancellationStrategy=L.CancellationSenderStrategy=L.CancellationReceiverStrategy=L.ConnectionError=L.ConnectionErrors=L.LogTraceNotification=void 0;var Ee=$s();Object.defineProperty(L,"Message",{enumerable:!0,get:function(){return Ee.Message}});Object.defineProperty(L,"RequestType",{enumerable:!0,get:function(){return Ee.RequestType}});Object.defineProperty(L,"RequestType0",{enumerable:!0,get:function(){return Ee.RequestType0}});Object.defineProperty(L,"RequestType1",{enumerable:!0,get:function(){return Ee.RequestType1}});Object.defineProperty(L,"RequestType2",{enumerable:!0,get:function(){return Ee.RequestType2}});Object.defineProperty(L,"RequestType3",{enumerable:!0,get:function(){return Ee.RequestType3}});Object.defineProperty(L,"RequestType4",{enumerable:!0,get:function(){return Ee.RequestType4}});Object.defineProperty(L,"RequestType5",{enumerable:!0,get:function(){return Ee.RequestType5}});Object.defineProperty(L,"RequestType6",{enumerable:!0,get:function(){return Ee.RequestType6}});Object.defineProperty(L,"RequestType7",{enumerable:!0,get:function(){return Ee.RequestType7}});Object.defineProperty(L,"RequestType8",{enumerable:!0,get:function(){return Ee.RequestType8}});Object.defineProperty(L,"RequestType9",{enumerable:!0,get:function(){return Ee.RequestType9}});Object.defineProperty(L,"ResponseError",{enumerable:!0,get:function(){return Ee.ResponseError}});Object.defineProperty(L,"ErrorCodes",{enumerable:!0,get:function(){return Ee.ErrorCodes}});Object.defineProperty(L,"NotificationType",{enumerable:!0,get:function(){return Ee.NotificationType}});Object.defineProperty(L,"NotificationType0",{enumerable:!0,get:function(){return Ee.NotificationType0}});Object.defineProperty(L,"NotificationType1",{enumerable:!0,get:function(){return Ee.NotificationType1}});Object.defineProperty(L,"NotificationType2",{enumerable:!0,get:function(){return Ee.NotificationType2}});Object.defineProperty(L,"NotificationType3",{enumerable:!0,get:function(){return Ee.NotificationType3}});Object.defineProperty(L,"NotificationType4",{enumerable:!0,get:function(){return Ee.NotificationType4}});Object.defineProperty(L,"NotificationType5",{enumerable:!0,get:function(){return Ee.NotificationType5}});Object.defineProperty(L,"NotificationType6",{enumerable:!0,get:function(){return Ee.NotificationType6}});Object.defineProperty(L,"NotificationType7",{enumerable:!0,get:function(){return Ee.NotificationType7}});Object.defineProperty(L,"NotificationType8",{enumerable:!0,get:function(){return Ee.NotificationType8}});Object.defineProperty(L,"NotificationType9",{enumerable:!0,get:function(){return Ee.NotificationType9}});Object.defineProperty(L,"ParameterStructures",{enumerable:!0,get:function(){return Ee.ParameterStructures}});var oa=Ws();Object.defineProperty(L,"LinkedMap",{enumerable:!0,get:function(){return oa.LinkedMap}});Object.defineProperty(L,"LRUCache",{enumerable:!0,get:function(){return oa.LRUCache}});Object.defineProperty(L,"Touch",{enumerable:!0,get:function(){return oa.Touch}});var aw=As();Object.defineProperty(L,"Disposable",{enumerable:!0,get:function(){return aw.Disposable}});var zd=$r();Object.defineProperty(L,"Event",{enumerable:!0,get:function(){return zd.Event}});Object.defineProperty(L,"Emitter",{enumerable:!0,get:function(){return zd.Emitter}});var Ud=Vs();Object.defineProperty(L,"CancellationTokenSource",{enumerable:!0,get:function(){return Ud.CancellationTokenSource}});Object.defineProperty(L,"CancellationToken",{enumerable:!0,get:function(){return Ud.CancellationToken}});var sa=Ed();Object.defineProperty(L,"MessageReader",{enumerable:!0,get:function(){return sa.MessageReader}});Object.defineProperty(L,"AbstractMessageReader",{enumerable:!0,get:function(){return sa.AbstractMessageReader}});Object.defineProperty(L,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return sa.ReadableStreamMessageReader}});var aa=Fd();Object.defineProperty(L,"MessageWriter",{enumerable:!0,get:function(){return aa.MessageWriter}});Object.defineProperty(L,"AbstractMessageWriter",{enumerable:!0,get:function(){return aa.AbstractMessageWriter}});Object.defineProperty(L,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return aa.WriteableStreamMessageWriter}});var xt=Wd();Object.defineProperty(L,"ConnectionStrategy",{enumerable:!0,get:function(){return xt.ConnectionStrategy}});Object.defineProperty(L,"ConnectionOptions",{enumerable:!0,get:function(){return xt.ConnectionOptions}});Object.defineProperty(L,"NullLogger",{enumerable:!0,get:function(){return xt.NullLogger}});Object.defineProperty(L,"createMessageConnection",{enumerable:!0,get:function(){return xt.createMessageConnection}});Object.defineProperty(L,"ProgressToken",{enumerable:!0,get:function(){return xt.ProgressToken}});Object.defineProperty(L,"ProgressType",{enumerable:!0,get:function(){return xt.ProgressType}});Object.defineProperty(L,"Trace",{enumerable:!0,get:function(){return xt.Trace}});Object.defineProperty(L,"TraceFormat",{enumerable:!0,get:function(){return xt.TraceFormat}});Object.defineProperty(L,"SetTraceNotification",{enumerable:!0,get:function(){return xt.SetTraceNotification}});Object.defineProperty(L,"LogTraceNotification",{enumerable:!0,get:function(){return xt.LogTraceNotification}});Object.defineProperty(L,"ConnectionErrors",{enumerable:!0,get:function(){return xt.ConnectionErrors}});Object.defineProperty(L,"ConnectionError",{enumerable:!0,get:function(){return xt.ConnectionError}});Object.defineProperty(L,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return xt.CancellationReceiverStrategy}});Object.defineProperty(L,"CancellationSenderStrategy",{enumerable:!0,get:function(){return xt.CancellationSenderStrategy}});Object.defineProperty(L,"CancellationStrategy",{enumerable:!0,get:function(){return xt.CancellationStrategy}});var cw=An();L.RAL=cw.default});var Tr=x(we=>{"use strict";var uw=we&&we.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),lw=we&&we.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&uw(e,n,t)};Object.defineProperty(we,"__esModule",{value:!0});we.createMessageConnection=we.createServerSocketTransport=we.createClientSocketTransport=we.createServerPipeTransport=we.createClientPipeTransport=we.generateRandomPipeName=we.StreamMessageWriter=we.StreamMessageReader=we.SocketMessageWriter=we.SocketMessageReader=we.IPCMessageWriter=we.IPCMessageReader=void 0;var Wr=Jl();Wr.default.install();var bn=ca(),Kd=require("path"),dw=require("os"),fw=require("crypto"),To=require("net");lw(ca(),we);var Bd=class extends bn.AbstractMessageReader{constructor(e){super();this.process=e;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),bn.Disposable.create(()=>this.process.off("message",e))}};we.IPCMessageReader=Bd;var Gd=class extends bn.AbstractMessageWriter{constructor(e){super();this.process=e,this.errorCount=0;let t=this.process;t.on("error",r=>this.fireError(r)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};we.IPCMessageWriter=Gd;var zr=class extends bn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,Wr.default)().stream.asReadableStream(e),t)}};we.SocketMessageReader=zr;var Ur=class extends bn.WriteableStreamMessageWriter{constructor(e,t){super((0,Wr.default)().stream.asWritableStream(e),t);this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};we.SocketMessageWriter=Ur;var ua=class extends bn.ReadableStreamMessageReader{constructor(e,t){super((0,Wr.default)().stream.asReadableStream(e),t)}};we.StreamMessageReader=ua;var la=class extends bn.WriteableStreamMessageWriter{constructor(e,t){super((0,Wr.default)().stream.asWritableStream(e),t)}};we.StreamMessageWriter=la;var Vd=process.env.XDG_RUNTIME_DIR,pw=new Map([["linux",107],["darwin",103]]);function hw(){let n=(0,fw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${n}-sock`;let e;Vd?e=Kd.join(Vd,`vscode-ipc-${n}.sock`):e=Kd.join(dw.tmpdir(),`vscode-${n}.sock`);let t=pw.get(process.platform);return t!==void 0&&e.length>=t&&(0,Wr.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}we.generateRandomPipeName=hw;function gw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,To.createServer)(a=>{s.close(),t([new zr(a,e),new Ur(a,e)])});s.on("error",o),s.listen(n,()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientPipeTransport=gw;function mw(n,e="utf-8"){let t=(0,To.createConnection)(n);return[new zr(t,e),new Ur(t,e)]}we.createServerPipeTransport=mw;function vw(n,e="utf-8"){let t,r=new Promise((i,o)=>{t=i});return new Promise((i,o)=>{let s=(0,To.createServer)(a=>{s.close(),t([new zr(a,e),new Ur(a,e)])});s.on("error",o),s.listen(n,"127.0.0.1",()=>{s.removeListener("error",o),i({onConnected:()=>r})})})}we.createClientSocketTransport=vw;function yw(n,e="utf-8"){let t=(0,To.createConnection)(n,"127.0.0.1");return[new zr(t,e),new Ur(t,e)]}we.createServerSocketTransport=yw;function Cw(n){let e=n;return e.read!==void 0&&e.addListener!==void 0}function ww(n){let e=n;return e.write!==void 0&&e.addListener!==void 0}function Rw(n,e,t,r){t||(t=bn.NullLogger);let i=Cw(n)?new ua(n):n,o=ww(e)?new la(e):e;return bn.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,bn.createMessageConnection)(i,o,t,r)}we.createMessageConnection=Rw});var da=x((Y_,Xd)=>{"use strict";Xd.exports=Tr()});var fa=x((Qd,Do)=>{(function(n){if(typeof Do=="object"&&typeof Do.exports=="object"){var e=n(require,Qd);e!==void 0&&(Do.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],n)})(function(n,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(f){function T(D){return typeof D=="string"}f.is=T})(t=e.DocumentUri||(e.DocumentUri={}));var r;(function(f){function T(D){return typeof D=="string"}f.is=T})(r=e.URI||(e.URI={}));var i;(function(f){f.MIN_VALUE=-2147483648,f.MAX_VALUE=2147483647;function T(D){return typeof D=="number"&&f.MIN_VALUE<=D&&D<=f.MAX_VALUE}f.is=T})(i=e.integer||(e.integer={}));var o;(function(f){f.MIN_VALUE=0,f.MAX_VALUE=2147483647;function T(D){return typeof D=="number"&&f.MIN_VALUE<=D&&D<=f.MAX_VALUE}f.is=T})(o=e.uinteger||(e.uinteger={}));var s;(function(f){function T(m,d){return m===Number.MAX_VALUE&&(m=o.MAX_VALUE),d===Number.MAX_VALUE&&(d=o.MAX_VALUE),{line:m,character:d}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&S.uinteger(d.line)&&S.uinteger(d.character)}f.is=D})(s=e.Position||(e.Position={}));var a;(function(f){function T(m,d,P,F){if(S.uinteger(m)&&S.uinteger(d)&&S.uinteger(P)&&S.uinteger(F))return{start:s.create(m,d),end:s.create(P,F)};if(s.is(m)&&s.is(d))return{start:m,end:d};throw new Error("Range#create called with invalid arguments[".concat(m,", ").concat(d,", ").concat(P,", ").concat(F,"]"))}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&s.is(d.start)&&s.is(d.end)}f.is=D})(a=e.Range||(e.Range={}));var c;(function(f){function T(m,d){return{uri:m,range:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.string(d.uri)||S.undefined(d.uri))}f.is=D})(c=e.Location||(e.Location={}));var l;(function(f){function T(m,d,P,F){return{targetUri:m,targetRange:d,targetSelectionRange:P,originSelectionRange:F}}f.create=T;function D(m){var d=m;return S.defined(d)&&a.is(d.targetRange)&&S.string(d.targetUri)&&a.is(d.targetSelectionRange)&&(a.is(d.originSelectionRange)||S.undefined(d.originSelectionRange))}f.is=D})(l=e.LocationLink||(e.LocationLink={}));var g;(function(f){function T(m,d,P,F){return{red:m,green:d,blue:P,alpha:F}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&S.numberRange(d.red,0,1)&&S.numberRange(d.green,0,1)&&S.numberRange(d.blue,0,1)&&S.numberRange(d.alpha,0,1)}f.is=D})(g=e.Color||(e.Color={}));var v;(function(f){function T(m,d){return{range:m,color:d}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&a.is(d.range)&&g.is(d.color)}f.is=D})(v=e.ColorInformation||(e.ColorInformation={}));var h;(function(f){function T(m,d,P){return{label:m,textEdit:d,additionalTextEdits:P}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&S.string(d.label)&&(S.undefined(d.textEdit)||K.is(d))&&(S.undefined(d.additionalTextEdits)||S.typedArray(d.additionalTextEdits,K.is))}f.is=D})(h=e.ColorPresentation||(e.ColorPresentation={}));var C;(function(f){f.Comment="comment",f.Imports="imports",f.Region="region"})(C=e.FoldingRangeKind||(e.FoldingRangeKind={}));var b;(function(f){function T(m,d,P,F,ne){var Pe={startLine:m,endLine:d};return S.defined(P)&&(Pe.startCharacter=P),S.defined(F)&&(Pe.endCharacter=F),S.defined(ne)&&(Pe.kind=ne),Pe}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&S.uinteger(d.startLine)&&S.uinteger(d.startLine)&&(S.undefined(d.startCharacter)||S.uinteger(d.startCharacter))&&(S.undefined(d.endCharacter)||S.uinteger(d.endCharacter))&&(S.undefined(d.kind)||S.string(d.kind))}f.is=D})(b=e.FoldingRange||(e.FoldingRange={}));var k;(function(f){function T(m,d){return{location:m,message:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&c.is(d.location)&&S.string(d.message)}f.is=D})(k=e.DiagnosticRelatedInformation||(e.DiagnosticRelatedInformation={}));var I;(function(f){f.Error=1,f.Warning=2,f.Information=3,f.Hint=4})(I=e.DiagnosticSeverity||(e.DiagnosticSeverity={}));var O;(function(f){f.Unnecessary=1,f.Deprecated=2})(O=e.DiagnosticTag||(e.DiagnosticTag={}));var M;(function(f){function T(D){var m=D;return S.objectLiteral(m)&&S.string(m.href)}f.is=T})(M=e.CodeDescription||(e.CodeDescription={}));var q;(function(f){function T(m,d,P,F,ne,Pe){var Ae={range:m,message:d};return S.defined(P)&&(Ae.severity=P),S.defined(F)&&(Ae.code=F),S.defined(ne)&&(Ae.source=ne),S.defined(Pe)&&(Ae.relatedInformation=Pe),Ae}f.create=T;function D(m){var d,P=m;return S.defined(P)&&a.is(P.range)&&S.string(P.message)&&(S.number(P.severity)||S.undefined(P.severity))&&(S.integer(P.code)||S.string(P.code)||S.undefined(P.code))&&(S.undefined(P.codeDescription)||S.string((d=P.codeDescription)===null||d===void 0?void 0:d.href))&&(S.string(P.source)||S.undefined(P.source))&&(S.undefined(P.relatedInformation)||S.typedArray(P.relatedInformation,k.is))}f.is=D})(q=e.Diagnostic||(e.Diagnostic={}));var $;(function(f){function T(m,d){for(var P=[],F=2;F<arguments.length;F++)P[F-2]=arguments[F];var ne={title:m,command:d};return S.defined(P)&&P.length>0&&(ne.arguments=P),ne}f.create=T;function D(m){var d=m;return S.defined(d)&&S.string(d.title)&&S.string(d.command)}f.is=D})($=e.Command||(e.Command={}));var K;(function(f){function T(P,F){return{range:P,newText:F}}f.replace=T;function D(P,F){return{range:{start:P,end:P},newText:F}}f.insert=D;function m(P){return{range:P,newText:""}}f.del=m;function d(P){var F=P;return S.objectLiteral(F)&&S.string(F.newText)&&a.is(F.range)}f.is=d})(K=e.TextEdit||(e.TextEdit={}));var fe;(function(f){function T(m,d,P){var F={label:m};return d!==void 0&&(F.needsConfirmation=d),P!==void 0&&(F.description=P),F}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&S.string(d.label)&&(S.boolean(d.needsConfirmation)||d.needsConfirmation===void 0)&&(S.string(d.description)||d.description===void 0)}f.is=D})(fe=e.ChangeAnnotation||(e.ChangeAnnotation={}));var Y;(function(f){function T(D){var m=D;return S.string(m)}f.is=T})(Y=e.ChangeAnnotationIdentifier||(e.ChangeAnnotationIdentifier={}));var He;(function(f){function T(P,F,ne){return{range:P,newText:F,annotationId:ne}}f.replace=T;function D(P,F,ne){return{range:{start:P,end:P},newText:F,annotationId:ne}}f.insert=D;function m(P,F){return{range:P,newText:"",annotationId:F}}f.del=m;function d(P){var F=P;return K.is(F)&&(fe.is(F.annotationId)||Y.is(F.annotationId))}f.is=d})(He=e.AnnotatedTextEdit||(e.AnnotatedTextEdit={}));var Ge;(function(f){function T(m,d){return{textDocument:m,edits:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&tt.is(d.textDocument)&&Array.isArray(d.edits)}f.is=D})(Ge=e.TextDocumentEdit||(e.TextDocumentEdit={}));var rt;(function(f){function T(m,d,P){var F={kind:"create",uri:m};return d!==void 0&&(d.overwrite!==void 0||d.ignoreIfExists!==void 0)&&(F.options=d),P!==void 0&&(F.annotationId=P),F}f.create=T;function D(m){var d=m;return d&&d.kind==="create"&&S.string(d.uri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||Y.is(d.annotationId))}f.is=D})(rt=e.CreateFile||(e.CreateFile={}));var Dt;(function(f){function T(m,d,P,F){var ne={kind:"rename",oldUri:m,newUri:d};return P!==void 0&&(P.overwrite!==void 0||P.ignoreIfExists!==void 0)&&(ne.options=P),F!==void 0&&(ne.annotationId=F),ne}f.create=T;function D(m){var d=m;return d&&d.kind==="rename"&&S.string(d.oldUri)&&S.string(d.newUri)&&(d.options===void 0||(d.options.overwrite===void 0||S.boolean(d.options.overwrite))&&(d.options.ignoreIfExists===void 0||S.boolean(d.options.ignoreIfExists)))&&(d.annotationId===void 0||Y.is(d.annotationId))}f.is=D})(Dt=e.RenameFile||(e.RenameFile={}));var gt;(function(f){function T(m,d,P){var F={kind:"delete",uri:m};return d!==void 0&&(d.recursive!==void 0||d.ignoreIfNotExists!==void 0)&&(F.options=d),P!==void 0&&(F.annotationId=P),F}f.create=T;function D(m){var d=m;return d&&d.kind==="delete"&&S.string(d.uri)&&(d.options===void 0||(d.options.recursive===void 0||S.boolean(d.options.recursive))&&(d.options.ignoreIfNotExists===void 0||S.boolean(d.options.ignoreIfNotExists)))&&(d.annotationId===void 0||Y.is(d.annotationId))}f.is=D})(gt=e.DeleteFile||(e.DeleteFile={}));var mt;(function(f){function T(D){var m=D;return m&&(m.changes!==void 0||m.documentChanges!==void 0)&&(m.documentChanges===void 0||m.documentChanges.every(function(d){return S.string(d.kind)?rt.is(d)||Dt.is(d)||gt.is(d):Ge.is(d)}))}f.is=T})(mt=e.WorkspaceEdit||(e.WorkspaceEdit={}));var St=function(){function f(T,D){this.edits=T,this.changeAnnotations=D}return f.prototype.insert=function(T,D,m){var d,P;if(m===void 0?d=K.insert(T,D):Y.is(m)?(P=m,d=He.insert(T,D,m)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(m),d=He.insert(T,D,P)),this.edits.push(d),P!==void 0)return P},f.prototype.replace=function(T,D,m){var d,P;if(m===void 0?d=K.replace(T,D):Y.is(m)?(P=m,d=He.replace(T,D,m)):(this.assertChangeAnnotations(this.changeAnnotations),P=this.changeAnnotations.manage(m),d=He.replace(T,D,P)),this.edits.push(d),P!==void 0)return P},f.prototype.delete=function(T,D){var m,d;if(D===void 0?m=K.del(T):Y.is(D)?(d=D,m=He.del(T,D)):(this.assertChangeAnnotations(this.changeAnnotations),d=this.changeAnnotations.manage(D),m=He.del(T,d)),this.edits.push(m),d!==void 0)return d},f.prototype.add=function(T){this.edits.push(T)},f.prototype.all=function(){return this.edits},f.prototype.clear=function(){this.edits.splice(0,this.edits.length)},f.prototype.assertChangeAnnotations=function(T){if(T===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},f}(),at=function(){function f(T){this._annotations=T===void 0?Object.create(null):T,this._counter=0,this._size=0}return f.prototype.all=function(){return this._annotations},Object.defineProperty(f.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),f.prototype.manage=function(T,D){var m;if(Y.is(T)?m=T:(m=this.nextId(),D=T),this._annotations[m]!==void 0)throw new Error("Id ".concat(m," is already in use."));if(D===void 0)throw new Error("No annotation provided for id ".concat(m));return this._annotations[m]=D,this._size++,m},f.prototype.nextId=function(){return this._counter++,this._counter.toString()},f}(),vt=function(){function f(T){var D=this;this._textEditChanges=Object.create(null),T!==void 0?(this._workspaceEdit=T,T.documentChanges?(this._changeAnnotations=new at(T.changeAnnotations),T.changeAnnotations=this._changeAnnotations.all(),T.documentChanges.forEach(function(m){if(Ge.is(m)){var d=new St(m.edits,D._changeAnnotations);D._textEditChanges[m.textDocument.uri]=d}})):T.changes&&Object.keys(T.changes).forEach(function(m){var d=new St(T.changes[m]);D._textEditChanges[m]=d})):this._workspaceEdit={}}return Object.defineProperty(f.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),f.prototype.getTextEditChange=function(T){if(tt.is(T)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var D={uri:T.uri,version:T.version},m=this._textEditChanges[D.uri];if(!m){var d=[],P={textDocument:D,edits:d};this._workspaceEdit.documentChanges.push(P),m=new St(d,this._changeAnnotations),this._textEditChanges[D.uri]=m}return m}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var m=this._textEditChanges[T];if(!m){var d=[];this._workspaceEdit.changes[T]=d,m=new St(d),this._textEditChanges[T]=m}return m}},f.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new at,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},f.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},f.prototype.createFile=function(T,D,m){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;fe.is(D)||Y.is(D)?d=D:m=D;var P,F;if(d===void 0?P=rt.create(T,m):(F=Y.is(d)?d:this._changeAnnotations.manage(d),P=rt.create(T,m,F)),this._workspaceEdit.documentChanges.push(P),F!==void 0)return F},f.prototype.renameFile=function(T,D,m,d){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var P;fe.is(m)||Y.is(m)?P=m:d=m;var F,ne;if(P===void 0?F=Dt.create(T,D,d):(ne=Y.is(P)?P:this._changeAnnotations.manage(P),F=Dt.create(T,D,d,ne)),this._workspaceEdit.documentChanges.push(F),ne!==void 0)return ne},f.prototype.deleteFile=function(T,D,m){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var d;fe.is(D)||Y.is(D)?d=D:m=D;var P,F;if(d===void 0?P=gt.create(T,m):(F=Y.is(d)?d:this._changeAnnotations.manage(d),P=gt.create(T,m,F)),this._workspaceEdit.documentChanges.push(P),F!==void 0)return F},f}();e.WorkspaceChange=vt;var xn;(function(f){function T(m){return{uri:m}}f.create=T;function D(m){var d=m;return S.defined(d)&&S.string(d.uri)}f.is=D})(xn=e.TextDocumentIdentifier||(e.TextDocumentIdentifier={}));var Le;(function(f){function T(m,d){return{uri:m,version:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&S.string(d.uri)&&S.integer(d.version)}f.is=D})(Le=e.VersionedTextDocumentIdentifier||(e.VersionedTextDocumentIdentifier={}));var tt;(function(f){function T(m,d){return{uri:m,version:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&S.string(d.uri)&&(d.version===null||S.integer(d.version))}f.is=D})(tt=e.OptionalVersionedTextDocumentIdentifier||(e.OptionalVersionedTextDocumentIdentifier={}));var ct;(function(f){function T(m,d,P,F){return{uri:m,languageId:d,version:P,text:F}}f.create=T;function D(m){var d=m;return S.defined(d)&&S.string(d.uri)&&S.string(d.languageId)&&S.integer(d.version)&&S.string(d.text)}f.is=D})(ct=e.TextDocumentItem||(e.TextDocumentItem={}));var Nt;(function(f){f.PlainText="plaintext",f.Markdown="markdown"})(Nt=e.MarkupKind||(e.MarkupKind={})),function(f){function T(D){var m=D;return m===f.PlainText||m===f.Markdown}f.is=T}(Nt=e.MarkupKind||(e.MarkupKind={}));var Xe;(function(f){function T(D){var m=D;return S.objectLiteral(D)&&Nt.is(m.kind)&&S.string(m.value)}f.is=T})(Xe=e.MarkupContent||(e.MarkupContent={}));var ur;(function(f){f.Text=1,f.Method=2,f.Function=3,f.Constructor=4,f.Field=5,f.Variable=6,f.Class=7,f.Interface=8,f.Module=9,f.Property=10,f.Unit=11,f.Value=12,f.Enum=13,f.Keyword=14,f.Snippet=15,f.Color=16,f.File=17,f.Reference=18,f.Folder=19,f.EnumMember=20,f.Constant=21,f.Struct=22,f.Event=23,f.Operator=24,f.TypeParameter=25})(ur=e.CompletionItemKind||(e.CompletionItemKind={}));var Vn;(function(f){f.PlainText=1,f.Snippet=2})(Vn=e.InsertTextFormat||(e.InsertTextFormat={}));var Bn;(function(f){f.Deprecated=1})(Bn=e.CompletionItemTag||(e.CompletionItemTag={}));var kn;(function(f){function T(m,d,P){return{newText:m,insert:d,replace:P}}f.create=T;function D(m){var d=m;return d&&S.string(d.newText)&&a.is(d.insert)&&a.is(d.replace)}f.is=D})(kn=e.InsertReplaceEdit||(e.InsertReplaceEdit={}));var qn;(function(f){f.asIs=1,f.adjustIndentation=2})(qn=e.InsertTextMode||(e.InsertTextMode={}));var lr;(function(f){function T(D){var m=D;return m&&(S.string(m.detail)||m.detail===void 0)&&(S.string(m.description)||m.description===void 0)}f.is=T})(lr=e.CompletionItemLabelDetails||(e.CompletionItemLabelDetails={}));var Gn;(function(f){function T(D){return{label:D}}f.create=T})(Gn=e.CompletionItem||(e.CompletionItem={}));var Xn;(function(f){function T(D,m){return{items:D||[],isIncomplete:!!m}}f.create=T})(Xn=e.CompletionList||(e.CompletionList={}));var yt;(function(f){function T(m){return m.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}f.fromPlainText=T;function D(m){var d=m;return S.string(d)||S.objectLiteral(d)&&S.string(d.language)&&S.string(d.value)}f.is=D})(yt=e.MarkedString||(e.MarkedString={}));var Bt;(function(f){function T(D){var m=D;return!!m&&S.objectLiteral(m)&&(Xe.is(m.contents)||yt.is(m.contents)||S.typedArray(m.contents,yt.is))&&(D.range===void 0||a.is(D.range))}f.is=T})(Bt=e.Hover||(e.Hover={}));var Qn;(function(f){function T(D,m){return m?{label:D,documentation:m}:{label:D}}f.create=T})(Qn=e.ParameterInformation||(e.ParameterInformation={}));var Mt;(function(f){function T(D,m){for(var d=[],P=2;P<arguments.length;P++)d[P-2]=arguments[P];var F={label:D};return S.defined(m)&&(F.documentation=m),S.defined(d)?F.parameters=d:F.parameters=[],F}f.create=T})(Mt=e.SignatureInformation||(e.SignatureInformation={}));var On;(function(f){f.Text=1,f.Read=2,f.Write=3})(On=e.DocumentHighlightKind||(e.DocumentHighlightKind={}));var Cn;(function(f){function T(D,m){var d={range:D};return S.number(m)&&(d.kind=m),d}f.create=T})(Cn=e.DocumentHighlight||(e.DocumentHighlight={}));var jt;(function(f){f.File=1,f.Module=2,f.Namespace=3,f.Package=4,f.Class=5,f.Method=6,f.Property=7,f.Field=8,f.Constructor=9,f.Enum=10,f.Interface=11,f.Function=12,f.Variable=13,f.Constant=14,f.String=15,f.Number=16,f.Boolean=17,f.Array=18,f.Object=19,f.Key=20,f.Null=21,f.EnumMember=22,f.Struct=23,f.Event=24,f.Operator=25,f.TypeParameter=26})(jt=e.SymbolKind||(e.SymbolKind={}));var Ft;(function(f){f.Deprecated=1})(Ft=e.SymbolTag||(e.SymbolTag={}));var Qe;(function(f){function T(D,m,d,P,F){var ne={name:D,kind:m,location:{uri:P,range:d}};return F&&(ne.containerName=F),ne}f.create=T})(Qe=e.SymbolInformation||(e.SymbolInformation={}));var dr;(function(f){function T(D,m,d,P){return P!==void 0?{name:D,kind:m,location:{uri:d,range:P}}:{name:D,kind:m,location:{uri:d}}}f.create=T})(dr=e.WorkspaceSymbol||(e.WorkspaceSymbol={}));var _t;(function(f){function T(m,d,P,F,ne,Pe){var Ae={name:m,detail:d,kind:P,range:F,selectionRange:ne};return Pe!==void 0&&(Ae.children=Pe),Ae}f.create=T;function D(m){var d=m;return d&&S.string(d.name)&&S.number(d.kind)&&a.is(d.range)&&a.is(d.selectionRange)&&(d.detail===void 0||S.string(d.detail))&&(d.deprecated===void 0||S.boolean(d.deprecated))&&(d.children===void 0||Array.isArray(d.children))&&(d.tags===void 0||Array.isArray(d.tags))}f.is=D})(_t=e.DocumentSymbol||(e.DocumentSymbol={}));var $t;(function(f){f.Empty="",f.QuickFix="quickfix",f.Refactor="refactor",f.RefactorExtract="refactor.extract",f.RefactorInline="refactor.inline",f.RefactorRewrite="refactor.rewrite",f.Source="source",f.SourceOrganizeImports="source.organizeImports",f.SourceFixAll="source.fixAll"})($t=e.CodeActionKind||(e.CodeActionKind={}));var wn;(function(f){f.Invoked=1,f.Automatic=2})(wn=e.CodeActionTriggerKind||(e.CodeActionTriggerKind={}));var In;(function(f){function T(m,d,P){var F={diagnostics:m};return d!=null&&(F.only=d),P!=null&&(F.triggerKind=P),F}f.create=T;function D(m){var d=m;return S.defined(d)&&S.typedArray(d.diagnostics,q.is)&&(d.only===void 0||S.typedArray(d.only,S.string))&&(d.triggerKind===void 0||d.triggerKind===wn.Invoked||d.triggerKind===wn.Automatic)}f.is=D})(In=e.CodeActionContext||(e.CodeActionContext={}));var Nn;(function(f){function T(m,d,P){var F={title:m},ne=!0;return typeof d=="string"?(ne=!1,F.kind=d):$.is(d)?F.command=d:F.edit=d,ne&&P!==void 0&&(F.kind=P),F}f.create=T;function D(m){var d=m;return d&&S.string(d.title)&&(d.diagnostics===void 0||S.typedArray(d.diagnostics,q.is))&&(d.kind===void 0||S.string(d.kind))&&(d.edit!==void 0||d.command!==void 0)&&(d.command===void 0||$.is(d.command))&&(d.isPreferred===void 0||S.boolean(d.isPreferred))&&(d.edit===void 0||mt.is(d.edit))}f.is=D})(Nn=e.CodeAction||(e.CodeAction={}));var Ht;(function(f){function T(m,d){var P={range:m};return S.defined(d)&&(P.data=d),P}f.create=T;function D(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.command)||$.is(d.command))}f.is=D})(Ht=e.CodeLens||(e.CodeLens={}));var Gt;(function(f){function T(m,d){return{tabSize:m,insertSpaces:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&S.uinteger(d.tabSize)&&S.boolean(d.insertSpaces)}f.is=D})(Gt=e.FormattingOptions||(e.FormattingOptions={}));var R;(function(f){function T(m,d,P){return{range:m,target:d,data:P}}f.create=T;function D(m){var d=m;return S.defined(d)&&a.is(d.range)&&(S.undefined(d.target)||S.string(d.target))}f.is=D})(R=e.DocumentLink||(e.DocumentLink={}));var N;(function(f){function T(m,d){return{range:m,parent:d}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&a.is(d.range)&&(d.parent===void 0||f.is(d.parent))}f.is=D})(N=e.SelectionRange||(e.SelectionRange={}));var H;(function(f){f.namespace="namespace",f.type="type",f.class="class",f.enum="enum",f.interface="interface",f.struct="struct",f.typeParameter="typeParameter",f.parameter="parameter",f.variable="variable",f.property="property",f.enumMember="enumMember",f.event="event",f.function="function",f.method="method",f.macro="macro",f.keyword="keyword",f.modifier="modifier",f.comment="comment",f.string="string",f.number="number",f.regexp="regexp",f.operator="operator",f.decorator="decorator"})(H=e.SemanticTokenTypes||(e.SemanticTokenTypes={}));var V;(function(f){f.declaration="declaration",f.definition="definition",f.readonly="readonly",f.static="static",f.deprecated="deprecated",f.abstract="abstract",f.async="async",f.modification="modification",f.documentation="documentation",f.defaultLibrary="defaultLibrary"})(V=e.SemanticTokenModifiers||(e.SemanticTokenModifiers={}));var he;(function(f){function T(D){var m=D;return S.objectLiteral(m)&&(m.resultId===void 0||typeof m.resultId=="string")&&Array.isArray(m.data)&&(m.data.length===0||typeof m.data[0]=="number")}f.is=T})(he=e.SemanticTokens||(e.SemanticTokens={}));var ge;(function(f){function T(m,d){return{range:m,text:d}}f.create=T;function D(m){var d=m;return d!=null&&a.is(d.range)&&S.string(d.text)}f.is=D})(ge=e.InlineValueText||(e.InlineValueText={}));var me;(function(f){function T(m,d,P){return{range:m,variableName:d,caseSensitiveLookup:P}}f.create=T;function D(m){var d=m;return d!=null&&a.is(d.range)&&S.boolean(d.caseSensitiveLookup)&&(S.string(d.variableName)||d.variableName===void 0)}f.is=D})(me=e.InlineValueVariableLookup||(e.InlineValueVariableLookup={}));var ke;(function(f){function T(m,d){return{range:m,expression:d}}f.create=T;function D(m){var d=m;return d!=null&&a.is(d.range)&&(S.string(d.expression)||d.expression===void 0)}f.is=D})(ke=e.InlineValueEvaluatableExpression||(e.InlineValueEvaluatableExpression={}));var ce;(function(f){function T(m,d){return{frameId:m,stoppedLocation:d}}f.create=T;function D(m){var d=m;return S.defined(d)&&a.is(m.stoppedLocation)}f.is=D})(ce=e.InlineValueContext||(e.InlineValueContext={}));var Ce;(function(f){f.Type=1,f.Parameter=2;function T(D){return D===1||D===2}f.is=T})(Ce=e.InlayHintKind||(e.InlayHintKind={}));var ue;(function(f){function T(m){return{value:m}}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.location===void 0||c.is(d.location))&&(d.command===void 0||$.is(d.command))}f.is=D})(ue=e.InlayHintLabelPart||(e.InlayHintLabelPart={}));var p;(function(f){function T(m,d,P){var F={position:m,label:d};return P!==void 0&&(F.kind=P),F}f.create=T;function D(m){var d=m;return S.objectLiteral(d)&&s.is(d.position)&&(S.string(d.label)||S.typedArray(d.label,ue.is))&&(d.kind===void 0||Ce.is(d.kind))&&d.textEdits===void 0||S.typedArray(d.textEdits,K.is)&&(d.tooltip===void 0||S.string(d.tooltip)||Xe.is(d.tooltip))&&(d.paddingLeft===void 0||S.boolean(d.paddingLeft))&&(d.paddingRight===void 0||S.boolean(d.paddingRight))}f.is=D})(p=e.InlayHint||(e.InlayHint={})),e.EOL=[`
`,`\r
`,"\r"];var E;(function(f){function T(P,F,ne,Pe){return new z(P,F,ne,Pe)}f.create=T;function D(P){var F=P;return!!(S.defined(F)&&S.string(F.uri)&&(S.undefined(F.languageId)||S.string(F.languageId))&&S.uinteger(F.lineCount)&&S.func(F.getText)&&S.func(F.positionAt)&&S.func(F.offsetAt))}f.is=D;function m(P,F){for(var ne=P.getText(),Pe=d(F,function(Jn,Ir){var no=Jn.range.start.line-Ir.range.start.line;return no===0?Jn.range.start.character-Ir.range.start.character:no}),Ae=ne.length,Wt=Pe.length-1;Wt>=0;Wt--){var zt=Pe[Wt],Xt=P.offsetAt(zt.range.start),de=P.offsetAt(zt.range.end);if(de<=Ae)ne=ne.substring(0,Xt)+zt.newText+ne.substring(de,ne.length);else throw new Error("Overlapping edit");Ae=Xt}return ne}f.applyEdits=m;function d(P,F){if(P.length<=1)return P;var ne=P.length/2|0,Pe=P.slice(0,ne),Ae=P.slice(ne);d(Pe,F),d(Ae,F);for(var Wt=0,zt=0,Xt=0;Wt<Pe.length&&zt<Ae.length;){var de=F(Pe[Wt],Ae[zt]);de<=0?P[Xt++]=Pe[Wt++]:P[Xt++]=Ae[zt++]}for(;Wt<Pe.length;)P[Xt++]=Pe[Wt++];for(;zt<Ae.length;)P[Xt++]=Ae[zt++];return P}})(E=e.TextDocument||(e.TextDocument={}));var z=function(){function f(T,D,m,d){this._uri=T,this._languageId=D,this._version=m,this._content=d,this._lineOffsets=void 0}return Object.defineProperty(f.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),f.prototype.getText=function(T){if(T){var D=this.offsetAt(T.start),m=this.offsetAt(T.end);return this._content.substring(D,m)}return this._content},f.prototype.update=function(T,D){this._content=T.text,this._version=D,this._lineOffsets=void 0},f.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var T=[],D=this._content,m=!0,d=0;d<D.length;d++){m&&(T.push(d),m=!1);var P=D.charAt(d);m=P==="\r"||P===`
`,P==="\r"&&d+1<D.length&&D.charAt(d+1)===`
`&&d++}m&&D.length>0&&T.push(D.length),this._lineOffsets=T}return this._lineOffsets},f.prototype.positionAt=function(T){T=Math.max(Math.min(T,this._content.length),0);var D=this.getLineOffsets(),m=0,d=D.length;if(d===0)return s.create(0,T);for(;m<d;){var P=Math.floor((m+d)/2);D[P]>T?d=P:m=P+1}var F=m-1;return s.create(F,T-D[F])},f.prototype.offsetAt=function(T){var D=this.getLineOffsets();if(T.line>=D.length)return this._content.length;if(T.line<0)return 0;var m=D[T.line],d=T.line+1<D.length?D[T.line+1]:this._content.length;return Math.max(Math.min(m+T.character,d),m)},Object.defineProperty(f.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),f}(),S;(function(f){var T=Object.prototype.toString;function D(de){return typeof de<"u"}f.defined=D;function m(de){return typeof de>"u"}f.undefined=m;function d(de){return de===!0||de===!1}f.boolean=d;function P(de){return T.call(de)==="[object String]"}f.string=P;function F(de){return T.call(de)==="[object Number]"}f.number=F;function ne(de,Jn,Ir){return T.call(de)==="[object Number]"&&Jn<=de&&de<=Ir}f.numberRange=ne;function Pe(de){return T.call(de)==="[object Number]"&&-2147483648<=de&&de<=2147483647}f.integer=Pe;function Ae(de){return T.call(de)==="[object Number]"&&0<=de&&de<=2147483647}f.uinteger=Ae;function Wt(de){return T.call(de)==="[object Function]"}f.func=Wt;function zt(de){return de!==null&&typeof de=="object"}f.objectLiteral=zt;function Xt(de,Jn){return Array.isArray(de)&&de.every(Jn)}f.typedArray=Xt})(S||(S={}))})});var Me=x(Zt=>{"use strict";Object.defineProperty(Zt,"__esModule",{value:!0});Zt.ProtocolNotificationType=Zt.ProtocolNotificationType0=Zt.ProtocolRequestType=Zt.ProtocolRequestType0=Zt.RegistrationType=void 0;var Kr=Tr(),Jd=class{constructor(e){this.method=e}};Zt.RegistrationType=Jd;var Yd=class extends Kr.RequestType0{constructor(e){super(e)}};Zt.ProtocolRequestType0=Yd;var Zd=class extends Kr.RequestType{constructor(e){super(e,Kr.ParameterStructures.byName)}};Zt.ProtocolRequestType=Zd;var ef=class extends Kr.NotificationType0{constructor(e){super(e)}};Zt.ProtocolNotificationType0=ef;var tf=class extends Kr.NotificationType{constructor(e){super(e,Kr.ParameterStructures.byName)}};Zt.ProtocolNotificationType=tf});var So=x(Je=>{"use strict";Object.defineProperty(Je,"__esModule",{value:!0});Je.objectLiteral=Je.typedArray=Je.stringArray=Je.array=Je.func=Je.error=Je.number=Je.string=Je.boolean=void 0;function bw(n){return n===!0||n===!1}Je.boolean=bw;function nf(n){return typeof n=="string"||n instanceof String}Je.string=nf;function Tw(n){return typeof n=="number"||n instanceof Number}Je.number=Tw;function Dw(n){return n instanceof Error}Je.error=Dw;function Sw(n){return typeof n=="function"}Je.func=Sw;function rf(n){return Array.isArray(n)}Je.array=rf;function _w(n){return rf(n)&&n.every(e=>nf(e))}Je.stringArray=_w;function Pw(n,e){return Array.isArray(n)&&n.every(e)}Je.typedArray=Pw;function Ew(n){return n!==null&&typeof n=="object"}Je.objectLiteral=Ew});var of=x(ki=>{"use strict";Object.defineProperty(ki,"__esModule",{value:!0});ki.ImplementationRequest=void 0;var xw=Me(),kw;(function(n){n.method="textDocument/implementation",n.type=new xw.ProtocolRequestType(n.method)})(kw=ki.ImplementationRequest||(ki.ImplementationRequest={}))});var sf=x(qi=>{"use strict";Object.defineProperty(qi,"__esModule",{value:!0});qi.TypeDefinitionRequest=void 0;var qw=Me(),Ow;(function(n){n.method="textDocument/typeDefinition",n.type=new qw.ProtocolRequestType(n.method)})(Ow=qi.TypeDefinitionRequest||(qi.TypeDefinitionRequest={}))});var cf=x(Zn=>{"use strict";Object.defineProperty(Zn,"__esModule",{value:!0});Zn.DidChangeWorkspaceFoldersNotification=Zn.WorkspaceFoldersRequest=void 0;var af=Me(),Iw;(function(n){n.type=new af.ProtocolRequestType0("workspace/workspaceFolders")})(Iw=Zn.WorkspaceFoldersRequest||(Zn.WorkspaceFoldersRequest={}));var Nw;(function(n){n.type=new af.ProtocolNotificationType("workspace/didChangeWorkspaceFolders")})(Nw=Zn.DidChangeWorkspaceFoldersNotification||(Zn.DidChangeWorkspaceFoldersNotification={}))});var uf=x(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.ConfigurationRequest=void 0;var Fw=Me(),Lw;(function(n){n.type=new Fw.ProtocolRequestType("workspace/configuration")})(Lw=Oi.ConfigurationRequest||(Oi.ConfigurationRequest={}))});var df=x(er=>{"use strict";Object.defineProperty(er,"__esModule",{value:!0});er.ColorPresentationRequest=er.DocumentColorRequest=void 0;var lf=Me(),Aw;(function(n){n.method="textDocument/documentColor",n.type=new lf.ProtocolRequestType(n.method)})(Aw=er.DocumentColorRequest||(er.DocumentColorRequest={}));var Mw;(function(n){n.type=new lf.ProtocolRequestType("textDocument/colorPresentation")})(Mw=er.ColorPresentationRequest||(er.ColorPresentationRequest={}))});var ff=x(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.FoldingRangeRequest=tr.FoldingRangeKind=void 0;var jw=Me(),$w;(function(n){n.Comment="comment",n.Imports="imports",n.Region="region"})($w=tr.FoldingRangeKind||(tr.FoldingRangeKind={}));var Hw;(function(n){n.method="textDocument/foldingRange",n.type=new jw.ProtocolRequestType(n.method)})(Hw=tr.FoldingRangeRequest||(tr.FoldingRangeRequest={}))});var pf=x(Ii=>{"use strict";Object.defineProperty(Ii,"__esModule",{value:!0});Ii.DeclarationRequest=void 0;var Ww=Me(),zw;(function(n){n.method="textDocument/declaration",n.type=new Ww.ProtocolRequestType(n.method)})(zw=Ii.DeclarationRequest||(Ii.DeclarationRequest={}))});var hf=x(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.SelectionRangeRequest=void 0;var Uw=Me(),Kw;(function(n){n.method="textDocument/selectionRange",n.type=new Uw.ProtocolRequestType(n.method)})(Kw=Ni.SelectionRangeRequest||(Ni.SelectionRangeRequest={}))});var mf=x(un=>{"use strict";Object.defineProperty(un,"__esModule",{value:!0});un.WorkDoneProgressCancelNotification=un.WorkDoneProgressCreateRequest=un.WorkDoneProgress=void 0;var Vw=Tr(),gf=Me(),Bw;(function(n){n.type=new Vw.ProgressType;function e(t){return t===n.type}n.is=e})(Bw=un.WorkDoneProgress||(un.WorkDoneProgress={}));var Gw;(function(n){n.type=new gf.ProtocolRequestType("window/workDoneProgress/create")})(Gw=un.WorkDoneProgressCreateRequest||(un.WorkDoneProgressCreateRequest={}));var Xw;(function(n){n.type=new gf.ProtocolNotificationType("window/workDoneProgress/cancel")})(Xw=un.WorkDoneProgressCancelNotification||(un.WorkDoneProgressCancelNotification={}))});var vf=x(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.CallHierarchyOutgoingCallsRequest=ln.CallHierarchyIncomingCallsRequest=ln.CallHierarchyPrepareRequest=void 0;var pa=Me(),Qw;(function(n){n.method="textDocument/prepareCallHierarchy",n.type=new pa.ProtocolRequestType(n.method)})(Qw=ln.CallHierarchyPrepareRequest||(ln.CallHierarchyPrepareRequest={}));var Jw;(function(n){n.method="callHierarchy/incomingCalls",n.type=new pa.ProtocolRequestType(n.method)})(Jw=ln.CallHierarchyIncomingCallsRequest||(ln.CallHierarchyIncomingCallsRequest={}));var Yw;(function(n){n.method="callHierarchy/outgoingCalls",n.type=new pa.ProtocolRequestType(n.method)})(Yw=ln.CallHierarchyOutgoingCallsRequest||(ln.CallHierarchyOutgoingCallsRequest={}))});var yf=x(Ye=>{"use strict";Object.defineProperty(Ye,"__esModule",{value:!0});Ye.SemanticTokensRefreshRequest=Ye.SemanticTokensRangeRequest=Ye.SemanticTokensDeltaRequest=Ye.SemanticTokensRequest=Ye.SemanticTokensRegistrationType=Ye.TokenFormat=void 0;var Fi=Me(),Zw;(function(n){n.Relative="relative"})(Zw=Ye.TokenFormat||(Ye.TokenFormat={}));var eR;(function(n){n.method="textDocument/semanticTokens",n.type=new Fi.RegistrationType(n.method)})(eR=Ye.SemanticTokensRegistrationType||(Ye.SemanticTokensRegistrationType={}));var tR;(function(n){n.method="textDocument/semanticTokens/full",n.type=new Fi.ProtocolRequestType(n.method)})(tR=Ye.SemanticTokensRequest||(Ye.SemanticTokensRequest={}));var nR;(function(n){n.method="textDocument/semanticTokens/full/delta",n.type=new Fi.ProtocolRequestType(n.method)})(nR=Ye.SemanticTokensDeltaRequest||(Ye.SemanticTokensDeltaRequest={}));var rR;(function(n){n.method="textDocument/semanticTokens/range",n.type=new Fi.ProtocolRequestType(n.method)})(rR=Ye.SemanticTokensRangeRequest||(Ye.SemanticTokensRangeRequest={}));var iR;(function(n){n.method="workspace/semanticTokens/refresh",n.type=new Fi.ProtocolRequestType0(n.method)})(iR=Ye.SemanticTokensRefreshRequest||(Ye.SemanticTokensRefreshRequest={}))});var Cf=x(Li=>{"use strict";Object.defineProperty(Li,"__esModule",{value:!0});Li.ShowDocumentRequest=void 0;var oR=Me(),sR;(function(n){n.method="window/showDocument",n.type=new oR.ProtocolRequestType(n.method)})(sR=Li.ShowDocumentRequest||(Li.ShowDocumentRequest={}))});var wf=x(Ai=>{"use strict";Object.defineProperty(Ai,"__esModule",{value:!0});Ai.LinkedEditingRangeRequest=void 0;var aR=Me(),cR;(function(n){n.method="textDocument/linkedEditingRange",n.type=new aR.ProtocolRequestType(n.method)})(cR=Ai.LinkedEditingRangeRequest||(Ai.LinkedEditingRangeRequest={}))});var Rf=x(je=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});je.WillDeleteFilesRequest=je.DidDeleteFilesNotification=je.DidRenameFilesNotification=je.WillRenameFilesRequest=je.DidCreateFilesNotification=je.WillCreateFilesRequest=je.FileOperationPatternKind=void 0;var Vr=Me(),uR;(function(n){n.file="file",n.folder="folder"})(uR=je.FileOperationPatternKind||(je.FileOperationPatternKind={}));var lR;(function(n){n.method="workspace/willCreateFiles",n.type=new Vr.ProtocolRequestType(n.method)})(lR=je.WillCreateFilesRequest||(je.WillCreateFilesRequest={}));var dR;(function(n){n.method="workspace/didCreateFiles",n.type=new Vr.ProtocolNotificationType(n.method)})(dR=je.DidCreateFilesNotification||(je.DidCreateFilesNotification={}));var fR;(function(n){n.method="workspace/willRenameFiles",n.type=new Vr.ProtocolRequestType(n.method)})(fR=je.WillRenameFilesRequest||(je.WillRenameFilesRequest={}));var pR;(function(n){n.method="workspace/didRenameFiles",n.type=new Vr.ProtocolNotificationType(n.method)})(pR=je.DidRenameFilesNotification||(je.DidRenameFilesNotification={}));var hR;(function(n){n.method="workspace/didDeleteFiles",n.type=new Vr.ProtocolNotificationType(n.method)})(hR=je.DidDeleteFilesNotification||(je.DidDeleteFilesNotification={}));var gR;(function(n){n.method="workspace/willDeleteFiles",n.type=new Vr.ProtocolRequestType(n.method)})(gR=je.WillDeleteFilesRequest||(je.WillDeleteFilesRequest={}))});var bf=x(dn=>{"use strict";Object.defineProperty(dn,"__esModule",{value:!0});dn.MonikerRequest=dn.MonikerKind=dn.UniquenessLevel=void 0;var mR=Me(),vR;(function(n){n.document="document",n.project="project",n.group="group",n.scheme="scheme",n.global="global"})(vR=dn.UniquenessLevel||(dn.UniquenessLevel={}));var yR;(function(n){n.import="import",n.export="export",n.local="local"})(yR=dn.MonikerKind||(dn.MonikerKind={}));var CR;(function(n){n.method="textDocument/moniker",n.type=new mR.ProtocolRequestType(n.method)})(CR=dn.MonikerRequest||(dn.MonikerRequest={}))});var Tf=x(fn=>{"use strict";Object.defineProperty(fn,"__esModule",{value:!0});fn.TypeHierarchySubtypesRequest=fn.TypeHierarchySupertypesRequest=fn.TypeHierarchyPrepareRequest=void 0;var ha=Me(),wR;(function(n){n.method="textDocument/prepareTypeHierarchy",n.type=new ha.ProtocolRequestType(n.method)})(wR=fn.TypeHierarchyPrepareRequest||(fn.TypeHierarchyPrepareRequest={}));var RR;(function(n){n.method="typeHierarchy/supertypes",n.type=new ha.ProtocolRequestType(n.method)})(RR=fn.TypeHierarchySupertypesRequest||(fn.TypeHierarchySupertypesRequest={}));var bR;(function(n){n.method="typeHierarchy/subtypes",n.type=new ha.ProtocolRequestType(n.method)})(bR=fn.TypeHierarchySubtypesRequest||(fn.TypeHierarchySubtypesRequest={}))});var Sf=x(nr=>{"use strict";Object.defineProperty(nr,"__esModule",{value:!0});nr.InlineValueRefreshRequest=nr.InlineValueRequest=void 0;var Df=Me(),TR;(function(n){n.method="textDocument/inlineValue",n.type=new Df.ProtocolRequestType(n.method)})(TR=nr.InlineValueRequest||(nr.InlineValueRequest={}));var DR;(function(n){n.method="workspace/inlineValue/refresh",n.type=new Df.ProtocolRequestType0(n.method)})(DR=nr.InlineValueRefreshRequest||(nr.InlineValueRefreshRequest={}))});var _f=x(pn=>{"use strict";Object.defineProperty(pn,"__esModule",{value:!0});pn.InlayHintRefreshRequest=pn.InlayHintResolveRequest=pn.InlayHintRequest=void 0;var ga=Me(),SR;(function(n){n.method="textDocument/inlayHint",n.type=new ga.ProtocolRequestType(n.method)})(SR=pn.InlayHintRequest||(pn.InlayHintRequest={}));var _R;(function(n){n.method="inlayHint/resolve",n.type=new ga.ProtocolRequestType(n.method)})(_R=pn.InlayHintResolveRequest||(pn.InlayHintResolveRequest={}));var PR;(function(n){n.method="workspace/inlayHint/refresh",n.type=new ga.ProtocolRequestType0(n.method)})(PR=pn.InlayHintRefreshRequest||(pn.InlayHintRefreshRequest={}))});var Nf=x(y=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0});y.CodeLensRequest=y.WorkspaceSymbolResolveRequest=y.WorkspaceSymbolRequest=y.CodeActionResolveRequest=y.CodeActionRequest=y.DocumentSymbolRequest=y.DocumentHighlightRequest=y.ReferencesRequest=y.DefinitionRequest=y.SignatureHelpRequest=y.SignatureHelpTriggerKind=y.HoverRequest=y.CompletionResolveRequest=y.CompletionRequest=y.CompletionTriggerKind=y.PublishDiagnosticsNotification=y.WatchKind=y.FileChangeType=y.DidChangeWatchedFilesNotification=y.WillSaveTextDocumentWaitUntilRequest=y.WillSaveTextDocumentNotification=y.TextDocumentSaveReason=y.DidSaveTextDocumentNotification=y.DidCloseTextDocumentNotification=y.DidChangeTextDocumentNotification=y.TextDocumentContentChangeEvent=y.DidOpenTextDocumentNotification=y.TextDocumentSyncKind=y.TelemetryEventNotification=y.LogMessageNotification=y.ShowMessageRequest=y.ShowMessageNotification=y.MessageType=y.DidChangeConfigurationNotification=y.ExitNotification=y.ShutdownRequest=y.InitializedNotification=y.InitializeError=y.InitializeRequest=y.WorkDoneProgressOptions=y.TextDocumentRegistrationOptions=y.StaticRegistrationOptions=y.FailureHandlingKind=y.ResourceOperationKind=y.UnregistrationRequest=y.RegistrationRequest=y.DocumentSelector=y.NotebookCellTextDocumentFilter=y.NotebookDocumentFilter=y.TextDocumentFilter=void 0;y.InlineValueRequest=y.TypeHierarchySupertypesRequest=y.TypeHierarchySubtypesRequest=y.TypeHierarchyPrepareRequest=y.MonikerRequest=y.MonikerKind=y.UniquenessLevel=y.WillDeleteFilesRequest=y.DidDeleteFilesNotification=y.WillRenameFilesRequest=y.DidRenameFilesNotification=y.WillCreateFilesRequest=y.DidCreateFilesNotification=y.FileOperationPatternKind=y.LinkedEditingRangeRequest=y.ShowDocumentRequest=y.SemanticTokensRegistrationType=y.SemanticTokensRefreshRequest=y.SemanticTokensRangeRequest=y.SemanticTokensDeltaRequest=y.SemanticTokensRequest=y.TokenFormat=y.CallHierarchyPrepareRequest=y.CallHierarchyOutgoingCallsRequest=y.CallHierarchyIncomingCallsRequest=y.WorkDoneProgressCancelNotification=y.WorkDoneProgressCreateRequest=y.WorkDoneProgress=y.SelectionRangeRequest=y.DeclarationRequest=y.FoldingRangeRequest=y.ColorPresentationRequest=y.DocumentColorRequest=y.ConfigurationRequest=y.DidChangeWorkspaceFoldersNotification=y.WorkspaceFoldersRequest=y.TypeDefinitionRequest=y.ImplementationRequest=y.ApplyWorkspaceEditRequest=y.ExecuteCommandRequest=y.PrepareRenameRequest=y.RenameRequest=y.PrepareSupportDefaultBehavior=y.DocumentOnTypeFormattingRequest=y.DocumentRangeFormattingRequest=y.DocumentFormattingRequest=y.DocumentLinkResolveRequest=y.DocumentLinkRequest=y.CodeLensRefreshRequest=y.CodeLensResolveRequest=void 0;y.InlayHintRefreshRequest=y.InlayHintResolveRequest=y.InlayHintRequest=y.InlineValueRefreshRequest=void 0;var ie=Me(),kt=So(),ER=of();Object.defineProperty(y,"ImplementationRequest",{enumerable:!0,get:function(){return ER.ImplementationRequest}});var xR=sf();Object.defineProperty(y,"TypeDefinitionRequest",{enumerable:!0,get:function(){return xR.TypeDefinitionRequest}});var Pf=cf();Object.defineProperty(y,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return Pf.WorkspaceFoldersRequest}});Object.defineProperty(y,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return Pf.DidChangeWorkspaceFoldersNotification}});var kR=uf();Object.defineProperty(y,"ConfigurationRequest",{enumerable:!0,get:function(){return kR.ConfigurationRequest}});var Ef=df();Object.defineProperty(y,"DocumentColorRequest",{enumerable:!0,get:function(){return Ef.DocumentColorRequest}});Object.defineProperty(y,"ColorPresentationRequest",{enumerable:!0,get:function(){return Ef.ColorPresentationRequest}});var qR=ff();Object.defineProperty(y,"FoldingRangeRequest",{enumerable:!0,get:function(){return qR.FoldingRangeRequest}});var OR=pf();Object.defineProperty(y,"DeclarationRequest",{enumerable:!0,get:function(){return OR.DeclarationRequest}});var IR=hf();Object.defineProperty(y,"SelectionRangeRequest",{enumerable:!0,get:function(){return IR.SelectionRangeRequest}});var ma=mf();Object.defineProperty(y,"WorkDoneProgress",{enumerable:!0,get:function(){return ma.WorkDoneProgress}});Object.defineProperty(y,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return ma.WorkDoneProgressCreateRequest}});Object.defineProperty(y,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return ma.WorkDoneProgressCancelNotification}});var va=vf();Object.defineProperty(y,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return va.CallHierarchyIncomingCallsRequest}});Object.defineProperty(y,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return va.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(y,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return va.CallHierarchyPrepareRequest}});var Br=yf();Object.defineProperty(y,"TokenFormat",{enumerable:!0,get:function(){return Br.TokenFormat}});Object.defineProperty(y,"SemanticTokensRequest",{enumerable:!0,get:function(){return Br.SemanticTokensRequest}});Object.defineProperty(y,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return Br.SemanticTokensDeltaRequest}});Object.defineProperty(y,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return Br.SemanticTokensRangeRequest}});Object.defineProperty(y,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return Br.SemanticTokensRefreshRequest}});Object.defineProperty(y,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return Br.SemanticTokensRegistrationType}});var NR=Cf();Object.defineProperty(y,"ShowDocumentRequest",{enumerable:!0,get:function(){return NR.ShowDocumentRequest}});var FR=wf();Object.defineProperty(y,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return FR.LinkedEditingRangeRequest}});var Dr=Rf();Object.defineProperty(y,"FileOperationPatternKind",{enumerable:!0,get:function(){return Dr.FileOperationPatternKind}});Object.defineProperty(y,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Dr.DidCreateFilesNotification}});Object.defineProperty(y,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Dr.WillCreateFilesRequest}});Object.defineProperty(y,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Dr.DidRenameFilesNotification}});Object.defineProperty(y,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Dr.WillRenameFilesRequest}});Object.defineProperty(y,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Dr.DidDeleteFilesNotification}});Object.defineProperty(y,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Dr.WillDeleteFilesRequest}});var ya=bf();Object.defineProperty(y,"UniquenessLevel",{enumerable:!0,get:function(){return ya.UniquenessLevel}});Object.defineProperty(y,"MonikerKind",{enumerable:!0,get:function(){return ya.MonikerKind}});Object.defineProperty(y,"MonikerRequest",{enumerable:!0,get:function(){return ya.MonikerRequest}});var Ca=Tf();Object.defineProperty(y,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return Ca.TypeHierarchyPrepareRequest}});Object.defineProperty(y,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return Ca.TypeHierarchySubtypesRequest}});Object.defineProperty(y,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return Ca.TypeHierarchySupertypesRequest}});var xf=Sf();Object.defineProperty(y,"InlineValueRequest",{enumerable:!0,get:function(){return xf.InlineValueRequest}});Object.defineProperty(y,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return xf.InlineValueRefreshRequest}});var wa=_f();Object.defineProperty(y,"InlayHintRequest",{enumerable:!0,get:function(){return wa.InlayHintRequest}});Object.defineProperty(y,"InlayHintResolveRequest",{enumerable:!0,get:function(){return wa.InlayHintResolveRequest}});Object.defineProperty(y,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return wa.InlayHintRefreshRequest}});var kf;(function(n){function e(t){let r=t;return kt.string(r.language)||kt.string(r.scheme)||kt.string(r.pattern)}n.is=e})(kf=y.TextDocumentFilter||(y.TextDocumentFilter={}));var qf;(function(n){function e(t){let r=t;return kt.objectLiteral(r)&&(kt.string(r.notebookType)||kt.string(r.scheme)||kt.string(r.pattern))}n.is=e})(qf=y.NotebookDocumentFilter||(y.NotebookDocumentFilter={}));var Of;(function(n){function e(t){let r=t;return kt.objectLiteral(r)&&(kt.string(r.notebook)||qf.is(r.notebook))&&(r.language===void 0||kt.string(r.language))}n.is=e})(Of=y.NotebookCellTextDocumentFilter||(y.NotebookCellTextDocumentFilter={}));var If;(function(n){function e(t){if(!Array.isArray(t))return!1;for(let r of t)if(!kt.string(r)&&!kf.is(r)&&!Of.is(r))return!1;return!0}n.is=e})(If=y.DocumentSelector||(y.DocumentSelector={}));var LR;(function(n){n.type=new ie.ProtocolRequestType("client/registerCapability")})(LR=y.RegistrationRequest||(y.RegistrationRequest={}));var AR;(function(n){n.type=new ie.ProtocolRequestType("client/unregisterCapability")})(AR=y.UnregistrationRequest||(y.UnregistrationRequest={}));var MR;(function(n){n.Create="create",n.Rename="rename",n.Delete="delete"})(MR=y.ResourceOperationKind||(y.ResourceOperationKind={}));var jR;(function(n){n.Abort="abort",n.Transactional="transactional",n.TextOnlyTransactional="textOnlyTransactional",n.Undo="undo"})(jR=y.FailureHandlingKind||(y.FailureHandlingKind={}));var $R;(function(n){function e(t){let r=t;return r&&kt.string(r.id)&&r.id.length>0}n.hasId=e})($R=y.StaticRegistrationOptions||(y.StaticRegistrationOptions={}));var HR;(function(n){function e(t){let r=t;return r&&(r.documentSelector===null||If.is(r.documentSelector))}n.is=e})(HR=y.TextDocumentRegistrationOptions||(y.TextDocumentRegistrationOptions={}));var WR;(function(n){function e(r){let i=r;return kt.objectLiteral(i)&&(i.workDoneProgress===void 0||kt.boolean(i.workDoneProgress))}n.is=e;function t(r){let i=r;return i&&kt.boolean(i.workDoneProgress)}n.hasWorkDoneProgress=t})(WR=y.WorkDoneProgressOptions||(y.WorkDoneProgressOptions={}));var zR;(function(n){n.type=new ie.ProtocolRequestType("initialize")})(zR=y.InitializeRequest||(y.InitializeRequest={}));var UR;(function(n){n.unknownProtocolVersion=1})(UR=y.InitializeError||(y.InitializeError={}));var KR;(function(n){n.type=new ie.ProtocolNotificationType("initialized")})(KR=y.InitializedNotification||(y.InitializedNotification={}));var VR;(function(n){n.type=new ie.ProtocolRequestType0("shutdown")})(VR=y.ShutdownRequest||(y.ShutdownRequest={}));var BR;(function(n){n.type=new ie.ProtocolNotificationType0("exit")})(BR=y.ExitNotification||(y.ExitNotification={}));var GR;(function(n){n.type=new ie.ProtocolNotificationType("workspace/didChangeConfiguration")})(GR=y.DidChangeConfigurationNotification||(y.DidChangeConfigurationNotification={}));var XR;(function(n){n.Error=1,n.Warning=2,n.Info=3,n.Log=4})(XR=y.MessageType||(y.MessageType={}));var QR;(function(n){n.type=new ie.ProtocolNotificationType("window/showMessage")})(QR=y.ShowMessageNotification||(y.ShowMessageNotification={}));var JR;(function(n){n.type=new ie.ProtocolRequestType("window/showMessageRequest")})(JR=y.ShowMessageRequest||(y.ShowMessageRequest={}));var YR;(function(n){n.type=new ie.ProtocolNotificationType("window/logMessage")})(YR=y.LogMessageNotification||(y.LogMessageNotification={}));var ZR;(function(n){n.type=new ie.ProtocolNotificationType("telemetry/event")})(ZR=y.TelemetryEventNotification||(y.TelemetryEventNotification={}));var eb;(function(n){n.None=0,n.Full=1,n.Incremental=2})(eb=y.TextDocumentSyncKind||(y.TextDocumentSyncKind={}));var tb;(function(n){n.method="textDocument/didOpen",n.type=new ie.ProtocolNotificationType(n.method)})(tb=y.DidOpenTextDocumentNotification||(y.DidOpenTextDocumentNotification={}));var nb;(function(n){function e(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}n.isIncremental=e;function t(r){let i=r;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}n.isFull=t})(nb=y.TextDocumentContentChangeEvent||(y.TextDocumentContentChangeEvent={}));var rb;(function(n){n.method="textDocument/didChange",n.type=new ie.ProtocolNotificationType(n.method)})(rb=y.DidChangeTextDocumentNotification||(y.DidChangeTextDocumentNotification={}));var ib;(function(n){n.method="textDocument/didClose",n.type=new ie.ProtocolNotificationType(n.method)})(ib=y.DidCloseTextDocumentNotification||(y.DidCloseTextDocumentNotification={}));var ob;(function(n){n.method="textDocument/didSave",n.type=new ie.ProtocolNotificationType(n.method)})(ob=y.DidSaveTextDocumentNotification||(y.DidSaveTextDocumentNotification={}));var sb;(function(n){n.Manual=1,n.AfterDelay=2,n.FocusOut=3})(sb=y.TextDocumentSaveReason||(y.TextDocumentSaveReason={}));var ab;(function(n){n.method="textDocument/willSave",n.type=new ie.ProtocolNotificationType(n.method)})(ab=y.WillSaveTextDocumentNotification||(y.WillSaveTextDocumentNotification={}));var cb;(function(n){n.method="textDocument/willSaveWaitUntil",n.type=new ie.ProtocolRequestType(n.method)})(cb=y.WillSaveTextDocumentWaitUntilRequest||(y.WillSaveTextDocumentWaitUntilRequest={}));var ub;(function(n){n.type=new ie.ProtocolNotificationType("workspace/didChangeWatchedFiles")})(ub=y.DidChangeWatchedFilesNotification||(y.DidChangeWatchedFilesNotification={}));var lb;(function(n){n.Created=1,n.Changed=2,n.Deleted=3})(lb=y.FileChangeType||(y.FileChangeType={}));var db;(function(n){n.Create=1,n.Change=2,n.Delete=4})(db=y.WatchKind||(y.WatchKind={}));var fb;(function(n){n.type=new ie.ProtocolNotificationType("textDocument/publishDiagnostics")})(fb=y.PublishDiagnosticsNotification||(y.PublishDiagnosticsNotification={}));var pb;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.TriggerForIncompleteCompletions=3})(pb=y.CompletionTriggerKind||(y.CompletionTriggerKind={}));var hb;(function(n){n.method="textDocument/completion",n.type=new ie.ProtocolRequestType(n.method)})(hb=y.CompletionRequest||(y.CompletionRequest={}));var gb;(function(n){n.method="completionItem/resolve",n.type=new ie.ProtocolRequestType(n.method)})(gb=y.CompletionResolveRequest||(y.CompletionResolveRequest={}));var mb;(function(n){n.method="textDocument/hover",n.type=new ie.ProtocolRequestType(n.method)})(mb=y.HoverRequest||(y.HoverRequest={}));var vb;(function(n){n.Invoked=1,n.TriggerCharacter=2,n.ContentChange=3})(vb=y.SignatureHelpTriggerKind||(y.SignatureHelpTriggerKind={}));var yb;(function(n){n.method="textDocument/signatureHelp",n.type=new ie.ProtocolRequestType(n.method)})(yb=y.SignatureHelpRequest||(y.SignatureHelpRequest={}));var Cb;(function(n){n.method="textDocument/definition",n.type=new ie.ProtocolRequestType(n.method)})(Cb=y.DefinitionRequest||(y.DefinitionRequest={}));var wb;(function(n){n.method="textDocument/references",n.type=new ie.ProtocolRequestType(n.method)})(wb=y.ReferencesRequest||(y.ReferencesRequest={}));var Rb;(function(n){n.method="textDocument/documentHighlight",n.type=new ie.ProtocolRequestType(n.method)})(Rb=y.DocumentHighlightRequest||(y.DocumentHighlightRequest={}));var bb;(function(n){n.method="textDocument/documentSymbol",n.type=new ie.ProtocolRequestType(n.method)})(bb=y.DocumentSymbolRequest||(y.DocumentSymbolRequest={}));var Tb;(function(n){n.method="textDocument/codeAction",n.type=new ie.ProtocolRequestType(n.method)})(Tb=y.CodeActionRequest||(y.CodeActionRequest={}));var Db;(function(n){n.method="codeAction/resolve",n.type=new ie.ProtocolRequestType(n.method)})(Db=y.CodeActionResolveRequest||(y.CodeActionResolveRequest={}));var Sb;(function(n){n.method="workspace/symbol",n.type=new ie.ProtocolRequestType(n.method)})(Sb=y.WorkspaceSymbolRequest||(y.WorkspaceSymbolRequest={}));var _b;(function(n){n.method="workspaceSymbol/resolve",n.type=new ie.ProtocolRequestType(n.method)})(_b=y.WorkspaceSymbolResolveRequest||(y.WorkspaceSymbolResolveRequest={}));var Pb;(function(n){n.method="textDocument/codeLens",n.type=new ie.ProtocolRequestType(n.method)})(Pb=y.CodeLensRequest||(y.CodeLensRequest={}));var Eb;(function(n){n.method="codeLens/resolve",n.type=new ie.ProtocolRequestType(n.method)})(Eb=y.CodeLensResolveRequest||(y.CodeLensResolveRequest={}));var xb;(function(n){n.method="workspace/codeLens/refresh",n.type=new ie.ProtocolRequestType0(n.method)})(xb=y.CodeLensRefreshRequest||(y.CodeLensRefreshRequest={}));var kb;(function(n){n.method="textDocument/documentLink",n.type=new ie.ProtocolRequestType(n.method)})(kb=y.DocumentLinkRequest||(y.DocumentLinkRequest={}));var qb;(function(n){n.method="documentLink/resolve",n.type=new ie.ProtocolRequestType(n.method)})(qb=y.DocumentLinkResolveRequest||(y.DocumentLinkResolveRequest={}));var Ob;(function(n){n.method="textDocument/formatting",n.type=new ie.ProtocolRequestType(n.method)})(Ob=y.DocumentFormattingRequest||(y.DocumentFormattingRequest={}));var Ib;(function(n){n.method="textDocument/rangeFormatting",n.type=new ie.ProtocolRequestType(n.method)})(Ib=y.DocumentRangeFormattingRequest||(y.DocumentRangeFormattingRequest={}));var Nb;(function(n){n.method="textDocument/onTypeFormatting",n.type=new ie.ProtocolRequestType(n.method)})(Nb=y.DocumentOnTypeFormattingRequest||(y.DocumentOnTypeFormattingRequest={}));var Fb;(function(n){n.Identifier=1})(Fb=y.PrepareSupportDefaultBehavior||(y.PrepareSupportDefaultBehavior={}));var Lb;(function(n){n.method="textDocument/rename",n.type=new ie.ProtocolRequestType(n.method)})(Lb=y.RenameRequest||(y.RenameRequest={}));var Ab;(function(n){n.method="textDocument/prepareRename",n.type=new ie.ProtocolRequestType(n.method)})(Ab=y.PrepareRenameRequest||(y.PrepareRenameRequest={}));var Mb;(function(n){n.type=new ie.ProtocolRequestType("workspace/executeCommand")})(Mb=y.ExecuteCommandRequest||(y.ExecuteCommandRequest={}));var jb;(function(n){n.type=new ie.ProtocolRequestType("workspace/applyEdit")})(jb=y.ApplyWorkspaceEditRequest||(y.ApplyWorkspaceEditRequest={}))});var Lf=x(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.createProtocolConnection=void 0;var Ff=Tr();function $b(n,e,t,r){return Ff.ConnectionStrategy.is(r)&&(r={connectionStrategy:r}),(0,Ff.createMessageConnection)(n,e,t,r)}_o.createProtocolConnection=$b});var Mf=x(ft=>{"use strict";Object.defineProperty(ft,"__esModule",{value:!0});ft.DiagnosticRefreshRequest=ft.WorkspaceDiagnosticRequest=ft.DocumentDiagnosticRequest=ft.DocumentDiagnosticReportKind=ft.DiagnosticServerCancellationData=void 0;var Af=Tr(),Hb=So(),Ra=Me(),Wb;(function(n){function e(t){let r=t;return r&&Hb.boolean(r.retriggerRequest)}n.is=e})(Wb=ft.DiagnosticServerCancellationData||(ft.DiagnosticServerCancellationData={}));var zb;(function(n){n.full="full",n.unChanged="unChanged"})(zb=ft.DocumentDiagnosticReportKind||(ft.DocumentDiagnosticReportKind={}));var Ub;(function(n){n.method="textDocument/diagnostic",n.type=new Ra.ProtocolRequestType(n.method),n.partialResult=new Af.ProgressType})(Ub=ft.DocumentDiagnosticRequest||(ft.DocumentDiagnosticRequest={}));var Kb;(function(n){n.method="workspace/diagnostic",n.type=new Ra.ProtocolRequestType(n.method),n.partialResult=new Af.ProgressType})(Kb=ft.WorkspaceDiagnosticRequest||(ft.WorkspaceDiagnosticRequest={}));var Vb;(function(n){n.method="workspace/diagnostic/refresh",n.type=new Ra.ProtocolRequestType0(n.method)})(Vb=ft.DiagnosticRefreshRequest||(ft.DiagnosticRefreshRequest={}))});var Hf=x(ye=>{"use strict";Object.defineProperty(ye,"__esModule",{value:!0});ye.DidCloseNotebookDocumentNotification=ye.DidSaveNotebookDocumentNotification=ye.DidChangeNotebookDocumentNotification=ye.NotebookCellArrayChange=ye.DidOpenNotebookDocumentNotification=ye.NotebookDocumentSyncRegistrationType=ye.NotebookDocument=ye.NotebookCell=ye.ExecutionSummary=ye.NotebookCellKind=void 0;var Mi=fa(),hn=So(),ji=Me(),jf;(function(n){n.Markup=1,n.Code=2;function e(t){return t===1||t===2}n.is=e})(jf=ye.NotebookCellKind||(ye.NotebookCellKind={}));var $f;(function(n){function e(i,o){let s={executionOrder:i};return(o===!0||o===!1)&&(s.success=o),s}n.create=e;function t(i){let o=i;return hn.objectLiteral(o)&&Mi.uinteger.is(o.executionOrder)&&(o.success===void 0||hn.boolean(o.success))}n.is=t;function r(i,o){return i===o?!0:i==null||o===null||o===void 0?!1:i.executionOrder===o.executionOrder&&i.success===o.success}n.equals=r})($f=ye.ExecutionSummary||(ye.ExecutionSummary={}));var ba;(function(n){function e(o,s){return{kind:o,document:s}}n.create=e;function t(o){let s=o;return hn.objectLiteral(s)&&jf.is(s.kind)&&Mi.DocumentUri.is(s.document)&&(s.metadata===void 0||hn.objectLiteral(s.metadata))}n.is=t;function r(o,s){let a=new Set;return o.document!==s.document&&a.add("document"),o.kind!==s.kind&&a.add("kind"),o.executionSummary!==s.executionSummary&&a.add("executionSummary"),(o.metadata!==void 0||s.metadata!==void 0)&&!i(o.metadata,s.metadata)&&a.add("metadata"),(o.executionSummary!==void 0||s.executionSummary!==void 0)&&!$f.equals(o.executionSummary,s.executionSummary)&&a.add("executionSummary"),a}n.diff=r;function i(o,s){if(o===s)return!0;if(o==null||s===null||s===void 0||typeof o!=typeof s||typeof o!="object")return!1;let a=Array.isArray(o),c=Array.isArray(s);if(a!==c)return!1;if(a&&c){if(o.length!==s.length)return!1;for(let l=0;l<o.length;l++)if(!i(o[l],s[l]))return!1}if(hn.objectLiteral(o)&&hn.objectLiteral(s)){let l=Object.keys(o),g=Object.keys(s);if(l.length!==g.length||(l.sort(),g.sort(),!i(l,g)))return!1;for(let v=0;v<l.length;v++){let h=l[v];if(!i(o[h],s[h]))return!1}}return!0}})(ba=ye.NotebookCell||(ye.NotebookCell={}));var Bb;(function(n){function e(r,i,o,s){return{uri:r,notebookType:i,version:o,cells:s}}n.create=e;function t(r){let i=r;return hn.objectLiteral(i)&&hn.string(i.uri)&&Mi.integer.is(i.version)&&hn.typedArray(i.cells,ba.is)}n.is=t})(Bb=ye.NotebookDocument||(ye.NotebookDocument={}));var Gb;(function(n){n.method="notebookDocument/sync",n.type=new ji.RegistrationType(n.method)})(Gb=ye.NotebookDocumentSyncRegistrationType||(ye.NotebookDocumentSyncRegistrationType={}));var Xb;(function(n){n.method="notebookDocument/didOpen",n.type=new ji.ProtocolNotificationType(n.method)})(Xb=ye.DidOpenNotebookDocumentNotification||(ye.DidOpenNotebookDocumentNotification={}));var Qb;(function(n){function e(r){let i=r;return hn.objectLiteral(i)&&Mi.uinteger.is(i.start)&&Mi.uinteger.is(i.deleteCount)&&(i.cells===void 0||hn.typedArray(i.cells,ba.is))}n.is=e;function t(r,i,o){let s={start:r,deleteCount:i};return o!==void 0&&(s.cells=o),s}n.create=t})(Qb=ye.NotebookCellArrayChange||(ye.NotebookCellArrayChange={}));var Jb;(function(n){n.method="notebookDocument/didChange",n.type=new ji.ProtocolNotificationType(n.method)})(Jb=ye.DidChangeNotebookDocumentNotification||(ye.DidChangeNotebookDocumentNotification={}));var Yb;(function(n){n.method="notebookDocument/didSave",n.type=new ji.ProtocolNotificationType(n.method)})(Yb=ye.DidSaveNotebookDocumentNotification||(ye.DidSaveNotebookDocumentNotification={}));var Zb;(function(n){n.method="notebookDocument/didClose",n.type=new ji.ProtocolNotificationType(n.method)})(Zb=ye.DidCloseNotebookDocumentNotification||(ye.DidCloseNotebookDocumentNotification={}))});var Wf=x(st=>{"use strict";var eT=st&&st.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Po=st&&st.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&eT(e,n,t)};Object.defineProperty(st,"__esModule",{value:!0});st.Proposed=st.LSPErrorCodes=st.createProtocolConnection=void 0;Po(Tr(),st);Po(fa(),st);Po(Me(),st);Po(Nf(),st);var tT=Lf();Object.defineProperty(st,"createProtocolConnection",{enumerable:!0,get:function(){return tT.createProtocolConnection}});var nT;(function(n){n.lspReservedErrorRangeStart=-32899,n.RequestFailed=-32803,n.ServerCancelled=-32802,n.ContentModified=-32801,n.RequestCancelled=-32800,n.lspReservedErrorRangeEnd=-32800})(nT=st.LSPErrorCodes||(st.LSPErrorCodes={}));var $i=Mf(),rr=Hf(),rT;(function(n){n.DiagnosticServerCancellationData=$i.DiagnosticServerCancellationData,n.DocumentDiagnosticReportKind=$i.DocumentDiagnosticReportKind,n.DocumentDiagnosticRequest=$i.DocumentDiagnosticRequest,n.WorkspaceDiagnosticRequest=$i.WorkspaceDiagnosticRequest,n.DiagnosticRefreshRequest=$i.DiagnosticRefreshRequest,n.NotebookCellKind=rr.NotebookCellKind,n.NotebookCell=rr.NotebookCell,n.NotebookDocument=rr.NotebookDocument,n.NotebookDocumentSyncRegistrationType=rr.NotebookDocumentSyncRegistrationType,n.DidOpenNotebookDocumentNotification=rr.DidOpenNotebookDocumentNotification,n.DidChangeNotebookDocumentNotification=rr.DidChangeNotebookDocumentNotification,n.DidSaveNotebookDocumentNotification=rr.DidSaveNotebookDocumentNotification,n.DidCloseNotebookDocumentNotification=rr.DidCloseNotebookDocumentNotification})(rT=st.Proposed||(st.Proposed={}))});var De=x(Tn=>{"use strict";var iT=Tn&&Tn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),zf=Tn&&Tn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&iT(e,n,t)};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.createProtocolConnection=void 0;var oT=da();zf(da(),Tn);zf(Wf(),Tn);function sT(n,e,t,r){return(0,oT.createMessageConnection)(n,e,t,r)}Tn.createProtocolConnection=sT});var Da=x(Xr=>{"use strict";Object.defineProperty(Xr,"__esModule",{value:!0});Xr.toJSONObject=Xr.ConfigurationFeature=void 0;var Ta=require("vscode"),aT=De(),Uf=class{constructor(e){this._client=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(aT.ConfigurationRequest.type,(t,r)=>{let i=s=>{let a=[];for(let c of s.items){let l=c.scopeUri!==void 0&&c.scopeUri!==null?this._client.protocol2CodeConverter.asUri(c.scopeUri):void 0;a.push(this.getConfiguration(l,c.section!==null?c.section:void 0))}return a},o=e.clientOptions.middleware.workspace;return o&&o.configuration?o.configuration(t,r,i):i(t,r)})}getConfiguration(e,t){let r=null;if(t){let i=t.lastIndexOf(".");if(i===-1)r=Gr(Ta.workspace.getConfiguration(void 0,e).get(t));else{let o=Ta.workspace.getConfiguration(t.substr(0,i),e);o&&(r=Gr(o.get(t.substr(i+1))))}}else{let i=Ta.workspace.getConfiguration(void 0,e);r={};for(let o of Object.keys(i))i.has(o)&&(r[o]=Gr(i.get(o)))}return r===void 0&&(r=null),r}dispose(){}};Xr.ConfigurationFeature=Uf;function Gr(n){if(n){if(Array.isArray(n))return n.map(Gr);if(typeof n=="object"){let e=Object.create(null);for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=Gr(n[t]));return e}}return n}Xr.toJSONObject=Gr});var xo=x(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.forEach=en.mapAsync=en.map=en.Semaphore=en.Delayer=void 0;var Hi=De(),Vf=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(r=>{this.onSuccess=r}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var r=this.task();return this.task=void 0,r})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Hi.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};en.Delayer=Vf;var Bf=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,r)=>{this._waiting.push({thunk:e,resolve:t,reject:r}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Hi.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(r=>{this._active--,e.resolve(r),this.runNext()},r=>{this._active--,e.reject(r),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};en.Semaphore=Bf;var Kf=15,Eo=class{constructor(e=Kf){this.yieldAfter=Math.max(e,Kf),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function cT(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new Eo(r==null?void 0:r.yieldAfter);function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=e(n[l]),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Hi.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}en.map=cT;async function uT(n,e,t,r){if(n.length===0)return[];let i=new Array(n.length),o=new Eo(r==null?void 0:r.yieldAfter);async function s(c){o.start();for(let l=c;l<n.length;l++)if(i[l]=await e(n[l],t),o.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),l+1;return-1}let a=await s(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(c=>{(0,Hi.RAL)().timer.setImmediate(()=>{c(s(a))})});return i}en.mapAsync=uT;async function lT(n,e,t,r){if(n.length===0)return;let i=new Eo(r==null?void 0:r.yieldAfter);function o(a){i.start();for(let c=a;c<n.length;c++)if(e(n[c]),i.shouldYield())return r!=null&&r.yieldCallback&&r.yieldCallback(),c+1;return-1}let s=o(0);for(;s!==-1&&!(t!==void 0&&t.isCancellationRequested);)s=await new Promise(a=>{(0,Hi.RAL)().timer.setImmediate(()=>{a(o(s))})})}en.forEach=lT});var _a=x(Sa=>{"use strict";Object.defineProperty(Sa,"__esModule",{value:!0});var dT=require("vscode"),Gf=class extends dT.CompletionItem{constructor(e){super(e)}};Sa.default=Gf});var Ea=x(Pa=>{"use strict";Object.defineProperty(Pa,"__esModule",{value:!0});var fT=require("vscode"),Xf=class extends fT.CodeLens{constructor(e){super(e)}};Pa.default=Xf});var ka=x(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});var pT=require("vscode"),Qf=class extends pT.DocumentLink{constructor(e,t){super(e,t)}};xa.default=Qf});var Oa=x(qa=>{"use strict";Object.defineProperty(qa,"__esModule",{value:!0});var hT=require("vscode"),Jf=class extends hT.CodeAction{constructor(e,t){super(e);this.data=t}};qa.default=Jf});var Na=x(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.ProtocolDiagnostic=Sr.DiagnosticCode=void 0;var gT=require("vscode"),Ia=Rn(),mT;(function(n){function e(t){let r=t;return r!=null&&(Ia.number(r.value)||Ia.string(r.value))&&Ia.string(r.target)}n.is=e})(mT=Sr.DiagnosticCode||(Sr.DiagnosticCode={}));var Yf=class extends gT.Diagnostic{constructor(e,t,r,i){super(e,t,r);this.data=i,this.hasDiagnosticCode=!1}};Sr.ProtocolDiagnostic=Yf});var La=x(Fa=>{"use strict";Object.defineProperty(Fa,"__esModule",{value:!0});var vT=require("vscode"),Zf=class extends vT.CallHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s);a!==void 0&&(this.data=a)}};Fa.default=Zf});var Ma=x(Aa=>{"use strict";Object.defineProperty(Aa,"__esModule",{value:!0});var yT=require("vscode"),ep=class extends yT.TypeHierarchyItem{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,s);a!==void 0&&(this.data=a)}};Aa.default=ep});var $a=x(ja=>{"use strict";Object.defineProperty(ja,"__esModule",{value:!0});var ko=require("vscode"),tp=class extends ko.SymbolInformation{constructor(e,t,r,i,o){let s=!(i instanceof ko.Uri);super(e,t,r,s?i:new ko.Location(i,new ko.Range(0,0,0,0)));this.hasRange=s,o!==void 0&&(this.data=o)}};ja.default=tp});var Wa=x(Ha=>{"use strict";Object.defineProperty(Ha,"__esModule",{value:!0});var CT=require("vscode"),np=class extends CT.InlayHint{constructor(e,t,r){super(e,t,r)}};Ha.default=np});var op=x(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.createConverter=void 0;var Ze=require("vscode"),se=De(),Qr=Rn(),rp=xo(),wT=_a(),RT=Ea(),bT=ka(),TT=Oa(),ip=Na(),DT=La(),ST=Ma(),_T=$a(),PT=Wa(),za;(function(n){function e(t){let r=t;return r&&!!r.inserting&&!!r.replacing}n.is=e})(za||(za={}));function ET(n){let t=n||(p=>p.toString());function r(p){return t(p)}function i(p){return{uri:t(p.uri)}}function o(p){return{uri:t(p.uri),languageId:p.languageId,version:p.version,text:p.getText()}}function s(p){return{uri:t(p.uri),version:p.version}}function a(p){return{textDocument:o(p)}}function c(p){let E=p;return!!E.document&&!!E.contentChanges}function l(p){let E=p;return!!E.uri&&!!E.version}function g(p){if(l(p))return{textDocument:{uri:t(p.uri),version:p.version},contentChanges:[{text:p.getText()}]};if(c(p)){let E=p.document;return{textDocument:{uri:t(E.uri),version:E.version},contentChanges:p.contentChanges.map(S=>{let f=S.range;return{range:{start:{line:f.start.line,character:f.start.character},end:{line:f.end.line,character:f.end.character}},rangeLength:S.rangeLength,text:S.text}})}}else throw Error("Unsupported text document change parameter")}function v(p){return{textDocument:i(p)}}function h(p,E=!1){let z={textDocument:i(p)};return E&&(z.text=p.getText()),z}function C(p){switch(p){case Ze.TextDocumentSaveReason.Manual:return se.TextDocumentSaveReason.Manual;case Ze.TextDocumentSaveReason.AfterDelay:return se.TextDocumentSaveReason.AfterDelay;case Ze.TextDocumentSaveReason.FocusOut:return se.TextDocumentSaveReason.FocusOut}return se.TextDocumentSaveReason.Manual}function b(p){return{textDocument:i(p.document),reason:C(p.reason)}}function k(p){return{files:p.files.map(E=>({uri:t(E)}))}}function I(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function O(p){return{files:p.files.map(E=>({uri:t(E)}))}}function M(p){return{files:p.files.map(E=>({uri:t(E)}))}}function q(p){return{files:p.files.map(E=>({oldUri:t(E.oldUri),newUri:t(E.newUri)}))}}function $(p){return{files:p.files.map(E=>({uri:t(E)}))}}function K(p,E){return{textDocument:i(p),position:at(E)}}function fe(p){switch(p){case Ze.CompletionTriggerKind.TriggerCharacter:return se.CompletionTriggerKind.TriggerCharacter;case Ze.CompletionTriggerKind.TriggerForIncompleteCompletions:return se.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return se.CompletionTriggerKind.Invoked}}function Y(p,E,z){return{textDocument:i(p),position:at(E),context:{triggerKind:fe(z.triggerKind),triggerCharacter:z.triggerCharacter}}}function He(p){switch(p){case Ze.SignatureHelpTriggerKind.Invoke:return se.SignatureHelpTriggerKind.Invoked;case Ze.SignatureHelpTriggerKind.TriggerCharacter:return se.SignatureHelpTriggerKind.TriggerCharacter;case Ze.SignatureHelpTriggerKind.ContentChange:return se.SignatureHelpTriggerKind.ContentChange}}function Ge(p){return{label:p.label}}function rt(p){return p.map(Ge)}function Dt(p){return{label:p.label,parameters:rt(p.parameters)}}function gt(p){return p.map(Dt)}function mt(p){return p===void 0?p:{signatures:gt(p.signatures),activeSignature:p.activeSignature,activeParameter:p.activeParameter}}function St(p,E,z){return{textDocument:i(p),position:at(E),context:{isRetrigger:z.isRetrigger,triggerCharacter:z.triggerCharacter,triggerKind:He(z.triggerKind),activeSignatureHelp:mt(z.activeSignatureHelp)}}}function at(p){return{line:p.line,character:p.character}}function vt(p){return p==null?p:{line:p.line>se.uinteger.MAX_VALUE?se.uinteger.MAX_VALUE:p.line,character:p.character>se.uinteger.MAX_VALUE?se.uinteger.MAX_VALUE:p.character}}function xn(p,E){return rp.map(p,vt,E)}function Le(p){return p==null?p:{start:vt(p.start),end:vt(p.end)}}function tt(p){return p==null?p:se.Location.create(r(p.uri),Le(p.range))}function ct(p){switch(p){case Ze.DiagnosticSeverity.Error:return se.DiagnosticSeverity.Error;case Ze.DiagnosticSeverity.Warning:return se.DiagnosticSeverity.Warning;case Ze.DiagnosticSeverity.Information:return se.DiagnosticSeverity.Information;case Ze.DiagnosticSeverity.Hint:return se.DiagnosticSeverity.Hint}}function Nt(p){if(!p)return;let E=[];for(let z of p){let S=Xe(z);S!==void 0&&E.push(S)}return E.length>0?E:void 0}function Xe(p){switch(p){case Ze.DiagnosticTag.Unnecessary:return se.DiagnosticTag.Unnecessary;case Ze.DiagnosticTag.Deprecated:return se.DiagnosticTag.Deprecated;default:return}}function ur(p){return{message:p.message,location:tt(p.location)}}function Vn(p){return p.map(ur)}function Bn(p){if(p!=null)return Qr.number(p)||Qr.string(p)?p:{value:p.value,target:r(p.target)}}function kn(p){let E=se.Diagnostic.create(Le(p.range),p.message),z=p instanceof ip.ProtocolDiagnostic?p:void 0;z!==void 0&&z.data!==void 0&&(E.data=z.data);let S=Bn(p.code);return ip.DiagnosticCode.is(S)?z!==void 0&&z.hasDiagnosticCode?E.code=S:(E.code=S.value,E.codeDescription={href:S.target}):E.code=S,Qr.number(p.severity)&&(E.severity=ct(p.severity)),Array.isArray(p.tags)&&(E.tags=Nt(p.tags)),p.relatedInformation&&(E.relatedInformation=Vn(p.relatedInformation)),p.source&&(E.source=p.source),E}function qn(p,E){return p==null?p:rp.map(p,kn,E)}function lr(p,E){switch(p){case"$string":return E;case se.MarkupKind.PlainText:return{kind:p,value:E};case se.MarkupKind.Markdown:return{kind:p,value:E.value};default:return`Unsupported Markup content received. Kind is: ${p}`}}function Gn(p){switch(p){case Ze.CompletionItemTag.Deprecated:return se.CompletionItemTag.Deprecated}}function Xn(p){if(p===void 0)return p;let E=[];for(let z of p){let S=Gn(z);S!==void 0&&E.push(S)}return E}function yt(p,E){return E!==void 0?E:p+1}function Bt(p,E=!1){let z,S;Qr.string(p.label)?z=p.label:(z=p.label.label,E&&(p.label.detail!==void 0||p.label.description!==void 0)&&(S={detail:p.label.detail,description:p.label.description}));let f={label:z};S!==void 0&&(f.labelDetails=S);let T=p instanceof wT.default?p:void 0;p.detail&&(f.detail=p.detail),p.documentation&&(!T||T.documentationFormat==="$string"?f.documentation=p.documentation:f.documentation=lr(T.documentationFormat,p.documentation)),p.filterText&&(f.filterText=p.filterText),Qn(f,p),Qr.number(p.kind)&&(f.kind=yt(p.kind,T&&T.originalItemKind)),p.sortText&&(f.sortText=p.sortText),p.additionalTextEdits&&(f.additionalTextEdits=Cn(p.additionalTextEdits)),p.commitCharacters&&(f.commitCharacters=p.commitCharacters.slice()),p.command&&(f.command=Ht(p.command)),(p.preselect===!0||p.preselect===!1)&&(f.preselect=p.preselect);let D=Xn(p.tags);if(T){if(T.data!==void 0&&(f.data=T.data),T.deprecated===!0||T.deprecated===!1){if(T.deprecated===!0&&D!==void 0&&D.length>0){let m=D.indexOf(Ze.CompletionItemTag.Deprecated);m!==-1&&D.splice(m,1)}f.deprecated=T.deprecated}T.insertTextMode!==void 0&&(f.insertTextMode=T.insertTextMode)}return D!==void 0&&D.length>0&&(f.tags=D),f.insertTextMode===void 0&&p.keepWhitespace===!0&&(f.insertTextMode=se.InsertTextMode.adjustIndentation),f}function Qn(p,E){let z=se.InsertTextFormat.PlainText,S,f;E.textEdit?(S=E.textEdit.newText,f=E.textEdit.range):E.insertText instanceof Ze.SnippetString?(z=se.InsertTextFormat.Snippet,S=E.insertText.value):S=E.insertText,E.range&&(f=E.range),p.insertTextFormat=z,E.fromEdit&&S!==void 0&&f!==void 0?p.textEdit=Mt(S,f):p.insertText=S}function Mt(p,E){return za.is(E)?se.InsertReplaceEdit.create(p,Le(E.inserting),Le(E.replacing)):{newText:p,range:Le(E)}}function On(p){return{range:Le(p.range),newText:p.newText}}function Cn(p){return p==null?p:p.map(On)}function jt(p){return p<=Ze.SymbolKind.TypeParameter?p+1:se.SymbolKind.Property}function Ft(p){return p}function Qe(p){return p.map(Ft)}function dr(p,E,z){return{textDocument:i(p),position:at(E),context:{includeDeclaration:z.includeDeclaration}}}async function _t(p,E){let z=se.CodeAction.create(p.title);if(p instanceof TT.default&&p.data!==void 0&&(z.data=p.data),p.kind!==void 0&&(z.kind=In(p.kind)),p.diagnostics!==void 0&&(z.diagnostics=await qn(p.diagnostics,E)),p.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return p.command!==void 0&&(z.command=Ht(p.command)),p.isPreferred!==void 0&&(z.isPreferred=p.isPreferred),p.disabled!==void 0&&(z.disabled={reason:p.disabled.reason}),z}async function $t(p,E){if(p==null)return p;let z;return p.only&&Qr.string(p.only.value)&&(z=[p.only.value]),se.CodeActionContext.create(await qn(p.diagnostics,E),z,wn(p.triggerKind))}function wn(p){switch(p){case Ze.CodeActionTriggerKind.Invoke:return se.CodeActionTriggerKind.Invoked;case Ze.CodeActionTriggerKind.Automatic:return se.CodeActionTriggerKind.Automatic;default:return}}function In(p){if(p!=null)return p.value}function Nn(p){return p==null?p:se.InlineValueContext.create(p.frameId,p.stoppedLocation)}function Ht(p){let E=se.Command.create(p.title,p.command);return p.arguments&&(E.arguments=p.arguments),E}function Gt(p){let E=se.CodeLens.create(Le(p.range));return p.command&&(E.command=Ht(p.command)),p instanceof RT.default&&p.data&&(E.data=p.data),E}function R(p,E){let z={tabSize:p.tabSize,insertSpaces:p.insertSpaces};return E.trimTrailingWhitespace&&(z.trimTrailingWhitespace=!0),E.trimFinalNewlines&&(z.trimFinalNewlines=!0),E.insertFinalNewline&&(z.insertFinalNewline=!0),z}function N(p){return{textDocument:i(p)}}function H(p){return{textDocument:i(p)}}function V(p){let E=se.DocumentLink.create(Le(p.range));p.target&&(E.target=r(p.target)),p.tooltip!==void 0&&(E.tooltip=p.tooltip);let z=p instanceof bT.default?p:void 0;return z&&z.data&&(E.data=z.data),E}function he(p){return{textDocument:i(p)}}function ge(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof DT.default&&p.data!==void 0&&(E.data=p.data),E}function me(p){let E={name:p.name,kind:jt(p.kind),uri:r(p.uri),range:Le(p.range),selectionRange:Le(p.selectionRange)};return p.detail!==void 0&&p.detail.length>0&&(E.detail=p.detail),p.tags!==void 0&&(E.tags=Qe(p.tags)),p instanceof ST.default&&p.data!==void 0&&(E.data=p.data),E}function ke(p){let E=p instanceof _T.default?{name:p.name,kind:jt(p.kind),location:p.hasRange?tt(p.location):{uri:t(p.location.uri)},data:p.data}:{name:p.name,kind:jt(p.kind),location:tt(p.location)};return p.tags!==void 0&&(E.tags=Qe(p.tags)),p.containerName!==""&&(E.containerName=p.containerName),E}function ce(p){let E=typeof p.label=="string"?p.label:p.label.map(Ce),z=se.InlayHint.create(vt(p.position),E);return p.kind!==void 0&&(z.kind=p.kind),p.textEdits!==void 0&&(z.textEdits=Cn(p.textEdits)),p.tooltip!==void 0&&(z.tooltip=ue(p.tooltip)),p.paddingLeft!==void 0&&(z.paddingLeft=p.paddingLeft),p.paddingRight!==void 0&&(z.paddingRight=p.paddingRight),p instanceof PT.default&&p.data!==void 0&&(z.data=p.data),z}function Ce(p){let E=se.InlayHintLabelPart.create(p.value);return p.location!==void 0&&(E.location=tt(p.location)),p.command!==void 0&&(E.command=Ht(p.command)),p.tooltip!==void 0&&(E.tooltip=ue(p.tooltip)),E}function ue(p){return typeof p=="string"?p:{kind:se.MarkupKind.Markdown,value:p.value}}return{asUri:r,asTextDocumentIdentifier:i,asTextDocumentItem:o,asVersionedTextDocumentIdentifier:s,asOpenTextDocumentParams:a,asChangeTextDocumentParams:g,asCloseTextDocumentParams:v,asSaveTextDocumentParams:h,asWillSaveTextDocumentParams:b,asDidCreateFilesParams:k,asDidRenameFilesParams:I,asDidDeleteFilesParams:O,asWillCreateFilesParams:M,asWillRenameFilesParams:q,asWillDeleteFilesParams:$,asTextDocumentPositionParams:K,asCompletionParams:Y,asSignatureHelpParams:St,asWorkerPosition:at,asRange:Le,asPosition:vt,asPositions:xn,asLocation:tt,asDiagnosticSeverity:ct,asDiagnosticTag:Xe,asDiagnostic:kn,asDiagnostics:qn,asCompletionItem:Bt,asTextEdit:On,asSymbolKind:jt,asSymbolTag:Ft,asSymbolTags:Qe,asReferenceParams:dr,asCodeAction:_t,asCodeActionContext:$t,asInlineValueContext:Nn,asCommand:Ht,asCodeLens:Gt,asFormattingOptions:R,asDocumentSymbolParams:N,asCodeLensParams:H,asDocumentLink:V,asDocumentLinkParams:he,asCallHierarchyItem:ge,asTypeHierarchyItem:me,asInlayHint:ce,asWorkspaceSymbol:ke}}qo.createConverter=ET});var cp=x(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.createConverter=void 0;var W=require("vscode"),re=De(),gn=Rn(),Re=xo(),xT=_a(),kT=Ea(),qT=ka(),OT=Oa(),sp=Na(),IT=La(),NT=Ma(),FT=$a(),LT=Wa(),ap=De(),Oo;(function(n){function e(t){let r=t;return r&&gn.string(r.language)&&gn.string(r.value)}n.is=e})(Oo||(Oo={}));function AT(n,e,t){let i=n||(u=>W.Uri.parse(u));function o(u){return i(u)}function s(u){let _=[];for(let j of u)if(typeof j=="string")_.push(j);else if(ap.TextDocumentFilter.is(j))_.push({language:j.language,scheme:j.scheme,pattern:j.pattern});else if(ap.NotebookCellTextDocumentFilter.is(j))if(typeof j.notebook=="string")_.push({notebookType:j.notebook,language:j.language});else{let J=j.notebook.notebookType??"*";_.push({notebookType:J,scheme:j.notebook.scheme,pattern:j.notebook.pattern,language:j.language})}return _}async function a(u,_){return Re.map(u,l,_)}function c(u){let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=l(u[j]);return _}function l(u){let _=new sp.ProtocolDiagnostic(b(u.range),u.message,I(u.severity),u.data);if(u.code!==void 0){if(typeof u.code=="string"||typeof u.code=="number")re.CodeDescription.is(u.codeDescription)?_.code={value:u.code,target:o(u.codeDescription.href)}:_.code=u.code;else if(sp.DiagnosticCode.is(u.code)){_.hasDiagnosticCode=!0;let j=u.code;_.code={value:j.value,target:o(j.target)}}}return u.source&&(_.source=u.source),u.relatedInformation&&(_.relatedInformation=g(u.relatedInformation)),Array.isArray(u.tags)&&(_.tags=v(u.tags)),_}function g(u){let _=new Array(u.length);for(let j=0;j<u.length;j++){let J=u[j];_[j]=new W.DiagnosticRelatedInformation(Xe(J.location),J.message)}return _}function v(u){if(!u)return;let _=[];for(let j of u){let J=h(j);J!==void 0&&_.push(J)}return _.length>0?_:void 0}function h(u){switch(u){case re.DiagnosticTag.Unnecessary:return W.DiagnosticTag.Unnecessary;case re.DiagnosticTag.Deprecated:return W.DiagnosticTag.Deprecated;default:return}}function C(u){return u?new W.Position(u.line,u.character):void 0}function b(u){return u?new W.Range(u.start.line,u.start.character,u.end.line,u.end.character):void 0}async function k(u,_){return Re.map(u,j=>new W.Range(j.start.line,j.start.character,j.end.line,j.end.character),_)}function I(u){if(u==null)return W.DiagnosticSeverity.Error;switch(u){case re.DiagnosticSeverity.Error:return W.DiagnosticSeverity.Error;case re.DiagnosticSeverity.Warning:return W.DiagnosticSeverity.Warning;case re.DiagnosticSeverity.Information:return W.DiagnosticSeverity.Information;case re.DiagnosticSeverity.Hint:return W.DiagnosticSeverity.Hint}return W.DiagnosticSeverity.Error}function O(u){if(gn.string(u))return q(u);if(Oo.is(u))return q().appendCodeblock(u.value,u.language);if(Array.isArray(u)){let _=[];for(let j of u){let J=q();Oo.is(j)?J.appendCodeblock(j.value,j.language):J.appendMarkdown(j),_.push(J)}return _}else return q(u)}function M(u){if(gn.string(u))return u;switch(u.kind){case re.MarkupKind.Markdown:return q(u.value);case re.MarkupKind.PlainText:return u.value;default:return`Unsupported Markup content received. Kind is: ${u.kind}`}}function q(u){let _;if(u===void 0||typeof u=="string")_=new W.MarkdownString(u);else switch(u.kind){case re.MarkupKind.Markdown:_=new W.MarkdownString(u.value);break;case re.MarkupKind.PlainText:_=new W.MarkdownString,_.appendText(u.value);break;default:_=new W.MarkdownString,_.appendText(`Unsupported Markup content received. Kind is: ${u.kind}`);break}return _.isTrusted=e,_.supportHtml=t,_}function $(u){if(!!u)return new W.Hover(O(u.contents),b(u.range))}async function K(u,_,j){if(!u)return;if(Array.isArray(u))return Re.map(u,fr=>rt(fr,_),j);let J=u,{range:ut,inserting:it,replacing:ee,commitCharacters:rn}=fe(J,_),on=await Re.map(J.items,fr=>{var ui,jc;let Nr=rt(fr,rn,(ui=J.itemDefaults)==null?void 0:ui.insertTextMode,(jc=J.itemDefaults)==null?void 0:jc.insertTextFormat);return Nr.range===void 0&&(ut!==void 0?Nr.range=ut:it!==void 0&&ee!==void 0&&(Nr.range={inserting:it,replacing:ee})),Nr},j);return new W.CompletionList(on,J.isIncomplete)}function fe(u,_){var ut,it;let j=(ut=u.itemDefaults)==null?void 0:ut.editRange,J=((it=u.itemDefaults)==null?void 0:it.commitCharacters)??_;return re.Range.is(j)?{range:b(j),inserting:void 0,replacing:void 0,commitCharacters:J}:j!==void 0?{range:void 0,inserting:b(j.insert),replacing:b(j.replace),commitCharacters:J}:{range:void 0,inserting:void 0,replacing:void 0,commitCharacters:J}}function Y(u){return re.CompletionItemKind.Text<=u&&u<=re.CompletionItemKind.TypeParameter?[u-1,void 0]:[W.CompletionItemKind.Text,u]}function He(u){switch(u){case re.CompletionItemTag.Deprecated:return W.CompletionItemTag.Deprecated}}function Ge(u){if(u==null)return[];let _=[];for(let j of u){let J=He(j);J!==void 0&&_.push(J)}return _}function rt(u,_,j,J){let ut=Ge(u.tags),it=Dt(u),ee=new xT.default(it);u.detail&&(ee.detail=u.detail),u.documentation&&(ee.documentation=M(u.documentation),ee.documentationFormat=gn.string(u.documentation)?"$string":u.documentation.kind),u.filterText&&(ee.filterText=u.filterText);let rn=gt(u,J);if(rn&&(ee.insertText=rn.text,ee.range=rn.range,ee.fromEdit=rn.fromEdit),gn.number(u.kind)){let[Nr,ui]=Y(u.kind);ee.kind=Nr,ui&&(ee.originalItemKind=ui)}u.sortText&&(ee.sortText=u.sortText),u.additionalTextEdits&&(ee.additionalTextEdits=vt(u.additionalTextEdits));let on=u.commitCharacters!==void 0?gn.stringArray(u.commitCharacters)?u.commitCharacters:void 0:_;on&&(ee.commitCharacters=on.slice()),u.command&&(ee.command=Qe(u.command)),(u.deprecated===!0||u.deprecated===!1)&&(ee.deprecated=u.deprecated,u.deprecated===!0&&ut.push(W.CompletionItemTag.Deprecated)),(u.preselect===!0||u.preselect===!1)&&(ee.preselect=u.preselect),u.data!==void 0&&(ee.data=u.data),ut.length>0&&(ee.tags=ut);let fr=u.insertTextMode??j;return fr!==void 0&&(ee.insertTextMode=fr,fr===re.InsertTextMode.asIs&&(ee.keepWhitespace=!0)),ee}function Dt(u){return re.CompletionItemLabelDetails.is(u.labelDetails)?{label:u.label,detail:u.labelDetails.detail,description:u.labelDetails.description}:u.label}function gt(u,_){let j=u.insertTextFormat??_;return u.textEdit?j===re.InsertTextFormat.Snippet?{text:new W.SnippetString(u.textEdit.newText),range:mt(u.textEdit),fromEdit:!0}:{text:u.textEdit.newText,range:mt(u.textEdit),fromEdit:!0}:u.insertText?j===re.InsertTextFormat.Snippet?{text:new W.SnippetString(u.insertText),fromEdit:!1}:{text:u.insertText,fromEdit:!1}:void 0}function mt(u){return re.InsertReplaceEdit.is(u)?{inserting:b(u.insert),replacing:b(u.replace)}:b(u.range)}function St(u){if(!!u)return new W.TextEdit(b(u.range),u.newText)}async function at(u,_){if(!!u)return Re.map(u,St,_)}function vt(u){if(!u)return;let _=new Array(u.length);for(let j=0;j<u.length;j++)_[j]=St(u[j]);return _}async function xn(u,_){if(!u)return;let j=new W.SignatureHelp;return gn.number(u.activeSignature)?j.activeSignature=u.activeSignature:j.activeSignature=0,gn.number(u.activeParameter)?j.activeParameter=u.activeParameter:j.activeParameter=0,u.signatures&&(j.signatures=await Le(u.signatures,_)),j}async function Le(u,_){return Re.mapAsync(u,tt,_)}async function tt(u,_){let j=new W.SignatureInformation(u.label);return u.documentation!==void 0&&(j.documentation=M(u.documentation)),u.parameters!==void 0&&(j.parameters=await ct(u.parameters,_)),u.activeParameter!==void 0&&(j.activeParameter=u.activeParameter),j}function ct(u,_){return Re.map(u,Nt,_)}function Nt(u){let _=new W.ParameterInformation(u.label);return u.documentation&&(_.documentation=M(u.documentation)),_}function Xe(u){return u?new W.Location(i(u.uri),b(u.range)):void 0}async function ur(u,_){if(!!u)return kn(u,_)}async function Vn(u,_){if(!!u)return kn(u,_)}function Bn(u){if(!u)return;let _={targetUri:i(u.targetUri),targetRange:b(u.targetRange),originSelectionRange:b(u.originSelectionRange),targetSelectionRange:b(u.targetSelectionRange)};if(!_.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return _}async function kn(u,_){if(!!u)if(gn.array(u)){if(u.length===0)return[];if(re.LocationLink.is(u[0])){let j=u;return Re.map(j,Bn,_)}else{let j=u;return Re.map(j,Xe,_)}}else return re.LocationLink.is(u)?[Bn(u)]:Xe(u)}async function qn(u,_){if(!!u)return Re.map(u,Xe,_)}async function lr(u,_){if(!!u)return Re.map(u,Gn,_)}function Gn(u){let _=new W.DocumentHighlight(b(u.range));return gn.number(u.kind)&&(_.kind=Xn(u.kind)),_}function Xn(u){switch(u){case re.DocumentHighlightKind.Text:return W.DocumentHighlightKind.Text;case re.DocumentHighlightKind.Read:return W.DocumentHighlightKind.Read;case re.DocumentHighlightKind.Write:return W.DocumentHighlightKind.Write}return W.DocumentHighlightKind.Text}async function yt(u,_){if(!!u)return Re.map(u,On,_)}function Bt(u){return u<=re.SymbolKind.TypeParameter?u-1:W.SymbolKind.Property}function Qn(u){switch(u){case re.SymbolTag.Deprecated:return W.SymbolTag.Deprecated;default:return}}function Mt(u){if(u==null)return;let _=[];for(let j of u){let J=Qn(j);J!==void 0&&_.push(J)}return _.length===0?void 0:_}function On(u){let _=u.data,j=u.location,J=j.range===void 0||_!==void 0?new FT.default(u.name,Bt(u.kind),u.containerName??"",j.range===void 0?i(j.uri):new W.Location(i(u.location.uri),b(j.range)),_):new W.SymbolInformation(u.name,Bt(u.kind),u.containerName??"",new W.Location(i(u.location.uri),b(j.range)));return Ft(J,u),J}async function Cn(u,_){if(u!=null)return Re.map(u,jt,_)}function jt(u){let _=new W.DocumentSymbol(u.name,u.detail||"",Bt(u.kind),b(u.range),b(u.selectionRange));if(Ft(_,u),u.children!==void 0&&u.children.length>0){let j=[];for(let J of u.children)j.push(jt(J));_.children=j}return _}function Ft(u,_){u.tags=Mt(_.tags),_.deprecated&&(u.tags?u.tags.includes(W.SymbolTag.Deprecated)||(u.tags=u.tags.concat(W.SymbolTag.Deprecated)):u.tags=[W.SymbolTag.Deprecated])}function Qe(u){let _={title:u.title,command:u.command};return u.arguments&&(_.arguments=u.arguments),_}async function dr(u,_){if(!!u)return Re.map(u,Qe,_)}let _t=new Map;_t.set(re.CodeActionKind.Empty,W.CodeActionKind.Empty),_t.set(re.CodeActionKind.QuickFix,W.CodeActionKind.QuickFix),_t.set(re.CodeActionKind.Refactor,W.CodeActionKind.Refactor),_t.set(re.CodeActionKind.RefactorExtract,W.CodeActionKind.RefactorExtract),_t.set(re.CodeActionKind.RefactorInline,W.CodeActionKind.RefactorInline),_t.set(re.CodeActionKind.RefactorRewrite,W.CodeActionKind.RefactorRewrite),_t.set(re.CodeActionKind.Source,W.CodeActionKind.Source),_t.set(re.CodeActionKind.SourceOrganizeImports,W.CodeActionKind.SourceOrganizeImports);function $t(u){if(u==null)return;let _=_t.get(u);if(_)return _;let j=u.split(".");_=W.CodeActionKind.Empty;for(let J of j)_=_.append(J);return _}function wn(u){if(u!=null)return u.map(_=>$t(_))}async function In(u,_){if(u==null)return;let j=new OT.default(u.title,u.data);return u.kind!==void 0&&(j.kind=$t(u.kind)),u.diagnostics!==void 0&&(j.diagnostics=c(u.diagnostics)),u.edit!==void 0&&(j.edit=await R(u.edit,_)),u.command!==void 0&&(j.command=Qe(u.command)),u.isPreferred!==void 0&&(j.isPreferred=u.isPreferred),u.disabled!==void 0&&(j.disabled={reason:u.disabled.reason}),j}function Nn(u,_){return Re.mapAsync(u,async j=>re.Command.is(j)?Qe(j):In(j,_),_)}function Ht(u){if(!u)return;let _=new kT.default(b(u.range));return u.command&&(_.command=Qe(u.command)),u.data!==void 0&&u.data!==null&&(_.data=u.data),_}async function Gt(u,_){if(!!u)return Re.map(u,Ht,_)}async function R(u,_){if(!u)return;let j=new Map;if(u.changeAnnotations!==void 0){let it=u.changeAnnotations;await Re.forEach(Object.keys(it),ee=>{let rn=N(it[ee]);j.set(ee,rn)},_)}let J=it=>{if(it!==void 0)return j.get(it)},ut=new W.WorkspaceEdit;if(u.documentChanges){let it=u.documentChanges;await Re.forEach(it,ee=>{if(re.CreateFile.is(ee))ut.createFile(i(ee.uri),ee.options,J(ee.annotationId));else if(re.RenameFile.is(ee))ut.renameFile(i(ee.oldUri),i(ee.newUri),ee.options,J(ee.annotationId));else if(re.DeleteFile.is(ee))ut.deleteFile(i(ee.uri),ee.options,J(ee.annotationId));else if(re.TextDocumentEdit.is(ee)){let rn=i(ee.textDocument.uri);for(let on of ee.edits)re.AnnotatedTextEdit.is(on)?ut.replace(rn,b(on.range),on.newText,J(on.annotationId)):ut.replace(rn,b(on.range),on.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(ee,void 0,4)}`)},_)}else if(u.changes){let it=u.changes;await Re.forEach(Object.keys(it),ee=>{ut.set(i(ee),vt(it[ee]))},_)}return ut}function N(u){if(u!==void 0)return{label:u.label,needsConfirmation:!!u.needsConfirmation,description:u.description}}function H(u){let _=b(u.range),j=u.target?o(u.target):void 0,J=new qT.default(_,j);return u.tooltip!==void 0&&(J.tooltip=u.tooltip),u.data!==void 0&&u.data!==null&&(J.data=u.data),J}async function V(u,_){if(!!u)return Re.map(u,H,_)}function he(u){return new W.Color(u.red,u.green,u.blue,u.alpha)}function ge(u){return new W.ColorInformation(b(u.range),he(u.color))}async function me(u,_){if(!!u)return Re.map(u,ge,_)}function ke(u){let _=new W.ColorPresentation(u.label);return _.additionalTextEdits=vt(u.additionalTextEdits),u.textEdit&&(_.textEdit=St(u.textEdit)),_}async function ce(u,_){if(!!u)return Re.map(u,ke,_)}function Ce(u){if(u)switch(u){case re.FoldingRangeKind.Comment:return W.FoldingRangeKind.Comment;case re.FoldingRangeKind.Imports:return W.FoldingRangeKind.Imports;case re.FoldingRangeKind.Region:return W.FoldingRangeKind.Region}}function ue(u){return new W.FoldingRange(u.startLine,u.endLine,Ce(u.kind))}async function p(u,_){if(!!u)return Re.map(u,ue,_)}function E(u){return new W.SelectionRange(b(u.range),u.parent?E(u.parent):void 0)}async function z(u,_){return Array.isArray(u)?Re.map(u,E,_):[]}function S(u){return re.InlineValueText.is(u)?new W.InlineValueText(b(u.range),u.text):re.InlineValueVariableLookup.is(u)?new W.InlineValueVariableLookup(b(u.range),u.variableName,u.caseSensitiveLookup):new W.InlineValueEvaluatableExpression(b(u.range),u.expression)}async function f(u,_){return Array.isArray(u)?Re.map(u,S,_):[]}async function T(u,_){let j=typeof u.label=="string"?u.label:await Re.map(u.label,D,_),J=new LT.default(C(u.position),j);return u.kind!==void 0&&(J.kind=u.kind),u.textEdits!==void 0&&(J.textEdits=await at(u.textEdits,_)),u.tooltip!==void 0&&(J.tooltip=m(u.tooltip)),u.paddingLeft!==void 0&&(J.paddingLeft=u.paddingLeft),u.paddingRight!==void 0&&(J.paddingRight=u.paddingRight),u.data!==void 0&&(J.data=u.data),J}function D(u){let _=new W.InlayHintLabelPart(u.value);return u.location!==void 0&&(_.location=Xe(u.location)),u.tooltip!==void 0&&(_.tooltip=m(u.tooltip)),u.command!==void 0&&(_.command=Qe(u.command)),_}function m(u){return typeof u=="string"?u:q(u)}async function d(u,_){if(!!Array.isArray(u))return Re.mapAsync(u,T,_)}function P(u){if(u===null)return;let _=new IT.default(Bt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function F(u,_){if(u!==null)return Re.map(u,P,_)}async function ne(u,_){return new W.CallHierarchyIncomingCall(P(u.from),await k(u.fromRanges,_))}async function Pe(u,_){if(u!==null)return Re.mapAsync(u,ne,_)}async function Ae(u,_){return new W.CallHierarchyOutgoingCall(P(u.to),await k(u.fromRanges,_))}async function Wt(u,_){if(u!==null)return Re.mapAsync(u,Ae,_)}async function zt(u,_){if(u!=null)return new W.SemanticTokens(new Uint32Array(u.data),u.resultId)}function Xt(u){return new W.SemanticTokensEdit(u.start,u.deleteCount,u.data!==void 0?new Uint32Array(u.data):void 0)}async function de(u,_){if(u!=null)return new W.SemanticTokensEdits(u.edits.map(Xt),u.resultId)}function Jn(u){return u}async function Ir(u,_){if(u!=null)return new W.LinkedEditingRanges(await k(u.ranges,_),no(u.wordPattern))}function no(u){if(u!=null)return new RegExp(u)}function Mc(u){if(u===null)return;let _=new NT.default(Bt(u.kind),u.name,u.detail||"",o(u.uri),b(u.range),b(u.selectionRange),u.data);return u.tags!==void 0&&(_.tags=Mt(u.tags)),_}async function gv(u,_){if(u!==null)return Re.map(u,Mc,_)}return{asUri:o,asDocumentSelector:s,asDiagnostics:a,asDiagnostic:l,asRange:b,asRanges:k,asPosition:C,asDiagnosticSeverity:I,asDiagnosticTag:h,asHover:$,asCompletionResult:K,asCompletionItem:rt,asTextEdit:St,asTextEdits:at,asSignatureHelp:xn,asSignatureInformations:Le,asSignatureInformation:tt,asParameterInformations:ct,asParameterInformation:Nt,asDeclarationResult:ur,asDefinitionResult:Vn,asLocation:Xe,asReferences:qn,asDocumentHighlights:lr,asDocumentHighlight:Gn,asDocumentHighlightKind:Xn,asSymbolKind:Bt,asSymbolTag:Qn,asSymbolTags:Mt,asSymbolInformations:yt,asSymbolInformation:On,asDocumentSymbols:Cn,asDocumentSymbol:jt,asCommand:Qe,asCommands:dr,asCodeAction:In,asCodeActionKind:$t,asCodeActionKinds:wn,asCodeActionResult:Nn,asCodeLens:Ht,asCodeLenses:Gt,asWorkspaceEdit:R,asDocumentLink:H,asDocumentLinks:V,asFoldingRangeKind:Ce,asFoldingRange:ue,asFoldingRanges:p,asColor:he,asColorInformation:ge,asColorInformations:me,asColorPresentation:ke,asColorPresentations:ce,asSelectionRange:E,asSelectionRanges:z,asInlineValue:S,asInlineValues:f,asInlayHint:T,asInlayHints:d,asSemanticTokensLegend:Jn,asSemanticTokens:zt,asSemanticTokensEdit:Xt,asSemanticTokensEdits:de,asCallHierarchyItem:P,asCallHierarchyItems:F,asCallHierarchyIncomingCall:ne,asCallHierarchyIncomingCalls:Pe,asCallHierarchyOutgoingCall:Ae,asCallHierarchyOutgoingCalls:Wt,asLinkedEditingRanges:Ir,asTypeHierarchyItem:Mc,asTypeHierarchyItems:gv}}Io.createConverter=AT});var Jr=x(tn=>{"use strict";Object.defineProperty(tn,"__esModule",{value:!0});tn.generateUuid=tn.parse=tn.isUUID=tn.v4=tn.empty=void 0;var No=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},le=class extends No{constructor(){super([le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),"-",le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),"-","4",le._randomHex(),le._randomHex(),le._randomHex(),"-",le._oneOf(le._timeHighBits),le._randomHex(),le._randomHex(),le._randomHex(),"-",le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex(),le._randomHex()].join(""))}static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return le._oneOf(le._chars)}};le._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];le._timeHighBits=["8","9","a","b"];tn.empty=new No("00000000-0000-0000-0000-000000000000");function up(){return new le}tn.v4=up;var MT=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function lp(n){return MT.test(n)}tn.isUUID=lp;function jT(n){if(!lp(n))throw new Error("invalid uuid");return new No(n)}tn.parse=jT;function $T(){return up().asHex()}tn.generateUuid=$T});var Ua=x(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.ProgressPart=void 0;var dp=require("vscode"),fp=De(),pp=Rn(),hp=class{constructor(e,t,r){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(fp.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),r&&r(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&dp.window.withProgress({location:dp.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,r)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=r,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(fp.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,o)=>{this._resolve=i,this._reject=o})})}report(e){if(this._infinite&&pp.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(pp.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),r=Math.max(0,t-this._reported);this._reported+=r,this._progress!==void 0&&this._progress.report({message:e.message,increment:r})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};Fo.ProgressPart=hp});var pt=x(xe=>{"use strict";Object.defineProperty(xe,"__esModule",{value:!0});xe.BaseLanguageClient=xe.LSPCancellationError=xe.MessageTransports=xe.TextDocumentFeature=xe.State=xe.RevealOutputChannelOn=xe.DiagnosticPullMode=xe.CloseAction=xe.ErrorAction=void 0;var U=require("vscode"),w=De(),HT=Da(),WT=op(),zT=cp(),Se=Rn(),Ka=xo(),_e=Jr(),UT=Ua(),gp=class{error(e){(0,w.RAL)().console.error(e)}warn(e){(0,w.RAL)().console.warn(e)}info(e){(0,w.RAL)().console.info(e)}log(e){(0,w.RAL)().console.log(e)}};function KT(n,e,t,r,i){let o=new gp,s=(0,w.createProtocolConnection)(n,e,o,i);return s.onError(c=>{t(c[0],c[1],c[2])}),s.onClose(r),{listen:()=>s.listen(),sendRequest:(c,...l)=>s.sendRequest(c,...l),onRequest:(c,l)=>s.onRequest(c,l),sendNotification:(c,l)=>s.sendNotification(c,l),onNotification:(c,l)=>s.onNotification(c,l),onProgress:s.onProgress,sendProgress:s.sendProgress,trace:(c,l,g)=>{let v={sendNotification:!1,traceFormat:w.TraceFormat.Text};g===void 0?s.trace(c,l,v):(Se.boolean(g),s.trace(c,l,g))},initialize:c=>s.sendRequest(w.InitializeRequest.type,c),shutdown:()=>s.sendRequest(w.ShutdownRequest.type,void 0),exit:()=>s.sendNotification(w.ExitNotification.type),onLogMessage:c=>s.onNotification(w.LogMessageNotification.type,c),onShowMessage:c=>s.onNotification(w.ShowMessageNotification.type,c),onTelemetry:c=>s.onNotification(w.TelemetryEventNotification.type,c),didChangeConfiguration:c=>s.sendNotification(w.DidChangeConfigurationNotification.type,c),didChangeWatchedFiles:c=>s.sendNotification(w.DidChangeWatchedFilesNotification.type,c),didOpenTextDocument:c=>s.sendNotification(w.DidOpenTextDocumentNotification.type,c),didChangeTextDocument:c=>s.sendNotification(w.DidChangeTextDocumentNotification.type,c),didCloseTextDocument:c=>s.sendNotification(w.DidCloseTextDocumentNotification.type,c),didSaveTextDocument:c=>s.sendNotification(w.DidSaveTextDocumentNotification.type,c),onDiagnostics:c=>s.onNotification(w.PublishDiagnosticsNotification.type,c),end:()=>s.end(),dispose:()=>s.dispose()}}var Ao;(function(n){n[n.Continue=1]="Continue",n[n.Shutdown=2]="Shutdown"})(Ao=xe.ErrorAction||(xe.ErrorAction={}));var _r;(function(n){n[n.DoNotRestart=1]="DoNotRestart",n[n.Restart=2]="Restart"})(_r=xe.CloseAction||(xe.CloseAction={}));var mp=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,r){return r&&r<=3?{action:Ao.Continue}:{action:Ao.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:_r.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:_r.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:_r.Restart})}},VT;(function(n){n.onType="onType",n.onSave="onSave"})(VT=xe.DiagnosticPullMode||(xe.DiagnosticPullMode={}));var Wi;(function(n){n[n.Info=1]="Info",n[n.Warn=2]="Warn",n[n.Error=3]="Error",n[n.Never=4]="Never"})(Wi=xe.RevealOutputChannelOn||(xe.RevealOutputChannelOn={}));var Lo;(function(n){n[n.Stopped=1]="Stopped",n[n.Starting=3]="Starting",n[n.Running=2]="Running"})(Lo=xe.State||(xe.State={}));var Ne;(function(n){n[n.Initial=0]="Initial",n[n.Starting=1]="Starting",n[n.StartFailed=2]="StartFailed",n[n.Running=3]="Running",n[n.Stopping=4]="Stopping",n[n.Stopped=5]="Stopped"})(Ne||(Ne={}));var vp=[w.SymbolKind.File,w.SymbolKind.Module,w.SymbolKind.Namespace,w.SymbolKind.Package,w.SymbolKind.Class,w.SymbolKind.Method,w.SymbolKind.Property,w.SymbolKind.Field,w.SymbolKind.Constructor,w.SymbolKind.Enum,w.SymbolKind.Interface,w.SymbolKind.Function,w.SymbolKind.Variable,w.SymbolKind.Constant,w.SymbolKind.String,w.SymbolKind.Number,w.SymbolKind.Boolean,w.SymbolKind.Array,w.SymbolKind.Object,w.SymbolKind.Key,w.SymbolKind.Null,w.SymbolKind.EnumMember,w.SymbolKind.Struct,w.SymbolKind.Event,w.SymbolKind.Operator,w.SymbolKind.TypeParameter],BT=[w.CompletionItemKind.Text,w.CompletionItemKind.Method,w.CompletionItemKind.Function,w.CompletionItemKind.Constructor,w.CompletionItemKind.Field,w.CompletionItemKind.Variable,w.CompletionItemKind.Class,w.CompletionItemKind.Interface,w.CompletionItemKind.Module,w.CompletionItemKind.Property,w.CompletionItemKind.Unit,w.CompletionItemKind.Value,w.CompletionItemKind.Enum,w.CompletionItemKind.Keyword,w.CompletionItemKind.Snippet,w.CompletionItemKind.Color,w.CompletionItemKind.File,w.CompletionItemKind.Reference,w.CompletionItemKind.Folder,w.CompletionItemKind.EnumMember,w.CompletionItemKind.Constant,w.CompletionItemKind.Struct,w.CompletionItemKind.Event,w.CompletionItemKind.Operator,w.CompletionItemKind.TypeParameter],yp=[w.SymbolTag.Deprecated];function X(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var zi;(function(n){function e(t){let r=U.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:r.get("trimTrailingWhitespace"),trimFinalNewlines:r.get("trimFinalNewlines"),insertFinalNewline:r.get("insertFinalNewline")}}n.fromConfiguration=e})(zi||(zi={}));var Va;(function(n){function e(t){let r=t;return r&&Se.func(r.register)&&Se.func(r.unregister)&&Se.func(r.dispose)&&r.registrationType!==void 0}n.is=e})(Va||(Va={}));var Dn=class{constructor(e,t,r,i,o,s){this._client=e,this._event=t,this._type=r,this._middleware=i,this._createParams=o,this._selectorFilter=s,this._selectors=new Map,this._onNotificationSent=new U.EventEmitter}static textDocumentFilter(e,t){for(let r of e)if(U.languages.match(r,t))return!0;return!1}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(r=>{this._client.error(`Sending document notification ${this._type.method} failed.`,r)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async r=>{let i=this._createParams(r);await this._client.sendNotification(this._type,i).catch(),this.notificationSent(r,this._type,i)};if(!this._selectorFilter||this._selectorFilter(this._selectors.values(),e))return this._middleware?this._middleware(e,r=>t(r)):t(e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(U.languages.match(t,e))return{send:r=>this.callback(r)}}},Cp=class extends Dn{constructor(e,t){super(e,U.workspace.onDidOpenTextDocument,w.DidOpenTextDocumentNotification.type,e.clientOptions.middleware.didOpen,r=>e.code2ProtocolConverter.asOpenTextDocumentParams(r),Dn.textDocumentFilter);this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return w.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);U.workspace.textDocuments.forEach(r=>{let i=r.uri.toString();if(!this._syncedDocuments.has(i)&&U.languages.match(t,r)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));(o.didOpen?o.didOpen(r,s):s(r)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,r)}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.set(e.uri.toString(),e)}},wp=class extends Dn{constructor(e,t){super(e,U.workspace.onDidCloseTextDocument,w.DidCloseTextDocumentNotification.type,e.clientOptions.middleware.didClose,r=>e.code2ProtocolConverter.asCloseTextDocumentParams(r),Dn.textDocumentFilter);this._syncedDocuments=t}get registrationType(){return w.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.openClose&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}notificationSent(e,t,r){super.notificationSent(e,t,r),this._syncedDocuments.delete(e.uri.toString())}unregister(e){let t=this._selectors.get(e);super.unregister(e);let r=this._selectors.values();this._syncedDocuments.forEach(i=>{if(U.languages.match(t,i)&&!this._selectorFilter(r,i)){let o=this._client.clientOptions.middleware,s=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(o.didClose?o.didClose(i,s):s(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}},Rp=class{constructor(e){this._client=e,this._changeData=new Map,this._forcingDelivery=!1,this._onNotificationSent=new U.EventEmitter}get registrationType(){return w.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.change!==void 0&&r.change!==w.TextDocumentSyncKind.None&&this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:r.change})})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}))}async callback(e){if(e.contentChanges.length===0)return;let t=[];for(let r of this._changeData.values())if(U.languages.match(r.documentSelector,e.document)){let i=this._client.clientOptions.middleware;if(r.syncKind===w.TextDocumentSyncKind.Incremental){let o=async s=>{let a=this._client.code2ProtocolConverter.asChangeTextDocumentParams(s);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,a),this.notificationSent(s,w.DidChangeTextDocumentNotification.type,a)};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}else if(r.syncKind===w.TextDocumentSyncKind.Full){let o=async s=>{let a=async c=>{let l=this._client.code2ProtocolConverter.asChangeTextDocumentParams(c.document);await this._client.sendNotification(w.DidChangeTextDocumentNotification.type,l),this.notificationSent(c,w.DidChangeTextDocumentNotification.type,l)};return this._changeDelayer?(this._changeDelayer.uri!==s.document.uri.toString()&&(this.forceDelivery(),this._changeDelayer.uri=s.document.uri.toString()),this._changeDelayer.delayer.trigger(()=>a(s))):(this._changeDelayer={uri:s.document.uri.toString(),delayer:new Ka.Delayer(200)},this._changeDelayer.delayer.trigger(()=>a(s),-1))};t.push(i.didChange?i.didChange(e,s=>o(s)):o(e))}}return Promise.all(t).then(void 0,r=>{throw this._client.error(`Sending document notification ${w.DidChangeTextDocumentNotification.type.method} failed`,r),r})}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,r){this._onNotificationSent.fire({original:e,type:t,params:r})}unregister(e){this._changeData.delete(e),this._changeData.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._changeDelayer!==void 0&&this._changeDelayer.delayer.cancel(),this._changeDelayer=void 0,this._forcingDelivery=!1,this._changeData.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}forceDelivery(){if(!(this._forcingDelivery||!this._changeDelayer))try{this._forcingDelivery=!0,this._changeDelayer.delayer.forceDelivery()}finally{this._forcingDelivery=!1}}getProvider(e){for(let t of this._changeData.values())if(U.languages.match(t.documentSelector,e))return{send:r=>this.callback(r)}}},bp=class extends Dn{constructor(e){super(e,U.workspace.onWillSaveTextDocument,w.WillSaveTextDocumentNotification.type,e.clientOptions.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),(t,r)=>Dn.textDocumentFilter(t,r.document))}get registrationType(){return w.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSave&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}},Tp=class{constructor(e){this._client=e,this._selectors=new Map}get registrationType(){return w.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;t&&r&&r.willSaveWaitUntil&&this.register({id:_e.generateUuid(),registerOptions:{documentSelector:t}})}register(e){!e.registerOptions.documentSelector||(this._listener||(this._listener=U.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Dn.textDocumentFilter(this._selectors.values(),e.document)){let t=this._client.clientOptions.middleware,r=i=>this._client.sendRequest(w.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async o=>{let s=await this._client.protocol2CodeConverter.asTextEdits(o);return s===void 0?[]:s});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,r):r(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}},Dp=class extends Dn{constructor(e){super(e,U.workspace.onDidSaveTextDocument,w.DidSaveTextDocumentNotification.type,e.clientOptions.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),Dn.textDocumentFilter);this._includeText=!1}get registrationType(){return w.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){X(X(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let r=e.resolvedTextDocumentSync;if(t&&r&&r.save){let i=typeof r.save=="boolean"?{includeText:!1}:{includeText:!!r.save.includeText};this.register({id:_e.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}},Sp=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}get registrationType(){return w.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let r of e.registerOptions.watchers){if(!Se.string(r.globPattern))continue;let i=!0,o=!0,s=!0;r.kind!==void 0&&r.kind!==null&&(i=(r.kind&w.WatchKind.Create)!==0,o=(r.kind&w.WatchKind.Change)!==0,s=(r.kind&w.WatchKind.Delete)!==0);let a=U.workspace.createFileSystemWatcher(r.globPattern,!i,!o,!s);this.hookListeners(a,i,o,s),t.push(a)}this._watchers.set(e.id,t)}registerRaw(e,t){let r=[];for(let i of t)this.hookListeners(i,!0,!0,!0,r);this._watchers.set(e,r)}hookListeners(e,t,r,i,o){t&&e.onDidCreate(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Created}),null,o),r&&e.onDidChange(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Changed}),null,o),i&&e.onDidDelete(s=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(s),type:w.FileChangeType.Deleted}),null,o)}unregister(e){let t=this._watchers.get(e);if(t)for(let r of t)r.dispose()}dispose(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}},bt=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(w.TextDocumentRegistrationOptions.is(t)){let r=w.StaticRegistrationOptions.hasId(t)?t.id:_e.generateUuid(),i=t.documentSelector||e;if(i)return[r,Object.assign({},t,{documentSelector:i})]}else if(Se.boolean(t)&&t===!0||w.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let r=Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[_e.generateUuid(),r]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Se.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let r=t.data.registerOptions.documentSelector;if(r!==null&&U.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(r),e))return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};xe.TextDocumentFeature=bt;var _p=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}dispose(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}},Pp=class extends bt{constructor(e){super(e,w.CompletionRequest.type);this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[w.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[w.InsertTextMode.asIs,w.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=w.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:BT},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode"]}}initialize(e,t){let r=this.getRegistrationOptions(t,e.completionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e,t){var a;this.labelDetailsSupport.set(t,!!((a=e.completionItem)!=null&&a.labelDetailsSupport));let r=e.triggerCharacters??[],i=e.allCommitCharacters,o=e.documentSelector,s={provideCompletionItems:(c,l,g,v)=>{let h=this._client,C=this._client.clientOptions.middleware,b=(k,I,O,M)=>h.sendRequest(w.CompletionRequest.type,h.code2ProtocolConverter.asCompletionParams(k,I,O),M).then(q=>M.isCancellationRequested?null:h.protocol2CodeConverter.asCompletionResult(q,i,M),q=>h.handleFailedRequest(w.CompletionRequest.type,M,q,null));return C.provideCompletionItem?C.provideCompletionItem(c,l,v,g,b):b(c,l,v,g)},resolveCompletionItem:e.resolveProvider?(c,l)=>{let g=this._client,v=this._client.clientOptions.middleware,h=(C,b)=>g.sendRequest(w.CompletionResolveRequest.type,g.code2ProtocolConverter.asCompletionItem(C,!!this.labelDetailsSupport.get(t)),b).then(k=>b.isCancellationRequested?null:g.protocol2CodeConverter.asCompletionItem(k),k=>g.handleFailedRequest(w.CompletionResolveRequest.type,b,k,C));return v.resolveCompletionItem?v.resolveCompletionItem(c,l,h):h(c,l)}:void 0};return[U.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(o),s,...r),s]}},Ep=class extends bt{constructor(e){super(e,w.HoverRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[w.MarkupKind.Markdown,w.MarkupKind.PlainText]}initialize(e,t){let r=this.getRegistrationOptions(t,e.hoverProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideHover:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asHover(C),C=>a.handleFailedRequest(w.HoverRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideHover?l.provideHover(i,o,s,c):c(i,o,s)}};return[U.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},xp=class extends bt{constructor(e){super(e,w.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[w.MarkupKind.Markdown,w.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.signatureHelpProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSignatureHelp:(s,a,c,l)=>{let g=this._client,v=(C,b,k,I)=>g.sendRequest(w.SignatureHelpRequest.type,g.code2ProtocolConverter.asSignatureHelpParams(C,b,k),I).then(O=>I.isCancellationRequested?null:g.protocol2CodeConverter.asSignatureHelp(O,I),O=>g.handleFailedRequest(w.SignatureHelpRequest.type,I,O,null)),h=g.clientOptions.middleware;return h.provideSignatureHelp?h.provideSignatureHelp(s,a,l,c,v):v(s,a,l,c)}},i,o=this._client.protocol2CodeConverter.asDocumentSelector(t);if(e.retriggerCharacters===void 0){let s=e.triggerCharacters||[];i=U.languages.registerSignatureHelpProvider(o,r,...s)}else{let s={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};i=U.languages.registerSignatureHelpProvider(o,r,s)}return[i,r]}},kp=class extends bt{constructor(e){super(e,w.DefinitionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.definitionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDefinition:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(w.DefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDefinition?l.provideDefinition(i,o,s,c):c(i,o,s)}};return[U.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},qp=class extends bt{constructor(e){super(e,w.ReferencesRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.referencesProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideReferences:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>c.sendRequest(w.ReferencesRequest.type,c.code2ProtocolConverter.asReferenceParams(v,h,C),b).then(k=>b.isCancellationRequested?null:c.protocol2CodeConverter.asReferences(k,b),k=>c.handleFailedRequest(w.ReferencesRequest.type,b,k,null)),g=c.clientOptions.middleware;return g.provideReferences?g.provideReferences(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Op=class extends bt{constructor(e){super(e,w.DocumentHighlightRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentHighlightProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentHighlights:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(w.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(C,h),C=>a.handleFailedRequest(w.DocumentHighlightRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDocumentHighlights?l.provideDocumentHighlights(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Ip=class extends bt{constructor(e){super(e,w.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:vp},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:yp},t.labelSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentSymbolProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentSymbols:(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(g),v).then(async h=>{if(v.isCancellationRequested||h===void 0||h===null)return null;if(h.length===0)return[];{let C=h[0];return w.DocumentSymbol.is(C)?await a.protocol2CodeConverter.asDocumentSymbols(h,v):await a.protocol2CodeConverter.asSymbolInformations(h,v)}},h=>a.handleFailedRequest(w.DocumentSymbolRequest.type,v,h,null)),l=a.clientOptions.middleware;return l.provideDocumentSymbols?l.provideDocumentSymbols(o,s,c):c(o,s)}},i=e.label!==void 0?{label:e.label}:void 0;return[U.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,i),r]}},Np=class extends _p{constructor(e){super(e,w.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=X(X(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:vp},t.tagSupport={valueSet:yp},t.resolveSupport={properties:["location.range"]}}initialize(e){!e.workspaceSymbolProvider||this.register({id:_e.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolRequest.type,{query:c},l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformations(g,l),g=>o.handleFailedRequest(w.WorkspaceSymbolRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(r,i,s):s(r,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(r,i)=>{let o=this._client,s=(c,l)=>o.sendRequest(w.WorkspaceSymbolResolveRequest.type,o.code2ProtocolConverter.asWorkspaceSymbol(c),l).then(g=>l.isCancellationRequested?null:o.protocol2CodeConverter.asSymbolInformation(g),g=>o.handleFailedRequest(w.WorkspaceSymbolResolveRequest.type,l,g,null)),a=o.clientOptions.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(r,i,s):s(r,i)}:void 0};return[U.languages.registerWorkspaceSymbolProvider(t),t]}},Fp=class extends bt{constructor(e){super(e,w.CodeActionRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[w.CodeActionKind.Empty,w.CodeActionKind.QuickFix,w.CodeActionKind.Refactor,w.CodeActionKind.RefactorExtract,w.CodeActionKind.RefactorInline,w.CodeActionKind.RefactorRewrite,w.CodeActionKind.Source,w.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!1}initialize(e,t){let r=this.getRegistrationOptions(t,e.codeActionProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideCodeActions:(i,o,s,a)=>{let c=this._client,l=async(v,h,C,b)=>{let k={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h),context:await c.code2ProtocolConverter.asCodeActionContext(C,b)};return c.sendRequest(w.CodeActionRequest.type,k,b).then(I=>b.isCancellationRequested||I===null||I===void 0?null:c.protocol2CodeConverter.asCodeActionResult(I,b),I=>c.handleFailedRequest(w.CodeActionRequest.type,b,I,null))},g=c.clientOptions.middleware;return g.provideCodeActions?g.provideCodeActions(i,o,s,a,l):l(i,o,s,a)},resolveCodeAction:e.resolveProvider?(i,o)=>{let s=this._client,a=this._client.clientOptions.middleware,c=async(l,g)=>s.sendRequest(w.CodeActionResolveRequest.type,await s.code2ProtocolConverter.asCodeAction(l,g),g).then(v=>g.isCancellationRequested?l:s.protocol2CodeConverter.asCodeAction(v,g),v=>s.handleFailedRequest(w.CodeActionResolveRequest.type,g,v,l));return a.resolveCodeAction?a.resolveCodeAction(i,o,c):c(i,o)}:void 0};return[U.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),r]}},Lp=class extends bt{constructor(e){super(e,w.CodeLensRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"codeLens").dynamicRegistration=!0,X(X(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(w.CodeLensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);!i||this.register({id:_e.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new U.EventEmitter,i={onDidChangeCodeLenses:r.event,provideCodeLenses:(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(g),v).then(h=>v.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(h,v),h=>a.handleFailedRequest(w.CodeLensRequest.type,v,h,null)),l=a.clientOptions.middleware;return l.provideCodeLenses?l.provideCodeLenses(o,s,c):c(o,s)},resolveCodeLens:e.resolveProvider?(o,s)=>{let a=this._client,c=(g,v)=>a.sendRequest(w.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(g),v).then(h=>v.isCancellationRequested?g:a.protocol2CodeConverter.asCodeLens(h),h=>a.handleFailedRequest(w.CodeLensResolveRequest.type,v,h,g)),l=a.clientOptions.middleware;return l.resolveCodeLens?l.resolveCodeLens(o,s,c):c(o,s)}:void 0};return[U.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:r}]}},Ap=class extends bt{constructor(e){super(e,w.DocumentFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentFormattingEdits:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),options:a.code2ProtocolConverter.asFormattingOptions(v,zi.fromConfiguration(g))};return a.sendRequest(w.DocumentFormattingRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(b,h),b=>a.handleFailedRequest(w.DocumentFormattingRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideDocumentFormattingEdits?l.provideDocumentFormattingEdits(i,o,s,c):c(i,o,s)}};return[U.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Mp=class extends bt{constructor(e){super(e,w.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"rangeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentRangeFormattingEdits:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>{let k={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h),options:c.code2ProtocolConverter.asFormattingOptions(C,zi.fromConfiguration(v))};return c.sendRequest(w.DocumentRangeFormattingRequest.type,k,b).then(I=>b.isCancellationRequested?null:c.protocol2CodeConverter.asTextEdits(I,b),I=>c.handleFailedRequest(w.DocumentRangeFormattingRequest.type,b,I,null))},g=c.clientOptions.middleware;return g.provideDocumentRangeFormattingEdits?g.provideDocumentRangeFormattingEdits(i,o,s,a,l):l(i,o,s,a)}};return[U.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},jp=class extends bt{constructor(e){super(e,w.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){X(X(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideOnTypeFormattingEdits:(o,s,a,c,l)=>{let g=this._client,v=(C,b,k,I,O)=>{let M={textDocument:g.code2ProtocolConverter.asTextDocumentIdentifier(C),position:g.code2ProtocolConverter.asPosition(b),ch:k,options:g.code2ProtocolConverter.asFormattingOptions(I,zi.fromConfiguration(C))};return g.sendRequest(w.DocumentOnTypeFormattingRequest.type,M,O).then(q=>O.isCancellationRequested?null:g.protocol2CodeConverter.asTextEdits(q,O),q=>g.handleFailedRequest(w.DocumentOnTypeFormattingRequest.type,O,q,null))},h=g.clientOptions.middleware;return h.provideOnTypeFormattingEdits?h.provideOnTypeFormattingEdits(o,s,a,c,l,v):v(o,s,a,c,l)}},i=e.moreTriggerCharacter||[];return[U.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r,e.firstTriggerCharacter,...i),r]}},$p=class extends bt{constructor(e){super(e,w.RenameRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=w.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.renameProvider);!r||(Se.boolean(e.renameProvider)&&(r.prepareProvider=!1),this.register({id:_e.generateUuid(),registerOptions:r}))}registerLanguageProvider(e){let t=e.documentSelector,r={provideRenameEdits:(i,o,s,a)=>{let c=this._client,l=(v,h,C,b)=>{let k={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),position:c.code2ProtocolConverter.asPosition(h),newName:C};return c.sendRequest(w.RenameRequest.type,k,b).then(I=>b.isCancellationRequested?null:c.protocol2CodeConverter.asWorkspaceEdit(I,b),I=>c.handleFailedRequest(w.RenameRequest.type,b,I,null,!1))},g=c.clientOptions.middleware;return g.provideRenameEdits?g.provideRenameEdits(i,o,s,a,l):l(i,o,s,a)},prepareRename:e.prepareProvider?(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),position:a.code2ProtocolConverter.asPosition(v)};return a.sendRequest(w.PrepareRenameRequest.type,C,h).then(b=>h.isCancellationRequested?null:w.Range.is(b)?a.protocol2CodeConverter.asRange(b):this.isDefaultBehavior(b)?b.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):b&&w.Range.is(b.range)?{range:a.protocol2CodeConverter.asRange(b.range),placeholder:b.placeholder}:Promise.reject(new Error("The element can't be renamed.")),b=>{throw typeof b.message=="string"?new Error(b.message):new Error("The element can't be renamed.")})},l=a.clientOptions.middleware;return l.prepareRename?l.prepareRename(i,o,s,c):c(i,o,s)}:void 0};return[U.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}isDefaultBehavior(e){let t=e;return t&&Se.boolean(t.defaultBehavior)}},Hp=class extends bt{constructor(e){super(e,w.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=X(X(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let r=this.getRegistrationOptions(t,e.documentLinkProvider);!r||this.register({id:_e.generateUuid(),registerOptions:r})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDocumentLinks:(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkRequest.type,s.code2ProtocolConverter.asDocumentLinkParams(l),g).then(v=>g.isCancellationRequested?null:s.protocol2CodeConverter.asDocumentLinks(v,g),v=>s.handleFailedRequest(w.DocumentLinkRequest.type,g,v,null)),c=s.clientOptions.middleware;return c.provideDocumentLinks?c.provideDocumentLinks(i,o,a):a(i,o)},resolveDocumentLink:e.resolveProvider?(i,o)=>{let s=this._client,a=(l,g)=>s.sendRequest(w.DocumentLinkResolveRequest.type,s.code2ProtocolConverter.asDocumentLink(l),g).then(v=>g.isCancellationRequested?l:s.protocol2CodeConverter.asDocumentLink(v),v=>s.handleFailedRequest(w.DocumentLinkResolveRequest.type,g,v,l)),c=s.clientOptions.middleware;return c.resolveDocumentLink?c.resolveDocumentLink(i,o,a):a(i,o)}:void 0};return[U.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}},Wp=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return w.DidChangeConfigurationNotification.type}fillClientCapabilities(e){X(X(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){let e=this._client.clientOptions.synchronize.configurationSection;e!==void 0&&this.register({id:_e.generateUuid(),registerOptions:{section:e}})}register(e){let t=U.workspace.onDidChangeConfiguration(r=>{this.onDidChangeConfiguration(e.registerOptions.section,r)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}onDidChangeConfiguration(e,t){let r;if(Se.string(e)?r=[e]:r=e,r!==void 0&&t!==void 0&&!r.some(a=>t.affectsConfiguration(a)))return;let i=async s=>s===void 0?this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(w.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(s)}),o=this.getMiddleware();(o?o(r,i):i(r)).catch(s=>{this._client.error(`Sending notification ${w.DidChangeConfigurationNotification.type.method} failed`,s)})}extractSettingsInformation(e){function t(o,s){let a=o;for(let c=0;c<s.length-1;c++){let l=a[s[c]];l||(l=Object.create(null),a[s[c]]=l),a=l}return a}let r=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let o=0;o<e.length;o++){let s=e[o],a=s.indexOf("."),c=null;if(a>=0?c=U.workspace.getConfiguration(s.substr(0,a),r).get(s.substr(a+1)):c=U.workspace.getConfiguration(void 0,r).get(s),c){let l=e[o].split(".");t(i,l)[l[l.length-1]]=(0,HT.toJSONObject)(c)}}return i}getMiddleware(){let e=this._client.clientOptions.middleware;if(e.workspace&&e.workspace.didChangeConfiguration)return e.workspace.didChangeConfiguration}},zp=class{constructor(e){this._client=e,this._commands=new Map}get registrationType(){return w.ExecuteCommandRequest.type}fillClientCapabilities(e){X(X(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){!e.executeCommandProvider||this.register({id:_e.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,r=t.clientOptions.middleware,i=(o,s)=>{let a={command:o,arguments:s};return t.sendRequest(w.ExecuteCommandRequest.type,a).then(void 0,c=>t.handleFailedRequest(w.ExecuteCommandRequest.type,void 0,c,void 0))};if(e.registerOptions.commands){let o=[];for(let s of e.registerOptions.commands)o.push(U.commands.registerCommand(s,(...a)=>r.executeCommand?r.executeCommand(s,a,i):i(s,a)));this._commands.set(e.id,o)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(r=>r.dispose())}dispose(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}},GT;(function(n){function e(t){return t&&w.MessageReader.is(t.reader)&&w.MessageWriter.is(t.writer)}n.is=e})(GT=xe.MessageTransports||(xe.MessageTransports={}));var Ba=class{constructor(e,t){this._resolve=e,this._reject=t,this._used=!1}get isUsed(){return this._used}resolve(){this._used=!0,this._resolve()}reject(e){this._used=!0,this._reject(e)}},Ga=class extends U.CancellationError{constructor(e){super();this.data=e}};xe.LSPCancellationError=Ga;var Yr=class{constructor(e,t,r){var o;this._traceFormat=w.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new Ka.Semaphore(1),this._id=e,this._name=t,r=r||{};let i={isTrusted:!1,supportHtml:!1};r.markdown!==void 0&&(i.isTrusted=r.markdown.isTrusted===!0,i.supportHtml=r.markdown.supportHtml===!0),this._clientOptions={documentSelector:r.documentSelector??[],synchronize:r.synchronize??{},diagnosticCollectionName:r.diagnosticCollectionName,outputChannelName:r.outputChannelName??this._name,revealOutputChannelOn:r.revealOutputChannelOn??Wi.Error,stdioEncoding:r.stdioEncoding??"utf8",initializationOptions:r.initializationOptions,initializationFailedHandler:r.initializationFailedHandler,progressOnInitialization:!!r.progressOnInitialization,errorHandler:r.errorHandler??this.createDefaultErrorHandler((o=r.connectionOptions)==null?void 0:o.maxRestartCount),middleware:r.middleware??{},uriConverters:r.uriConverters,workspaceFolder:r.workspaceFolder,connectionOptions:r.connectionOptions,markdown:i,diagnosticPullOptions:r.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:r.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Ne.Initial,this._connectionPromise=void 0,this._resolvedConnection=void 0,this._initializeResult=void 0,r.outputChannel?(this._outputChannel=r.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=r.traceOutputChannel,this._listeners=void 0,this._providers=void 0,this._diagnostics=void 0,this._fileEvents=[],this._fileEventDelayer=new Ka.Delayer(250),this._onReady=new Promise((s,a)=>{this._onReadyCallbacks=new Ba(s,a)}),this._onStop=void 0,this._telemetryEmitter=new w.Emitter,this._stateChangeEmitter=new w.Emitter,this._trace=w.Trace.Off,this._tracer={log:(s,a)=>{Se.string(s)?this.logTrace(s,a):this.logObjectTrace(s)}},this._c2p=WT.createConverter(r.uriConverters?r.uriConverters.code2Protocol:void 0),this._p2c=zT.createConverter(r.uriConverters?r.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get state(){return this._state}set state(e){let t=this.getPublicState();this._state=e;let r=this.getPublicState();r!==t&&this._stateChangeEmitter.fire({oldState:t,newState:r})}getPublicState(){return this.state===Ne.Running?Lo.Running:this.state===Ne.Starting?Lo.Starting:Lo.Stopped}get initializeResult(){return this._initializeResult}sendRequest(e,...t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendRequest(e,...t)}catch(r){throw this.error(`Sending request ${Se.string(e)?e:e.method} failed.`,r),r}}onRequest(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onRequest(e,t)}catch(r){throw this.error(`Registering request handler ${Se.string(e)?e:e.method} failed.`,r),r}}sendNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);this.forceDocumentSync();try{return this._resolvedConnection.sendNotification(e,t)}catch(r){throw this.error(`Sending notification ${Se.string(e)?e:e.method} failed.`,r),r}}onNotification(e,t){if(!this.isConnectionActive())throw new Error(`Language client is not ready yet when handling ${Se.string(e)?e:e.method}`);try{return this._resolvedConnection.onNotification(e,t)}catch(r){throw this.error(`Registering notification handler ${Se.string(e)?e:e.method} failed.`,r),r}}onProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");try{if(w.WorkDoneProgress.is(e)){let i=this._clientOptions.middleware.handleWorkDoneProgress;if(i!==void 0)return this._resolvedConnection.onProgress(e,t,o=>{i(t,o,()=>r(o))})}return this._resolvedConnection.onProgress(e,t,r)}catch(i){throw this.error(`Registering progress handler for token ${t} failed.`,i),i}}sendProgress(e,t,r){if(!this.isConnectionActive())throw new Error("Language client is not ready yet when trying to send progress");return this.forceDocumentSync(),this._resolvedConnection.sendProgress(e,t,r).then(void 0,i=>{throw this.error(`Sending progress for token ${t} failed.`,i),i})}get name(){return this._name}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=U.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new mp(this,e??4)}set trace(e){this._trace=e,this.onReady().then(()=>{this.resolveConnection().then(t=>{t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})},()=>this.info("Setting trace value failed",void 0,!1))},()=>{})}data2String(e){if(e instanceof w.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?Se.string(e.stack)?e.stack:e.message:Se.string(e)?e:e.toString()}info(e,t,r=!0){this.outputChannel.appendLine(`[Info  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Wi.Info&&this.showNotificationMessage(w.MessageType.Info,e)}warn(e,t,r=!0){this.outputChannel.appendLine(`[Warn  - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),r&&this._clientOptions.revealOutputChannelOn<=Wi.Warn&&this.showNotificationMessage(w.MessageType.Warning,e)}error(e,t,r=!0){this.outputChannel.appendLine(`[Error - ${new Date().toLocaleTimeString()}] ${e}`),t!=null&&this.outputChannel.appendLine(this.data2String(t)),(r==="force"||r&&this._clientOptions.revealOutputChannelOn<=Wi.Error)&&this.showNotificationMessage(w.MessageType.Error,e)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===w.MessageType.Error?U.window.showErrorMessage:e===w.MessageType.Warning?U.window.showWarningMessage:U.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.state===Ne.Initial||this.state===Ne.Stopping||this.state===Ne.Stopped}needsStop(){return this.state===Ne.Starting||this.state===Ne.Running}onReady(){return this._onReady}isConnectionActive(){return this.state===Ne.Running&&!!this._resolvedConnection}start(){return this._onReadyCallbacks.isUsed&&(this._onReady=new Promise((e,t)=>{this._onReadyCallbacks=new Ba(e,t)})),this._listeners=[],this._providers=[],this._diagnostics||(this._diagnostics=this._clientOptions.diagnosticCollectionName?U.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):U.languages.createDiagnosticCollection()),this.state=Ne.Starting,this.resolveConnection().then(e=>(e.onLogMessage(t=>{switch(t.type){case w.MessageType.Error:this.error(t.message,void 0,!1);break;case w.MessageType.Warning:this.warn(t.message,void 0,!1);break;case w.MessageType.Info:this.info(t.message,void 0,!1);break;default:this.outputChannel.appendLine(t.message)}}),e.onShowMessage(t=>{switch(t.type){case w.MessageType.Error:U.window.showErrorMessage(t.message);break;case w.MessageType.Warning:U.window.showWarningMessage(t.message);break;case w.MessageType.Info:U.window.showInformationMessage(t.message);break;default:U.window.showInformationMessage(t.message)}}),e.onRequest(w.ShowMessageRequest.type,t=>{let r;switch(t.type){case w.MessageType.Error:r=U.window.showErrorMessage;break;case w.MessageType.Warning:r=U.window.showWarningMessage;break;case w.MessageType.Info:r=U.window.showInformationMessage;break;default:r=U.window.showInformationMessage}let i=t.actions||[];return r(t.message,...i)}),e.onTelemetry(t=>{this._telemetryEmitter.fire(t)}),e.onRequest(w.ShowDocumentRequest.type,async t=>{var o;let r=async s=>{let a=this.protocol2CodeConverter.asUri(s.uri);try{if(s.external===!0)return{success:await U.env.openExternal(a)};{let c={};return s.selection!==void 0&&(c.selection=this.protocol2CodeConverter.asRange(s.selection)),s.takeFocus===void 0||s.takeFocus===!1?c.preserveFocus=!0:s.takeFocus===!0&&(c.preserveFocus=!1),await U.window.showTextDocument(a,c),{success:!0}}}catch{return{success:!0}}},i=(o=this._clientOptions.middleware.window)==null?void 0:o.showDocument;return i!==void 0?i(t,r):r(t)}),e.listen(),this.initialize(e))).catch(e=>{this.state=Ne.StartFailed,this._onReadyCallbacks.reject(e),this.error(`${this._name} client: couldn't create connection to server`,e,"force")}),new U.Disposable(()=>{this.needsStop()&&this.stop().catch(e=>{this.error("Stopping server failed.",e,!1)})})}resolveConnection(){return this._connectionPromise||(this._connectionPromise=this.createConnection()),this._connectionPromise}initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[r,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],o={processId:null,clientInfo:{name:U.env.appName,version:U.version},locale:this.getLocale(),rootPath:r||null,rootUri:r?this._c2p.asUri(U.Uri.file(r)):null,capabilities:this.computeClientCapabilities(),initializationOptions:Se.func(t)?t():t,trace:w.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(o),this._clientOptions.progressOnInitialization){let s=_e.generateUuid(),a=new UT.ProgressPart(e,s);return o.workDoneToken=s,this.doInitialize(e,o).then(c=>(a.done(),c),c=>{throw a.cancel(),c})}else return this.doInitialize(e,o)}doInitialize(e,t){return e.initialize(t).then(r=>{this._resolvedConnection=e,this._initializeResult=r,this.state=Ne.Running;let i;return Se.number(r.capabilities.textDocumentSync)?r.capabilities.textDocumentSync===w.TextDocumentSyncKind.None?i={openClose:!1,change:w.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:r.capabilities.textDocumentSync,save:{includeText:!1}}:r.capabilities.textDocumentSync!==void 0&&r.capabilities.textDocumentSync!==null&&(i=r.capabilities.textDocumentSync),this._capabilities=Object.assign({},r.capabilities,{resolvedTextDocumentSync:i}),e.onDiagnostics(o=>this.handleDiagnostics(o)),e.onRequest(w.RegistrationRequest.type,o=>this.handleRegistrationRequest(o)),e.onRequest("client/registerFeature",o=>this.handleRegistrationRequest(o)),e.onRequest(w.UnregistrationRequest.type,o=>this.handleUnregistrationRequest(o)),e.onRequest("client/unregisterFeature",o=>this.handleUnregistrationRequest(o)),e.onRequest(w.ApplyWorkspaceEditRequest.type,o=>this.handleApplyWorkspaceEdit(o)),e.sendNotification(w.InitializedNotification.type,{}).then(()=>(this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),this._onReadyCallbacks.resolve(),r))}).then(void 0,r=>{throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(r)?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r)):r instanceof w.ResponseError&&r.data&&r.data.retry?U.window.showErrorMessage(r.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):(this.stop(),this._onReadyCallbacks.reject(r))}):(r&&r.message&&U.window.showErrorMessage(r.message),this.error("Server initialization failed.",r),this.stop(),this._onReadyCallbacks.reject(r)),r})}_clientGetRootPath(){let e=U.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}async stop(e=2e3){if(await this.onReady(),this._initializeResult=void 0,!this._connectionPromise)return this.state=Ne.Stopped,Promise.resolve();if(this.state===Ne.Stopping&&this._onStop)return this._onStop;this.state=Ne.Stopping,this.cleanUp(!1);let t=new Promise(i=>{(0,w.RAL)().timer.setTimeout(i,e)}),r=this.resolveConnection().then(i=>i.shutdown().then(()=>i.exit().then(()=>i)));return this._onStop=Promise.race([t,r]).then(i=>{if(i!==void 0)i.end(),i.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},i=>{throw this.error("Stopping server failed",i,!1),i}).finally(()=>{this.state=Ne.Stopped,this.cleanUpChannel(),this._onStop=void 0,this._connectionPromise=void 0,this._resolvedConnection=void 0})}cleanUp(e=!0,t=!0){this._fileEvents=[],this._fileEventDelayer.cancel(),this._listeners&&(this._listeners.forEach(r=>r.dispose()),this._listeners=void 0),this._providers&&(this._providers.forEach(r=>r.dispose()),this._providers=void 0),this._syncedDocuments&&this._syncedDocuments.clear();for(let r of Array.from(this._features.entries()).map(i=>i[1]).reverse())r.dispose();e&&this.cleanUpChannel(),t&&this._diagnostics&&(this._diagnostics.dispose(),this._diagnostics=void 0)}cleanUpChannel(){this._outputChannel&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){var o;let t=this;async function r(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.onReady();let a=await t.resolveConnection(),c=Promise.resolve();return t.isConnectionActive()&&(t.forceDocumentSync(),c=a.didChangeWatchedFiles({changes:t._fileEvents})),t._fileEvents=[],c})}let i=(o=this.clientOptions.middleware)==null?void 0:o.workspace;(i!=null&&i.didChangeWatchedFile?i.didChangeWatchedFile(e,r):r(e)).catch(s=>{t.error("Notify file events failed.",s)})}forceDocumentSync(){this._didChangeTextDocumentFeature===void 0&&(this._didChangeTextDocumentFeature=this._dynamicFeatures.get(w.DidChangeTextDocumentNotification.type.method)),this._didChangeTextDocumentFeature.forceDelivery()}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,w.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,r]=e.value;this._diagnosticQueue.delete(t);let i=new U.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(r,i.token).then(o=>{if(!i.token.isCancellationRequested){let s=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(s,o,(c,l)=>this.setDiagnostics(c,l)):this.setDiagnostics(s,o)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){!this._diagnostics||this._diagnostics.set(e,t)}createConnection(){let e=(r,i,o)=>{this.handleConnectionError(r,i,o)},t=()=>{this.handleConnectionClosed()};return this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8").then(r=>KT(r.reader,r.writer,e,t,this._clientOptions.connectionOptions))}handleConnectionClosed(){if(this.state===Ne.Stopped)return;try{this._resolvedConnection&&this._resolvedConnection.dispose()}catch{}let e={action:_r.DoNotRestart};if(this.state!==Ne.Stopping)try{e=this._clientOptions.errorHandler.closed()}catch{}this._connectionPromise=void 0,this._resolvedConnection=void 0,e.action===_r.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,"force"),this.state===Ne.Starting?(this._onReadyCallbacks.reject(new Error("Connection to server got closed. Server will not be restarted.")),this.state=Ne.StartFailed):this.state=Ne.Stopped,this.cleanUp(!1,!0)):e.action===_r.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart."),this.cleanUp(!1,!1),this.state=Ne.Initial,this.start())}handleConnectionError(e,t,r){let i=this._clientOptions.errorHandler.error(e,t,r);i.action===Ao.Shutdown&&(this.error(i.message??`Client ${this._name}: connection to server is erroring. Shutting down server.`,void 0,"force"),this.stop().catch(o=>{this.error("Stopping server failed",o,!1)}))}hookConfigurationChanged(e){U.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)})}refreshTrace(e,t=!1){let r=U.workspace.getConfiguration(this._id),i=w.Trace.Off,o=w.TraceFormat.Text;if(r){let s=r.get("trace.server","off");typeof s=="string"?i=w.Trace.fromString(s):(i=w.Trace.fromString(r.get("trace.server.verbosity","off")),o=w.TraceFormat.fromString(r.get("trace.server.format","text")))}this._trace=i,this._traceFormat=o,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let r;Se.array(t)?r=t:r=[t],r&&this._dynamicFeatures.get(w.DidChangeWatchedFilesNotification.type.method).registerRaw(_e.generateUuid(),r)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),Va.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}registerBuiltinFeatures(){this.registerFeature(new Wp(this)),this.registerFeature(new Cp(this,this._syncedDocuments)),this.registerFeature(new Rp(this)),this.registerFeature(new bp(this)),this.registerFeature(new Tp(this)),this.registerFeature(new Dp(this)),this.registerFeature(new wp(this,this._syncedDocuments)),this.registerFeature(new Sp(this,e=>this.notifyFileEvent(e))),this.registerFeature(new Pp(this)),this.registerFeature(new Ep(this)),this.registerFeature(new xp(this)),this.registerFeature(new kp(this)),this.registerFeature(new qp(this)),this.registerFeature(new Op(this)),this.registerFeature(new Ip(this)),this.registerFeature(new Np(this)),this.registerFeature(new Fp(this)),this.registerFeature(new Lp(this)),this.registerFeature(new Ap(this)),this.registerFeature(new Mp(this)),this.registerFeature(new jp(this)),this.registerFeature(new $p(this)),this.registerFeature(new Hp(this)),this.registerFeature(new zp(this))}fillInitializeParams(e){for(let t of this._features)Se.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};X(e,"workspace").applyEdit=!0;let t=X(X(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[w.ResourceOperationKind.Create,w.ResourceOperationKind.Rename,w.ResourceOperationKind.Delete],t.failureHandling=w.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let r=X(X(e,"textDocument"),"publishDiagnostics");r.relatedInformation=!0,r.versionSupport=!1,r.tagSupport={valueSet:[w.DiagnosticTag.Unnecessary,w.DiagnosticTag.Deprecated]},r.codeDescriptionSupport=!0,r.dataSupport=!0;let i=X(e,"window"),o=X(i,"showMessage");o.messageActionItem={additionalPropertiesSupport:!0};let s=X(i,"showDocument");s.support=!0;let a=X(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(Yr.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let c of this._features)c.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let r of this._features)r.initialize(this._capabilities,t)}handleRegistrationRequest(e){return new Promise((t,r)=>{for(let i of e.registrations){let o=this._dynamicFeatures.get(i.method);if(o===void 0){r(new Error(`No feature implementation for ${i.method} found. Registration failed.`));return}let s=i.registerOptions??{};s.documentSelector=s.documentSelector??this._clientOptions.documentSelector;let a={id:i.id,registerOptions:s};try{o.register(a)}catch(c){r(c);return}}t()})}handleUnregistrationRequest(e){return new Promise((t,r)=>{for(let i of e.unregisterations){let o=this._dynamicFeatures.get(i.method);if(!o){r(new Error(`No feature implementation for ${i.method} found. Unregistration failed.`));return}o.unregister(i.id)}t()})}async handleApplyWorkspaceEdit(e){let t=e.edit,r=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;U.workspace.textDocuments.forEach(s=>i.set(s.uri.toString(),s));let o=!1;if(t.documentChanges){for(let s of t.documentChanges)if(w.TextDocumentEdit.is(s)&&s.textDocument.version&&s.textDocument.version>=0){let a=i.get(s.textDocument.uri);if(a&&a.version!==s.textDocument.version){o=!0;break}}}return o?Promise.resolve({applied:!1}):Se.asPromise(U.workspace.applyEdit(r).then(s=>({applied:s})))}handleFailedRequest(e,t,r,i,o=!0){if(r instanceof w.ResponseError){if(r.code===w.LSPErrorCodes.RequestCancelled||r.code===w.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw r.data!==void 0?new Ga(r.data):new U.CancellationError}else if(r.code===w.LSPErrorCodes.ContentModified){if(Yr.RequestsToCancelOnContentModified.has(e.method))throw new U.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,r,o),r}};xe.BaseLanguageClient=Yr;Yr.RequestsToCancelOnContentModified=new Set([w.SemanticTokensRequest.method,w.SemanticTokensRangeRequest.method,w.SemanticTokensDeltaRequest.method])});var Vp=x(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.ColorProviderFeature=void 0;var XT=require("vscode"),Ui=De(),QT=pt();function Up(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Kp=class extends QT.TextDocumentFeature{constructor(e){super(e,Ui.DocumentColorRequest.type)}fillClientCapabilities(e){Up(Up(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.colorProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideColorPresentations:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={color:g,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(v.document),range:a.code2ProtocolConverter.asRange(v.range)};return a.sendRequest(Ui.ColorPresentationRequest.type,C,h).then(b=>h.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(b,h),b=>a.handleFailedRequest(Ui.ColorPresentationRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideColorPresentations?l.provideColorPresentations(i,o,s,c):c(i,o,s)},provideDocumentColors:(i,o)=>{let s=this._client,a=(l,g)=>{let v={textDocument:s.code2ProtocolConverter.asTextDocumentIdentifier(l)};return s.sendRequest(Ui.DocumentColorRequest.type,v,g).then(h=>g.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(h,g),h=>s.handleFailedRequest(Ui.ColorPresentationRequest.type,g,h,null))},c=s.clientOptions.middleware;return c.provideDocumentColors?c.provideDocumentColors(i,o,a):a(i,o)}};return[XT.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Mo.ColorProviderFeature=Kp});var Xp=x(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.ImplementationFeature=void 0;var JT=require("vscode"),Xa=De(),YT=pt();function Bp(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Gp=class extends YT.TextDocumentFeature{constructor(e){super(e,Xa.ImplementationRequest.type)}fillClientCapabilities(e){let t=Bp(Bp(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.implementationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideImplementation:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(Xa.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(Xa.ImplementationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideImplementation?l.provideImplementation(i,o,s,c):c(i,o,s)}};return[JT.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};jo.ImplementationFeature=Gp});var Jp=x(Ho=>{"use strict";Object.defineProperty(Ho,"__esModule",{value:!0});Ho.TypeDefinitionFeature=void 0;var ZT=require("vscode"),Qa=De(),eD=pt();function $o(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Qp=class extends eD.TextDocumentFeature{constructor(e){super(e,Qa.TypeDefinitionRequest.type)}fillClientCapabilities(e){$o($o(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=$o($o(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeDefinitionProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideTypeDefinition:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(Qa.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(C,h),C=>a.handleFailedRequest(Qa.TypeDefinitionRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideTypeDefinition?l.provideTypeDefinition(i,o,s,c):c(i,o,s)}};return[ZT.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ho.TypeDefinitionFeature=Qp});var Zp=x(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.WorkspaceFoldersFeature=Zr.arrayDiff=void 0;var tD=Jr(),Wo=require("vscode"),Ki=De();function Ja(n,e){if(n!==void 0)return n[e]}function Ya(n,e){return n.filter(t=>e.indexOf(t)<0)}Zr.arrayDiff=Ya;var Yp=class{constructor(e){this._client=e,this._listeners=new Map}get registrationType(){return Ki.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Wo.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(r=>this.asProtocol(r))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Ki.WorkspaceFoldersRequest.type,o=>{let s=()=>{let c=Wo.workspace.workspaceFolders;return c===void 0?null:c.map(g=>this.asProtocol(g))},a=t.clientOptions.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(o,s):s(o)});let r=Ja(Ja(Ja(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof r=="string"?i=r:r===!0&&(i=tD.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let r=Ya(this._initialFolders,e),i=Ya(e,this._initialFolders);(i.length>0||r.length>0)&&(t=this.doSendEvent(i,r))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(r=>{this._client.error(`Sending notification ${Ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,r)})}doSendEvent(e,t){let r={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Ki.DidChangeWorkspaceFoldersNotification.type,r)}register(e){let t=e.id,r=this._client,i=Wo.workspace.onDidChangeWorkspaceFolders(o=>{let s=l=>this.doSendEvent(l.added,l.removed),a=r.clientOptions.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(o,s):s(o)).catch(l=>{this._client.error(`Sending notification ${Ki.DidChangeWorkspaceFoldersNotification.type.method} failed`,l)})});this._listeners.set(t,i),this.sendInitialEvent(Wo.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}dispose(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};Zr.WorkspaceFoldersFeature=Yp});var nh=x(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.FoldingRangeFeature=void 0;var nD=require("vscode"),Za=De(),rD=pt();function eh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var th=class extends rD.TextDocumentFeature{constructor(e){super(e,Za.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=eh(eh(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.foldingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideFoldingRanges:(i,o,s)=>{let a=this._client,c=(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g)};return a.sendRequest(Za.FoldingRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asFoldingRanges(b,h),b=>a.handleFailedRequest(Za.FoldingRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideFoldingRanges?l.provideFoldingRanges(i,o,s,c):c(i,o,s)}};return[nD.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};zo.FoldingRangeFeature=th});var oh=x(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.DeclarationFeature=void 0;var iD=require("vscode"),ec=De(),oD=pt();function rh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ih=class extends oD.TextDocumentFeature{constructor(e){super(e,ec.DeclarationRequest.type)}fillClientCapabilities(e){let t=rh(rh(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.declarationProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideDeclaration:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(ec.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(C,h),C=>a.handleFailedRequest(ec.DeclarationRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideDeclaration?l.provideDeclaration(i,o,s,c):c(i,o,s)}};return[iD.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Uo.DeclarationFeature=ih});var ch=x(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.SelectionRangeFeature=void 0;var sD=require("vscode"),tc=De(),aD=pt();function sh(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var ah=class extends aD.TextDocumentFeature{constructor(e){super(e,tc.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=sh(sh(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.selectionRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideSelectionRanges:(i,o,s)=>{let a=this._client,c=async(g,v,h)=>{let C={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(g),positions:await a.code2ProtocolConverter.asPositions(v,h)};return a.sendRequest(tc.SelectionRangeRequest.type,C,h).then(b=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(b,h),b=>a.handleFailedRequest(tc.SelectionRangeRequest.type,h,b,null))},l=a.clientOptions.middleware;return l.provideSelectionRanges?l.provideSelectionRanges(i,o,s,c):c(i,o,s)}};return[sD.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};Ko.SelectionRangeFeature=ah});var lh=x(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.ProgressFeature=void 0;var cD=De(),uD=Ua();function lD(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var uh=class{constructor(e){this._client=e,this.activeParts=new Set}fillClientCapabilities(e){lD(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},r=i=>{this.activeParts.add(new uD.ProgressPart(this._client,i.token,t))};e.onRequest(cD.WorkDoneProgressCreateRequest.type,r)}dispose(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Vo.ProgressFeature=uh});var hh=x(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.CallHierarchyFeature=void 0;var dD=require("vscode"),Pr=De(),fD=pt();function dh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var fh=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareCallHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Pr.CallHierarchyPrepareRequest.type,g,l).then(v=>l.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(v,l),v=>i.handleFailedRequest(Pr.CallHierarchyPrepareRequest.type,l,v,null))};return o.prepareCallHierarchy?o.prepareCallHierarchy(e,t,r,s):s(e,t,r)}provideCallHierarchyIncomingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Pr.CallHierarchyIncomingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyIncomingCalls(l,a),l=>r.handleFailedRequest(Pr.CallHierarchyIncomingCallsRequest.type,a,l,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,o):o(e,t)}provideCallHierarchyOutgoingCalls(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asCallHierarchyItem(s)};return r.sendRequest(Pr.CallHierarchyOutgoingCallsRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asCallHierarchyOutgoingCalls(l,a),l=>r.handleFailedRequest(Pr.CallHierarchyOutgoingCallsRequest.type,a,l,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,o):o(e,t)}},ph=class extends fD.TextDocumentFeature{constructor(e){super(e,Pr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let r=dh(dh(e,"textDocument"),"callHierarchy");r.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.callHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new fh(t);return[dD.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};Bo.CallHierarchyFeature=ph});var mh=x(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.SemanticTokensFeature=void 0;var Go=require("vscode"),oe=De(),pD=pt(),hD=Rn();function Xo(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var gh=class extends pD.TextDocumentFeature{constructor(e){super(e,oe.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=Xo(Xo(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[oe.SemanticTokenTypes.namespace,oe.SemanticTokenTypes.type,oe.SemanticTokenTypes.class,oe.SemanticTokenTypes.enum,oe.SemanticTokenTypes.interface,oe.SemanticTokenTypes.struct,oe.SemanticTokenTypes.typeParameter,oe.SemanticTokenTypes.parameter,oe.SemanticTokenTypes.variable,oe.SemanticTokenTypes.property,oe.SemanticTokenTypes.enumMember,oe.SemanticTokenTypes.event,oe.SemanticTokenTypes.function,oe.SemanticTokenTypes.method,oe.SemanticTokenTypes.macro,oe.SemanticTokenTypes.keyword,oe.SemanticTokenTypes.modifier,oe.SemanticTokenTypes.comment,oe.SemanticTokenTypes.string,oe.SemanticTokenTypes.number,oe.SemanticTokenTypes.regexp,oe.SemanticTokenTypes.operator,oe.SemanticTokenTypes.decorator],t.tokenModifiers=[oe.SemanticTokenModifiers.declaration,oe.SemanticTokenModifiers.definition,oe.SemanticTokenModifiers.readonly,oe.SemanticTokenModifiers.static,oe.SemanticTokenModifiers.deprecated,oe.SemanticTokenModifiers.abstract,oe.SemanticTokenModifiers.async,oe.SemanticTokenModifiers.modification,oe.SemanticTokenModifiers.documentation,oe.SemanticTokenModifiers.defaultLibrary],t.formats=[oe.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,Xo(Xo(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(oe.SemanticTokensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeSemanticTokensEmitter.fire()});let[i,o]=this.getRegistration(t,e.semanticTokensProvider);!i||!o||this.register({id:i,registerOptions:o})}registerLanguageProvider(e){let t=e.documentSelector,r=hD.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,o=new Go.EventEmitter,s=r?{onDidChangeSemanticTokens:o.event,provideDocumentSemanticTokens:(C,b)=>{let k=this._client,I=k.clientOptions.middleware,O=(M,q)=>{let $={textDocument:k.code2ProtocolConverter.asTextDocumentIdentifier(M)};return k.sendRequest(oe.SemanticTokensRequest.type,$,q).then(K=>q.isCancellationRequested?null:k.protocol2CodeConverter.asSemanticTokens(K,q),K=>k.handleFailedRequest(oe.SemanticTokensRequest.type,q,K,null))};return I.provideDocumentSemanticTokens?I.provideDocumentSemanticTokens(C,b,O):O(C,b)},provideDocumentSemanticTokensEdits:i?(C,b,k)=>{let I=this._client,O=I.clientOptions.middleware,M=(q,$,K)=>{let fe={textDocument:I.code2ProtocolConverter.asTextDocumentIdentifier(q),previousResultId:$};return I.sendRequest(oe.SemanticTokensDeltaRequest.type,fe,K).then(async Y=>K.isCancellationRequested?null:oe.SemanticTokens.is(Y)?await I.protocol2CodeConverter.asSemanticTokens(Y,K):await I.protocol2CodeConverter.asSemanticTokensEdits(Y,K),Y=>I.handleFailedRequest(oe.SemanticTokensDeltaRequest.type,K,Y,null))};return O.provideDocumentSemanticTokensEdits?O.provideDocumentSemanticTokensEdits(C,b,k,M):M(C,b,k)}:void 0}:void 0,c=e.range===!0?{provideDocumentRangeSemanticTokens:(C,b,k)=>{let I=this._client,O=I.clientOptions.middleware,M=(q,$,K)=>{let fe={textDocument:I.code2ProtocolConverter.asTextDocumentIdentifier(q),range:I.code2ProtocolConverter.asRange($)};return I.sendRequest(oe.SemanticTokensRangeRequest.type,fe,K).then(Y=>K.isCancellationRequested?null:I.protocol2CodeConverter.asSemanticTokens(Y,K),Y=>I.handleFailedRequest(oe.SemanticTokensRangeRequest.type,K,Y,null))};return O.provideDocumentRangeSemanticTokens?O.provideDocumentRangeSemanticTokens(C,b,k,M):M(C,b,k)}}:void 0,l=[],g=this._client,v=g.protocol2CodeConverter.asSemanticTokensLegend(e.legend),h=g.protocol2CodeConverter.asDocumentSelector(t);return s!==void 0&&l.push(Go.languages.registerDocumentSemanticTokensProvider(h,s,v)),c!==void 0&&l.push(Go.languages.registerDocumentRangeSemanticTokensProvider(h,c,v)),[new Go.Disposable(()=>l.forEach(C=>C.dispose())),{range:c,full:s,onDidChangeSemanticTokensEmitter:o}]}};Qo.SemanticTokensFeature=gh});var yh=x((JP,vh)=>{vh.exports=function(n,e){for(var t=[],r=0;r<n.length;r++){var i=e(n[r],r);gD(i)?t.push.apply(t,i):t.push(i)}return t};var gD=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"}});var Th=x((YP,bh)=>{"use strict";bh.exports=wh;function wh(n,e,t){n instanceof RegExp&&(n=Ch(n,t)),e instanceof RegExp&&(e=Ch(e,t));var r=Rh(n,e,t);return r&&{start:r[0],end:r[1],pre:t.slice(0,r[0]),body:t.slice(r[0]+n.length,r[1]),post:t.slice(r[1]+e.length)}}function Ch(n,e){var t=e.match(n);return t?t[0]:null}wh.range=Rh;function Rh(n,e,t){var r,i,o,s,a,c=t.indexOf(n),l=t.indexOf(e,c+1),g=c;if(c>=0&&l>0){if(n===e)return[c,l];for(r=[],o=t.length;g>=0&&!a;)g==c?(r.push(g),c=t.indexOf(n,g+1)):r.length==1?a=[r.pop(),l]:(i=r.pop(),i<o&&(o=i,s=l),l=t.indexOf(e,g+1)),g=c<l&&c>=0?c:l;r.length&&(a=[o,s])}return a}});var qh=x((ZP,kh)=>{var mD=yh(),Dh=Th();kh.exports=CD;var Sh="\0SLASH"+Math.random()+"\0",_h="\0OPEN"+Math.random()+"\0",rc="\0CLOSE"+Math.random()+"\0",Ph="\0COMMA"+Math.random()+"\0",Eh="\0PERIOD"+Math.random()+"\0";function nc(n){return parseInt(n,10)==n?parseInt(n,10):n.charCodeAt(0)}function vD(n){return n.split("\\\\").join(Sh).split("\\{").join(_h).split("\\}").join(rc).split("\\,").join(Ph).split("\\.").join(Eh)}function yD(n){return n.split(Sh).join("\\").split(_h).join("{").split(rc).join("}").split(Ph).join(",").split(Eh).join(".")}function xh(n){if(!n)return[""];var e=[],t=Dh("{","}",n);if(!t)return n.split(",");var r=t.pre,i=t.body,o=t.post,s=r.split(",");s[s.length-1]+="{"+i+"}";var a=xh(o);return o.length&&(s[s.length-1]+=a.shift(),s.push.apply(s,a)),e.push.apply(e,s),e}function CD(n){return n?(n.substr(0,2)==="{}"&&(n="\\{\\}"+n.substr(2)),ei(vD(n),!0).map(yD)):[]}function wD(n){return"{"+n+"}"}function RD(n){return/^-?0\d/.test(n)}function bD(n,e){return n<=e}function TD(n,e){return n>=e}function ei(n,e){var t=[],r=Dh("{","}",n);if(!r||/\$$/.test(r.pre))return[n];var i=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(r.body),o=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(r.body),s=i||o,a=r.body.indexOf(",")>=0;if(!s&&!a)return r.post.match(/,.*\}/)?(n=r.pre+"{"+r.body+rc+r.post,ei(n)):[n];var c;if(s)c=r.body.split(/\.\./);else if(c=xh(r.body),c.length===1&&(c=ei(c[0],!1).map(wD),c.length===1)){var g=r.post.length?ei(r.post,!1):[""];return g.map(function(Dt){return r.pre+c[0]+Dt})}var l=r.pre,g=r.post.length?ei(r.post,!1):[""],v;if(s){var h=nc(c[0]),C=nc(c[1]),b=Math.max(c[0].length,c[1].length),k=c.length==3?Math.abs(nc(c[2])):1,I=bD,O=C<h;O&&(k*=-1,I=TD);var M=c.some(RD);v=[];for(var q=h;I(q,C);q+=k){var $;if(o)$=String.fromCharCode(q),$==="\\"&&($="");else if($=String(q),M){var K=b-$.length;if(K>0){var fe=new Array(K+1).join("0");q<0?$="-"+fe+$.slice(1):$=fe+$}}v.push($)}}else v=mD(c,function(rt){return ei(rt,!1)});for(var Y=0;Y<v.length;Y++)for(var He=0;He<g.length;He++){var Ge=l+v[Y]+g[He];(!e||s||Ge)&&t.push(Ge)}return t}});var ac=x((eE,Lh)=>{Lh.exports=Ut;Ut.Minimatch=ht;var Vi=function(){try{return require("path")}catch{}}()||{sep:"/"};Ut.sep=Vi.sep;var sc=Ut.GLOBSTAR=ht.GLOBSTAR={},DD=qh(),Oh={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},ic="[^/]",oc=ic+"*?",SD="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",_D="(?:(?!(?:\\/|^)\\.).)*?",Ih=PD("().*{}+?[]^$\\!");function PD(n){return n.split("").reduce(function(e,t){return e[t]=!0,e},{})}var Nh=/\/+/;Ut.filter=ED;function ED(n,e){return e=e||{},function(t,r,i){return Ut(t,n,e)}}function ir(n,e){e=e||{};var t={};return Object.keys(n).forEach(function(r){t[r]=n[r]}),Object.keys(e).forEach(function(r){t[r]=e[r]}),t}Ut.defaults=function(n){if(!n||typeof n!="object"||!Object.keys(n).length)return Ut;var e=Ut,t=function(i,o,s){return e(i,o,ir(n,s))};return t.Minimatch=function(i,o){return new e.Minimatch(i,ir(n,o))},t.Minimatch.defaults=function(i){return e.defaults(ir(n,i)).Minimatch},t.filter=function(i,o){return e.filter(i,ir(n,o))},t.defaults=function(i){return e.defaults(ir(n,i))},t.makeRe=function(i,o){return e.makeRe(i,ir(n,o))},t.braceExpand=function(i,o){return e.braceExpand(i,ir(n,o))},t.match=function(r,i,o){return e.match(r,i,ir(n,o))},t};ht.defaults=function(n){return Ut.defaults(n).Minimatch};function Ut(n,e,t){return Yo(e),t||(t={}),!t.nocomment&&e.charAt(0)==="#"?!1:new ht(e,t).match(n)}function ht(n,e){if(!(this instanceof ht))return new ht(n,e);Yo(n),e||(e={}),n=n.trim(),!e.allowWindowsEscape&&Vi.sep!=="/"&&(n=n.split(Vi.sep).join("/")),this.options=e,this.set=[],this.pattern=n,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!e.partial,this.make()}ht.prototype.debug=function(){};ht.prototype.make=xD;function xD(){var n=this.pattern,e=this.options;if(!e.nocomment&&n.charAt(0)==="#"){this.comment=!0;return}if(!n){this.empty=!0;return}this.parseNegate();var t=this.globSet=this.braceExpand();e.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,t),t=this.globParts=t.map(function(r){return r.split(Nh)}),this.debug(this.pattern,t),t=t.map(function(r,i,o){return r.map(this.parse,this)},this),this.debug(this.pattern,t),t=t.filter(function(r){return r.indexOf(!1)===-1}),this.debug(this.pattern,t),this.set=t}ht.prototype.parseNegate=kD;function kD(){var n=this.pattern,e=!1,t=this.options,r=0;if(!t.nonegate){for(var i=0,o=n.length;i<o&&n.charAt(i)==="!";i++)e=!e,r++;r&&(this.pattern=n.substr(r)),this.negate=e}}Ut.braceExpand=function(n,e){return Fh(n,e)};ht.prototype.braceExpand=Fh;function Fh(n,e){return e||(this instanceof ht?e=this.options:e={}),n=typeof n>"u"?this.pattern:n,Yo(n),e.nobrace||!/\{(?:(?!\{).)*\}/.test(n)?[n]:DD(n)}var qD=1024*64,Yo=function(n){if(typeof n!="string")throw new TypeError("invalid pattern");if(n.length>qD)throw new TypeError("pattern is too long")};ht.prototype.parse=OD;var Jo={};function OD(n,e){Yo(n);var t=this.options;if(n==="**")if(t.noglobstar)n="*";else return sc;if(n==="")return"";var r="",i=!!t.nocase,o=!1,s=[],a=[],c,l=!1,g=-1,v=-1,h=n.charAt(0)==="."?"":t.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",C=this;function b(){if(c){switch(c){case"*":r+=oc,i=!0;break;case"?":r+=ic,i=!0;break;default:r+="\\"+c;break}C.debug("clearStateChar %j %j",c,r),c=!1}}for(var k=0,I=n.length,O;k<I&&(O=n.charAt(k));k++){if(this.debug("%s	%s %s %j",n,k,r,O),o&&Ih[O]){r+="\\"+O,o=!1;continue}switch(O){case"/":return!1;case"\\":b(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",n,k,r,O),l){this.debug("  in class"),O==="!"&&k===v+1&&(O="^"),r+=O;continue}C.debug("call clearStateChar %j",c),b(),c=O,t.noext&&b();continue;case"(":if(l){r+="(";continue}if(!c){r+="\\(";continue}s.push({type:c,start:k-1,reStart:r.length,open:Oh[c].open,close:Oh[c].close}),r+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,r),c=!1;continue;case")":if(l||!s.length){r+="\\)";continue}b(),i=!0;var M=s.pop();r+=M.close,M.type==="!"&&a.push(M),M.reEnd=r.length;continue;case"|":if(l||!s.length||o){r+="\\|",o=!1;continue}b(),r+="|";continue;case"[":if(b(),l){r+="\\"+O;continue}l=!0,v=k,g=r.length,r+=O;continue;case"]":if(k===v+1||!l){r+="\\"+O,o=!1;continue}var q=n.substring(v+1,k);try{RegExp("["+q+"]")}catch{var $=this.parse(q,Jo);r=r.substr(0,g)+"\\["+$[0]+"\\]",i=i||$[1],l=!1;continue}i=!0,l=!1,r+=O;continue;default:b(),o?o=!1:Ih[O]&&!(O==="^"&&l)&&(r+="\\"),r+=O}}for(l&&(q=n.substr(v+1),$=this.parse(q,Jo),r=r.substr(0,g)+"\\["+$[0],i=i||$[1]),M=s.pop();M;M=s.pop()){var K=r.slice(M.reStart+M.open.length);this.debug("setting tail",r,M),K=K.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(ct,Nt,Xe){return Xe||(Xe="\\"),Nt+Nt+Xe+"|"}),this.debug(`tail=%j
   %s`,K,K,M,r);var fe=M.type==="*"?oc:M.type==="?"?ic:"\\"+M.type;i=!0,r=r.slice(0,M.reStart)+fe+"\\("+K}b(),o&&(r+="\\\\");var Y=!1;switch(r.charAt(0)){case"[":case".":case"(":Y=!0}for(var He=a.length-1;He>-1;He--){var Ge=a[He],rt=r.slice(0,Ge.reStart),Dt=r.slice(Ge.reStart,Ge.reEnd-8),gt=r.slice(Ge.reEnd-8,Ge.reEnd),mt=r.slice(Ge.reEnd);gt+=mt;var St=rt.split("(").length-1,at=mt;for(k=0;k<St;k++)at=at.replace(/\)[+*?]?/,"");mt=at;var vt="";mt===""&&e!==Jo&&(vt="$");var xn=rt+Dt+mt+vt+gt;r=xn}if(r!==""&&i&&(r="(?=.)"+r),Y&&(r=h+r),e===Jo)return[r,i];if(!i)return ND(n);var Le=t.nocase?"i":"";try{var tt=new RegExp("^"+r+"$",Le)}catch{return new RegExp("$.")}return tt._glob=n,tt._src=r,tt}Ut.makeRe=function(n,e){return new ht(n,e||{}).makeRe()};ht.prototype.makeRe=ID;function ID(){if(this.regexp||this.regexp===!1)return this.regexp;var n=this.set;if(!n.length)return this.regexp=!1,this.regexp;var e=this.options,t=e.noglobstar?oc:e.dot?SD:_D,r=e.nocase?"i":"",i=n.map(function(o){return o.map(function(s){return s===sc?t:typeof s=="string"?FD(s):s._src}).join("\\/")}).join("|");i="^(?:"+i+")$",this.negate&&(i="^(?!"+i+").*$");try{this.regexp=new RegExp(i,r)}catch{this.regexp=!1}return this.regexp}Ut.match=function(n,e,t){t=t||{};var r=new ht(e,t);return n=n.filter(function(i){return r.match(i)}),r.options.nonull&&!n.length&&n.push(e),n};ht.prototype.match=function(e,t){if(typeof t>"u"&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;var r=this.options;Vi.sep!=="/"&&(e=e.split(Vi.sep).join("/")),e=e.split(Nh),this.debug(this.pattern,"split",e);var i=this.set;this.debug(this.pattern,"set",i);var o,s;for(s=e.length-1;s>=0&&(o=e[s],!o);s--);for(s=0;s<i.length;s++){var a=i[s],c=e;r.matchBase&&a.length===1&&(c=[o]);var l=this.matchOne(c,a,t);if(l)return r.flipNegate?!0:!this.negate}return r.flipNegate?!1:this.negate};ht.prototype.matchOne=function(n,e,t){var r=this.options;this.debug("matchOne",{this:this,file:n,pattern:e}),this.debug("matchOne",n.length,e.length);for(var i=0,o=0,s=n.length,a=e.length;i<s&&o<a;i++,o++){this.debug("matchOne loop");var c=e[o],l=n[i];if(this.debug(e,c,l),c===!1)return!1;if(c===sc){this.debug("GLOBSTAR",[e,c,l]);var g=i,v=o+1;if(v===a){for(this.debug("** at the end");i<s;i++)if(n[i]==="."||n[i]===".."||!r.dot&&n[i].charAt(0)===".")return!1;return!0}for(;g<s;){var h=n[g];if(this.debug(`
globstar while`,n,g,e,v,h),this.matchOne(n.slice(g),e.slice(v),t))return this.debug("globstar found match!",g,s,h),!0;if(h==="."||h===".."||!r.dot&&h.charAt(0)==="."){this.debug("dot detected!",n,g,e,v);break}this.debug("globstar swallow a segment, and continue"),g++}return!!(t&&(this.debug(`
>>> no match, partial?`,n,g,e,v),g===s))}var C;if(typeof c=="string"?(C=l===c,this.debug("string match",c,l,C)):(C=l.match(c),this.debug("pattern match",c,l,C)),!C)return!1}if(i===s&&o===a)return!0;if(i===s)return t;if(o===a)return i===s-1&&n[i]==="";throw new Error("wtf?")};function ND(n){return n.replace(/\\(.)/g,"$1")}function FD(n){return n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}});var Kh=x(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.WillDeleteFilesFeature=Lt.WillRenameFilesFeature=Lt.WillCreateFilesFeature=Lt.DidDeleteFilesFeature=Lt.DidRenameFilesFeature=Lt.DidCreateFilesFeature=void 0;var nn=require("vscode"),LD=ac(),Hn=De(),AD=Jr();function Ah(n,e){return n[e]===void 0&&(n[e]={}),n[e]}function MD(n,e){return n[e]}function Mh(n,e,t){n[e]=t}var or=class{constructor(e,t,r,i,o){this._filters=new Map,this._client=e,this._event=t,this._registrationType=r,this._clientCapability=i,this._serverCapability=o}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Ah(Ah(e,"workspace"),"fileOperations");Mh(t,"dynamicRegistration",!0),Mh(t,this._clientCapability,!0)}initialize(e){var i;let t=(i=e.workspace)==null?void 0:i.fileOperations,r=t!==void 0?MD(t,this._serverCapability):void 0;if((r==null?void 0:r.filters)!==void 0)try{this.register({id:AD.generateUuid(),registerOptions:{filters:r.filters}})}catch(o){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${o}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(r=>{let i=new LD.Minimatch(r.pattern.glob,or.asMinimatchOptions(r.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${r.pattern.glob}!`);return{scheme:r.scheme,matcher:i,kind:r.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}dispose(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return or.getFileType(e)}async filter(e,t){let r=await Promise.all(e.files.map(async o=>{let s=t(o),a=s.fsPath.replace(/\\/g,"/");for(let c of this._filters.values())for(let l of c)if(!(l.scheme!==void 0&&l.scheme!==s.scheme)){if(l.matcher.match(a)){if(l.kind===void 0)return!0;let g=await this.getFileType(s);if(g===void 0)return this._client.error(`Failed to determine file type for ${s.toString()}.`),!0;if(g===nn.FileType.File&&l.kind===Hn.FileOperationPatternKind.file||g===nn.FileType.Directory&&l.kind===Hn.FileOperationPatternKind.folder)return!0}else if(l.kind===Hn.FileOperationPatternKind.folder&&await or.getFileType(s)===nn.FileType.Directory&&l.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((o,s)=>r[s]);return io(Fr({},e),{files:i})}static async getFileType(e){try{return(await nn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){if(e!==void 0&&e.ignoreCase===!0)return{nocase:!0}}},cc=class extends or{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o);this._notificationType=r,this._accessUri=s,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,r)}}},uc=class extends cc{constructor(){super(...arguments);this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let r=await or.getFileType(e);return r&&this._fsPathFileTypes.set(t,r),r}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}dispose(){super.dispose(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},jh=class extends cc{constructor(e){super(e,nn.workspace.onDidCreateFiles,Hn.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didCreateFiles?r.didCreateFiles(e,t):t(e)}};Lt.DidCreateFilesFeature=jh;var $h=class extends uc{constructor(e){super(e,nn.workspace.onDidRenameFiles,Hn.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=nn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didRenameFiles?r.didRenameFiles(e,t):t(e)}};Lt.DidRenameFilesFeature=$h;var Hh=class extends uc{constructor(e){super(e,nn.workspace.onDidDeleteFiles,Hn.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=nn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){var i;this.clearFileTypeCache();let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.didDeleteFiles?r.didDeleteFiles(e,t):t(e)}};Lt.DidDeleteFilesFeature=Hh;var Zo=class extends or{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o);this._requestType=r,this._accessUri=s,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let r=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,r)}else return}},Wh=class extends Zo{constructor(e){super(e,nn.workspace.onWillCreateFiles,Hn.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willCreateFiles?r.willCreateFiles(e,t):t(e)}};Lt.WillCreateFilesFeature=Wh;var zh=class extends Zo{constructor(e){super(e,nn.workspace.onWillRenameFiles,Hn.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willRenameFiles?r.willRenameFiles(e,t):t(e)}};Lt.WillRenameFilesFeature=zh;var Uh=class extends Zo{constructor(e){super(e,nn.workspace.onWillDeleteFiles,Hn.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){var i;let r=(i=this._client.clientOptions.middleware)==null?void 0:i.workspace;return r!=null&&r.willDeleteFiles?r.willDeleteFiles(e,t):t(e)}};Lt.WillDeleteFilesFeature=Uh});var Gh=x(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.LinkedEditingFeature=void 0;var jD=require("vscode"),lc=De(),$D=pt();function Vh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Bh=class extends $D.TextDocumentFeature{constructor(e){super(e,lc.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=Vh(Vh(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r={provideLinkedEditingRanges:(i,o,s)=>{let a=this._client,c=(g,v,h)=>a.sendRequest(lc.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(g,v),h).then(C=>h.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(C,h),C=>a.handleFailedRequest(lc.LinkedEditingRangeRequest.type,h,C,null)),l=a.clientOptions.middleware;return l.provideLinkedEditingRange?l.provideLinkedEditingRange(i,o,s,c):c(i,o,s)}};return[jD.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),r),r]}};es.LinkedEditingFeature=Bh});var Yh=x(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.TypeHierarchyFeature=void 0;var HD=require("vscode"),Er=De(),WD=pt();function Xh(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Qh=class{constructor(e){this.client=e,this.middleware=e.clientOptions.middleware}prepareTypeHierarchy(e,t,r){let i=this.client,o=this.middleware,s=(a,c,l)=>{let g=i.code2ProtocolConverter.asTextDocumentPositionParams(a,c);return i.sendRequest(Er.TypeHierarchyPrepareRequest.type,g,l).then(v=>l.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(v,l),v=>i.handleFailedRequest(Er.TypeHierarchyPrepareRequest.type,l,v,null))};return o.prepareTypeHierarchy?o.prepareTypeHierarchy(e,t,r,s):s(e,t,r)}provideTypeHierarchySupertypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Er.TypeHierarchySupertypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Er.TypeHierarchySupertypesRequest.type,a,l,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,o):o(e,t)}provideTypeHierarchySubtypes(e,t){let r=this.client,i=this.middleware,o=(s,a)=>{let c={item:r.code2ProtocolConverter.asTypeHierarchyItem(s)};return r.sendRequest(Er.TypeHierarchySubtypesRequest.type,c,a).then(l=>a.isCancellationRequested?null:r.protocol2CodeConverter.asTypeHierarchyItems(l,a),l=>r.handleFailedRequest(Er.TypeHierarchySubtypesRequest.type,a,l,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,o):o(e,t)}},Jh=class extends WD.TextDocumentFeature{constructor(e){super(e,Er.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=Xh(Xh(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[r,i]=this.getRegistration(t,e.typeHierarchyProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=this._client,r=new Qh(t);return[HD.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),r),r]}};ts.TypeHierarchyFeature=Jh});var tg=x(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.InlineValueFeature=void 0;var Zh=require("vscode"),ns=De(),zD=pt();function rs(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var eg=class extends zD.TextDocumentFeature{constructor(e){super(e,ns.InlineValueRequest.type)}fillClientCapabilities(e){rs(rs(e,"textDocument"),"inlineValue").dynamicRegistration=!0,rs(rs(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(ns.InlineValueRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlineValues.fire()});let[r,i]=this.getRegistration(t,e.inlineValueProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new Zh.EventEmitter,i={onDidChangeInlineValues:r.event,provideInlineValues:(o,s,a,c)=>{let l=this._client,g=(h,C,b,k)=>{let I={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(h),range:l.code2ProtocolConverter.asRange(C),context:l.code2ProtocolConverter.asInlineValueContext(b)};return l.sendRequest(ns.InlineValueRequest.type,I,k).then(O=>k.isCancellationRequested?null:l.protocol2CodeConverter.asInlineValues(O,k),O=>l.handleFailedRequest(ns.InlineValueRequest.type,k,O,null))},v=l.clientOptions.middleware;return v.provideInlineValues?v.provideInlineValues(o,s,a,c,g):g(o,s,a,c)}};return[Zh.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlineValues:r}]}};is.InlineValueFeature=eg});var ig=x(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.InlayHintsFeature=void 0;var ng=require("vscode"),ti=De(),UD=pt();function os(n,e){return n[e]===void 0&&(n[e]=Object.create(null)),n[e]}var rg=class extends UD.TextDocumentFeature{constructor(e){super(e,ti.InlayHintRequest.type)}fillClientCapabilities(e){let t=os(os(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},os(os(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(ti.InlayHintRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeInlayHints.fire()});let[r,i]=this.getRegistration(t,e.inlayHintProvider);!r||!i||this.register({id:r,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,r=new ng.EventEmitter,i={onDidChangeInlayHints:r.event,provideInlayHints:(o,s,a)=>{let c=this._client,l=async(v,h,C)=>{let b={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(v),range:c.code2ProtocolConverter.asRange(h)};try{let k=await c.sendRequest(ti.InlayHintRequest.type,b,C);return C.isCancellationRequested?null:c.protocol2CodeConverter.asInlayHints(k,C)}catch(k){return c.handleFailedRequest(ti.InlayHintRequest.type,C,k,null)}},g=c.clientOptions.middleware;return g.provideInlayHints?g.provideInlayHints(o,s,a,l):l(o,s,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(o,s)=>{let a=this._client,c=async(g,v)=>{try{let h=await a.sendRequest(ti.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(g),v);if(v.isCancellationRequested)return null;let C=a.protocol2CodeConverter.asInlayHint(h,v);return v.isCancellationRequested?null:C}catch(h){return a.handleFailedRequest(ti.InlayHintResolveRequest.type,v,h,null)}},l=a.clientOptions.middleware;return l.resolveInlayHint?l.resolveInlayHint(o,s,c):c(o,s)}:void 0,[ng.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeInlayHints:r}]}};ss.InlayHintsFeature=rg});var fg=x(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.DiagnosticFeature=xr.vsdiag=void 0;var ze=require("vscode"),Ve=De(),KD=Jr(),Bi=pt();function og(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var Sn;(function(n){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=n.DocumentDiagnosticReportKind||(n.DocumentDiagnosticReportKind={}))})(Sn=xr.vsdiag||(xr.vsdiag={}));var Tt;(function(n){n.active="open",n.reschedule="reschedule",n.outDated="drop"})(Tt||(Tt={}));var sg=class{constructor(){this.open=new Set;let e=()=>{if(this.open.clear(),ze.window.tabs!==void 0)for(let t of ze.window.tabs)t.resource!==void 0&&this.open.add(t.resource.toString());else if(ze.window.openEditors!==void 0)for(let t of ze.window.openEditors)t.resource!==void 0&&this.open.add(t.resource.toString())};e(),ze.window.onDidChangeTabs!==void 0?this.disposable=ze.window.onDidChangeTabs(e):ze.window.onDidChangeOpenEditors!==void 0?this.disposable=ze.window.onDidChangeOpenEditors(e):this.disposable={dispose:()=>{}}}dispose(){this.disposable.dispose()}isActive(e){var t;return((t=ze.window.activeTextEditor)==null?void 0:t.document)===e}isVisible(e){return this.open.has(e.uri.toString())}},Kt;(function(n){n[n.document=1]="document",n[n.workspace=2]="workspace"})(Kt||(Kt={}));var ag=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,r){let i=e===Kt.document?this.documentPullStates:this.workspacePullStates,[o,s,a]=typeof t=="string"?[t,ze.Uri.parse(t),r]:[t.uri.toString(),t.uri,t.version],c=i.get(o);return c===void 0&&(c={document:s,pulledVersion:a,resultId:void 0},i.set(o,c)),c}update(e,t,r,i){let o=e===Kt.document?this.documentPullStates:this.workspacePullStates,[s,a,c,l]=typeof t=="string"?[t,ze.Uri.parse(t),r,i]:[t.uri.toString(),t.uri,t.version,r],g=o.get(s);g===void 0?(g={document:a,pulledVersion:c,resultId:l},o.set(s,g)):(g.pulledVersion=c,g.resultId=l)}unTrack(e,t){(e===Kt.document?this.documentPullStates:this.workspacePullStates).delete(t.uri.toString())}tracks(e,t){let r=typeof t=="string"?t:t.uri.toString();return(e===Kt.document?this.documentPullStates:this.workspacePullStates).has(r)}getResultId(e,t){var i;return(i=(e===Kt.document?this.documentPullStates:this.workspacePullStates).get(t.uri.toString()))==null?void 0:i.resultId}getAllResultIds(){let e=[];for(let[t,r]of this.workspacePullStates)this.documentPullStates.has(t)&&(r=this.documentPullStates.get(t)),r.resultId!==void 0&&e.push({uri:t,value:r.resultId});return e}},cg=class{constructor(e,t,r){this.client=e,this.editorTracker=t,this.options=r,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new ze.EventEmitter,this.provider=this.createProvider(),this.diagnostics=ze.languages.createDiagnosticCollection(r.identifier),this.openRequests=new Map,this.documentStates=new ag,this.workspaceErrorCounter=0}knows(e,t){return this.documentStates.tracks(e,t)}pull(e,t){this.pullAsync(e).then(()=>{t&&t()},r=>{this.client.error(`Document pull failed for text document ${e.uri.toString()}`,r,!1)})}async pullAsync(e){let t=e.uri.toString(),r=e.version,i=this.openRequests.get(t),o=this.documentStates.track(Kt.document,e);if(i===void 0){let s=new ze.CancellationTokenSource;this.openRequests.set(t,{state:Tt.active,version:r,textDocument:e,tokenSource:s});let a,c;try{a=await this.provider.provideDiagnostics(e,o.resultId,s.token)??{kind:Sn.DocumentDiagnosticReportKind.full,items:[]}}catch(l){if(l instanceof Bi.LSPCancellationError&&Ve.Proposed.DiagnosticServerCancellationData.is(l.data)&&l.data.retriggerRequest===!1&&(c={state:Tt.outDated,textDocument:e}),c===void 0&&l instanceof ze.CancellationError)c={state:Tt.reschedule,textDocument:e};else throw l}if(c=c??this.openRequests.get(t),c===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${t}`),this.diagnostics.delete(e.uri);return}if(this.openRequests.delete(t),!this.editorTracker.isVisible(e)){this.documentStates.unTrack(Kt.document,e);return}if(c.state===Tt.outDated)return;a!==void 0&&(a.kind===Sn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(e.uri,a.items),o.pulledVersion=r,o.resultId=a.resultId),c.state===Tt.reschedule&&this.pull(e)}else i.state===Tt.active?(i.tokenSource.cancel(),this.openRequests.set(t,{state:Tt.reschedule,textDocument:i.textDocument})):i.state===Tt.outDated&&this.openRequests.set(t,{state:Tt.reschedule,textDocument:i.textDocument})}cleanupPull(e){let t=e.uri.toString(),r=this.openRequests.get(t);this.options.workspaceDiagnostics||this.options.interFileDependencies?r!==void 0?this.openRequests.set(t,{state:Tt.reschedule,textDocument:e}):this.pull(e):(r!==void 0&&(r.state===Tt.active&&r.tokenSource.cancel(),this.openRequests.set(t,{state:Tt.outDated,textDocument:e})),this.diagnostics.delete(e.uri))}pullWorkspace(){this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof Bi.LSPCancellationError)&&!Ve.Proposed.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Ve.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new ze.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let r of t.items)r.kind===Sn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Kt.document,r.uri.toString())||this.diagnostics.set(r.uri,r.items)),this.documentStates.update(Kt.workspace,r.uri.toString(),r.version??void 0,r.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,r,i)=>{let o=(a,c,l)=>{let g={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a.uri)},previousResultId:c};return this.client.sendRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,l).then(async v=>v==null||this.isDisposed||l.isCancellationRequested?{kind:Sn.DocumentDiagnosticReportKind.full,items:[]}:v.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Sn.DocumentDiagnosticReportKind.full,resultId:v.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(v.items,l)}:{kind:Sn.DocumentDiagnosticReportKind.unChanged,resultId:v.resultId},v=>this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,l,v,{kind:Sn.DocumentDiagnosticReportKind.full,items:[]}))},s=this.client.clientOptions.middleware;return s.provideDiagnostics?s.provideDiagnostics(t,r,i,o):o(t,r,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,r,i)=>{let o=async l=>l.kind===Ve.Proposed.DocumentDiagnosticReportKind.full?{kind:Sn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version,items:await this.client.protocol2CodeConverter.asDiagnostics(l.items,r)}:{kind:Sn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(l.uri),resultId:l.resultId,version:l.version},s=l=>{let g=[];for(let v of l)g.push({uri:this.client.code2ProtocolConverter.asUri(v.uri),value:v.value});return g},a=(l,g)=>{let v=(0,KD.generateUuid)(),h=this.client.onProgress(Ve.Proposed.WorkspaceDiagnosticRequest.partialResult,v,async b=>{if(b==null){i(null);return}let k={items:[]};for(let I of b.items)try{k.items.push(await o(I))}catch(O){this.client.error("Converting workspace diagnostics failed.",O)}i(k)}),C={identifier:this.options.identifier,previousResultIds:s(l),partialResultToken:v};return this.client.sendRequest(Ve.Proposed.WorkspaceDiagnosticRequest.type,C,g).then(async b=>{if(g.isCancellationRequested)return{items:[]};let k={items:[]};for(let I of b.items)k.items.push(await o(I));return h.dispose(),i(k),{items:[]}},b=>(h.dispose(),this.client.handleFailedRequest(Ve.Proposed.DocumentDiagnosticRequest.type,g,b,{items:[]})))},c=this.client.clientOptions.middleware;return c.provideWorkspaceDiagnostics?c.provideWorkspaceDiagnostics(t,r,i,a):a(t,r,i)}),e}dispose(){var e,t;this.isDisposed=!0,(e=this.workspaceCancellation)==null||e.cancel(),(t=this.workspaceTimeout)==null||t.dispose();for(let[r,i]of this.openRequests)i.state===Tt.active&&i.tokenSource.cancel(),this.openRequests.set(r,{state:Tt.outDated,textDocument:i.textDocument})}},ug=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Ve.LinkedMap}add(e){let t=e.uri.toString();this.documents.has(t)||(this.documents.set(e.uri.toString(),e,Ve.Touch.Last),this.trigger())}remove(e){let t=e.uri.toString();this.documents.has(t)&&(this.documents.delete(t),this.diagnosticRequestor.pull(e)),this.documents.size===0?this.stop():e===this.endDocument&&(this.endDocument=this.documents.last)}trigger(){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Ve.RAL)().timer.setInterval(()=>{let e=this.documents.first;e!==void 0&&(this.diagnosticRequestor.pull(e),this.documents.set(e.uri.toString(),e,Ve.Touch.Last),e===this.endDocument&&this.stop())},200)}dispose(){this.stop(),this.documents.clear()}stop(){var e;(e=this.intervalHandle)==null||e.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}},lg=class{constructor(e,t,r){var v;let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},o=e.protocol2CodeConverter.asDocumentSelector(r.documentSelector),s=[],a=h=>ze.languages.match(o,h)>0&&t.isVisible(h);this.diagnosticRequestor=new cg(e,t,r),this.backgroundScheduler=new ug(this.diagnosticRequestor);let c=h=>{!a(h)||!r.interFileDependencies||this.activeTextDocument===h||this.backgroundScheduler.add(h)};this.activeTextDocument=(v=ze.window.activeTextEditor)==null?void 0:v.document,ze.window.onDidChangeActiveTextEditor(h=>{let C=this.activeTextDocument;this.activeTextDocument=h==null?void 0:h.document,C!==void 0&&c(C),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let l=e.getFeature(Ve.DidOpenTextDocumentNotification.method);s.push(l.onNotificationSent(h=>{let C=h.original;a(C)&&this.diagnosticRequestor.pull(C,()=>{c(C)})}));for(let h of ze.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h,()=>{c(h)});if(i.onChange){let h=e.getFeature(Ve.DidChangeTextDocumentNotification.method);s.push(h.onNotificationSent(async C=>{let b=C.original.document;(i.filter===void 0||!i.filter(b,Bi.DiagnosticPullMode.onType))&&this.diagnosticRequestor.knows(Kt.document,b)&&C.original.contentChanges.length>0&&this.diagnosticRequestor.pull(b,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave){let h=e.getFeature(Ve.DidSaveTextDocumentNotification.method);s.push(h.onNotificationSent(C=>{let b=C.original;(i.filter===void 0||!i.filter(b,Bi.DiagnosticPullMode.onSave))&&this.diagnosticRequestor.knows(Kt.document,b)&&this.diagnosticRequestor.pull(C.original,()=>{this.backgroundScheduler.trigger()})}))}let g=e.getFeature(Ve.DidCloseTextDocumentNotification.method);s.push(g.onNotificationSent(h=>{let C=h.original;this.diagnosticRequestor.cleanupPull(C),this.backgroundScheduler.remove(C)})),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let h of ze.workspace.textDocuments)a(h)&&this.diagnosticRequestor.pull(h)}),r.workspaceDiagnostics===!0&&r.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=ze.Disposable.from(...s,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}},dg=class extends Bi.TextDocumentFeature{constructor(e){super(e,Ve.Proposed.DocumentDiagnosticRequest.type);this.editorTracker=new sg}fillClientCapabilities(e){let t=og(og(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1}initialize(e,t){this._client.onRequest(Ve.Proposed.DiagnosticRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeDiagnosticsEmitter.fire()});let[i,o]=this.getRegistration(t,e.diagnosticProvider);!i||!o||this.register({id:i,registerOptions:o})}dispose(){this.editorTracker.dispose(),super.dispose()}registerLanguageProvider(e){let t=new lg(this._client,this.editorTracker,e);return[t.disposable,t]}};xr.DiagnosticFeature=dg});var mg=x(ls=>{"use strict";Object.defineProperty(ls,"__esModule",{value:!0});ls.NotebookDocumentSyncFeature=void 0;var qt=require("vscode"),VD=ac(),Wn=De(),_n=De(),as=Jr(),pg=Rn();function hg(n,e){return n[e]===void 0&&(n[e]={}),n[e]}var ni;(function(n){let e;(function(t){function r(h,C){return{version:h.version,uri:C.asUri(h.uri)}}t.asVersionedNotebookDocumentIdentifier=r;function i(h,C,b){let k=Wn.Proposed.NotebookDocument.create(b.asUri(h.uri),h.notebookType,h.version,o(C,b));return Object.keys(h.metadata).length>0&&(k.metadata=s(h.metadata)),k}t.asNotebookDocument=i;function o(h,C){return h.map(b=>a(b,C))}t.asNotebookCells=o;function s(h){return l(new Set,h)}t.asMetadata=s;function a(h,C){let b=Wn.Proposed.NotebookCell.create(c(h.kind),C.asUri(h.document.uri));return Object.keys(h.metadata).length>0&&(b.metadata=s(h.metadata)),h.executionSummary!==void 0&&pg.number(h.executionSummary.executionOrder)&&pg.boolean(h.executionSummary.success)&&(b.executionSummary={executionOrder:h.executionSummary.executionOrder,success:h.executionSummary.success}),b}t.asNotebookCell=a;function c(h){switch(h){case qt.NotebookCellKind.Markup:return Wn.Proposed.NotebookCellKind.Markup;case qt.NotebookCellKind.Code:return Wn.Proposed.NotebookCellKind.Code}}function l(h,C){if(h.has(C))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(C)){let b=[];for(let k of C)if(k!==null&&typeof k=="object"||Array.isArray(k))b.push(l(h,k));else{if(k instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");b.push(k)}return b}else{let b=Object.keys(C),k=Object.create(null);for(let I of b){let O=C[I];if(O!==null&&typeof O=="object"||Array.isArray(O))k[I]=l(h,O);else{if(O instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");k[I]=O}}return k}}function g(h,C){let b=C.asChangeTextDocumentParams(h);return{document:b.textDocument,changes:b.contentChanges}}t.asTextContentChange=g;function v(h,C){let b=Object.create(null);if(h.metadata&&(b.metadata=n.c2p.asMetadata(h.metadata)),h.cells!==void 0){let k=Object.create(null),I=h.cells;I.structure&&(k.structure={array:{start:I.structure.array.start,deleteCount:I.structure.array.deleteCount,cells:I.structure.array.cells!==void 0?I.structure.array.cells.map(O=>n.c2p.asNotebookCell(O,C)):void 0},didOpen:I.structure.didOpen!==void 0?I.structure.didOpen.map(O=>C.asOpenTextDocumentParams(O.document).textDocument):void 0,didClose:I.structure.didClose!==void 0?I.structure.didClose.map(O=>C.asCloseTextDocumentParams(O.document).textDocument):void 0}),I.data!==void 0&&(k.data=I.data.map(O=>n.c2p.asNotebookCell(O,C))),I.textContent!==void 0&&(k.textContent=I.textContent.map(O=>n.c2p.asTextContentChange(O,C))),Object.keys(k).length>0&&(b.cells=k)}return b}t.asNotebookDocumentChangeEvent=v})(e=n.c2p||(n.c2p={}))})(ni||(ni={}));var dc;(function(n){function e(a,c,l){let g=a.length,v=c.length,h=0;for(;h<v&&h<g&&t(a[h],c[h],l);)h++;if(h<v&&h<g){let C=g-1,b=v-1;for(;C>=0&&b>=0&&t(a[C],c[b],l);)C--,b--;let k=C+1-h,I=h===b+1?void 0:c.slice(h,b+1);return I!==void 0?{start:h,deleteCount:k,cells:I}:{start:h,deleteCount:k}}else return h<v?{start:h,deleteCount:0,cells:c.slice(h)}:h<g?{start:h,deleteCount:g-h}:void 0}n.computeDiff=e;function t(a,c,l=!0){return a.kind!==c.kind||a.document.uri.toString()!==c.document.uri.toString()||a.document.languageId!==c.document.languageId||!r(a.executionSummary,c.executionSummary)?!1:!l||l&&o(a.metadata,c.metadata)}function r(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.executionOrder===c.executionOrder&&a.success===c.success&&i(a.timing,c.timing)}function i(a,c){return a===c?!0:a===void 0||c===void 0?!1:a.startTime===c.startTime&&a.endTime===c.endTime}function o(a,c){if(a===c)return!0;if(a==null||c===null||c===void 0||typeof a!=typeof c||typeof a!="object")return!1;let l=Array.isArray(a),g=Array.isArray(c);if(l!==g)return!1;if(l&&g){if(a.length!==c.length)return!1;for(let v=0;v<a.length;v++)if(!o(a[v],c[v]))return!1}if(s(a)&&s(c)){let v=Object.keys(a),h=Object.keys(c);if(v.length!==h.length||(v.sort(),h.sort(),!o(v,h)))return!1;for(let C=0;C<v.length;C++){let b=v[C];if(!o(a[b],c[b]))return!1}return!0}return!1}function s(a){return a!==null&&typeof a=="object"}n.isObjectLiteral=s})(dc||(dc={}));var fc;(function(n){function e(t,r){if(typeof t=="string")return t==="*"||r.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&r.notebookType!==t.notebookType)return!1;let i=r.uri;if(t.scheme!==void 0&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let o=new VD.Minimatch(t.pattern,{noext:!0});if(!o.makeRe()||!o.match(i.fsPath))return!1}return!0}n.matchNotebook=e})(fc||(fc={}));var cs;(function(n){function e(r){var s,a,c;let i=r.notebookSelector,o=[];for(let l of i){let g=(typeof l.notebook=="string"?l.notebook:(s=l.notebook)==null?void 0:s.notebookType)??"*",v=typeof l.notebook=="string"||(a=l.notebook)==null?void 0:a.scheme,h=typeof l.notebook=="string"||(c=l.notebook)==null?void 0:c.pattern;if(l.cells!==void 0)for(let C of l.cells)o.push(t(g,v,h,C.language));else o.push(t(g,v,h,void 0))}return o}n.asDocumentSelector=e;function t(r,i,o,s){return i===void 0&&o===void 0?{notebook:r,language:s}:{notebook:{notebookType:r,scheme:i,pattern:o},language:s}}})(cs||(cs={}));var us;(function(n){function e(t){return{cells:t,uris:new Set(t.map(r=>r.document.uri.toString()))}}n.create=e})(us||(us={}));var Gi=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(cs.asDocumentSelector(t)),qt.workspace.onDidOpenNotebookDocument(r=>{this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r)},void 0,this.disposables);for(let r of qt.workspace.notebookDocuments)this.notebookDidOpen.add(r.uri.toString()),this.didOpen(r);qt.workspace.onDidChangeNotebookDocument(r=>this.didChangeNotebookDocument(r),void 0,this.disposables),this.options.save===!0&&qt.workspace.onDidSaveNotebookDocument(r=>this.didSave(r),void 0,this.disposables),qt.workspace.onDidCloseNotebookDocument(r=>{this.didClose(r),this.notebookDidOpen.delete(r.uri.toString())},void 0,this.disposables)}get mode(){return"notebook"}handles(e){return qt.languages.match(this.selector,e.document)>0}didOpenNotebookCellTextDocument(e,t){if(qt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let r=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(r!==void 0){let o=r.uris.has(t.document.uri.toString());if(i&&o||!i&&!o)return;if(i){let s=this.getMatchingCells(e);if(s!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,r,s);a!==void 0&&this.doSendChange(a,s).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){qt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let r=this.notebookSyncInfo.get(e.uri.toString());if(r===void 0)return;let i=t.document.uri,o=r.cells.findIndex(s=>s.document.uri.toString()===i.toString());if(o!==-1)if(o===0&&r.cells.length===1)this.doSendClose(e,r.cells).catch(()=>{});else{let s=r.cells.slice(),a=s.splice(o,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:o,deleteCount:1},didClose:a}}},s).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),r=this.notebookSyncInfo.get(e.uri.toString())){if(r!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,r,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,r=this.notebookSyncInfo.get(t.uri.toString());if(r===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,r)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,r);return}let o=this.asNotebookDocumentChangeEvent(e.notebook,e,r,i);o!==void 0&&this.doSendChange(o,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let r=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,r).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){var o;let r=async(s,a)=>{let c=ni.c2p.asNotebookDocument(s,a,this.client.code2ProtocolConverter),l=a.map(g=>this.client.code2ProtocolConverter.asTextDocumentItem(g.document));try{await this.client.sendNotification(Wn.Proposed.DidOpenNotebookDocumentNotification.type,{notebookDocument:c,cellTextDocuments:l})}catch(g){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",g),g}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),us.create(t)),(i==null?void 0:i.didOpen)!==void 0?i.didOpen(e,t,r):r(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){var o,s;let r=async a=>{try{await this.client.sendNotification(Wn.Proposed.DidChangeNotebookDocumentNotification.type,{notebookDocument:ni.c2p.asVersionedNotebookDocumentIdentifier(a.notebook,this.client.code2ProtocolConverter),change:ni.c2p.asNotebookDocumentChangeEvent(a,this.client.code2ProtocolConverter)})}catch(c){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return((s=e.cells)==null?void 0:s.structure)!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),us.create(t??[])),(i==null?void 0:i.didChange)!==void 0?i==null?void 0:i.didChange(e,r):r(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){var i;let t=async o=>{try{await this.client.sendNotification(Wn.Proposed.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(o.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},r=(i=this.client.clientOptions.middleware)==null?void 0:i.notebooks;return(r==null?void 0:r.didSave)!==void 0?r.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){var o;let r=async(s,a)=>{try{await this.client.sendNotification(Wn.Proposed.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:a.map(c=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(c.document))})}catch(c){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",c),c}},i=(o=this.client.clientOptions.middleware)==null?void 0:o.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),(i==null?void 0:i.didClose)!==void 0?i.didClose(e,t,r):r(e,t)}asNotebookDocumentChangeEvent(e,t,r,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let o={notebook:e};(t==null?void 0:t.metadata)!==void 0&&(o.metadata=ni.c2p.asMetadata(t.metadata));let s;if((t==null?void 0:t.cellChanges)!==void 0&&t.cellChanges.length>0){let a=[];s=new Set(i.map(c=>c.document.uri.toString()));for(let c of t.cellChanges)s.has(c.cell.document.uri.toString())&&(c.executionSummary!==void 0||c.metadata!==void 0)&&a.push(c.cell);a.length>0&&(o.cells=o.cells??{},o.cells.data=a)}if(((t==null?void 0:t.contentChanges)!==void 0&&t.contentChanges.length>0||t===void 0)&&r!==void 0&&i!==void 0){let a=r.cells,c=i,l=dc.computeDiff(a,c,!1),g,v;if(l!==void 0){g=l.cells===void 0?new Map:new Map(l.cells.map(b=>[b.document.uri.toString(),b])),v=l.deleteCount===0?new Map:new Map(a.slice(l.start,l.start+l.deleteCount).map(b=>[b.document.uri.toString(),b]));for(let b of Array.from(v.keys()))g.has(b)&&(v.delete(b),g.delete(b));o.cells=o.cells??{};let h=[],C=[];if(g.size>0||v.size>0){for(let b of g.values())h.push(b);for(let b of v.values())C.push(b)}o.cells.structure={array:l,didOpen:h,didClose:C}}}return Object.keys(o).length>1?o:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let r of this.options.notebookSelector)if(r.notebook===void 0){if(r.cells===void 0)return;let i=this.filterCells(e,t,r.cells);return i.length===0?void 0:i}else if(fc.matchNotebook(r.notebook,e))return r.cells===void 0?t:this.filterCells(e,t,r.cells)}}cellMatches(e,t){let r=this.getMatchingCells(e,[t]);return r!==void 0&&r[0]===t}filterCells(e,t,r){var o;let i=t.filter(s=>{let a=s.document.languageId;return r.some(c=>c.language==="*"||a===c.language)});return typeof((o=this.client.clientOptions.notebookDocumentOptions)==null?void 0:o.filterCells)=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,t):i}},gg=class{constructor(e,t){this.client=e,this.documentSelector=cs.asDocumentSelector(t);let r=as.generateUuid();this.client.getFeature(_n.DidOpenTextDocumentNotification.method).register({id:r,registerOptions:{documentSelector:this.documentSelector}});let i=as.generateUuid();this.client.getFeature(_n.DidChangeTextDocumentNotification.method).register({id:i,registerOptions:{documentSelector:this.documentSelector,syncKind:_n.TextDocumentSyncKind.Incremental}});let o=as.generateUuid();this.client.getFeature(_n.DidCloseTextDocumentNotification.method).register({id:o,registerOptions:{documentSelector:this.documentSelector}}),this.registrations={open:r,change:i,close:o}}get mode(){return"cellContent"}handles(e){return qt.languages.match(this.client.protocol2CodeConverter.asDocumentSelector(this.documentSelector),e.document)>0}dispose(){this.registrations!==void 0&&(this.client.getFeature(_n.DidOpenTextDocumentNotification.method).unregister(this.registrations.open),this.client.getFeature(_n.DidChangeTextDocumentNotification.method).unregister(this.registrations.change),this.client.getFeature(_n.DidCloseTextDocumentNotification.method).unregister(this.registrations.close))}async sendDidOpenTextDocument(e){let t=this.client.getFeature(_n.DidOpenTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No open provider found for notebook cell document ${e.uri.toString()}`))}async sendDidChangeTextDocument(e){let t=this.client.getFeature(_n.DidChangeTextDocumentNotification.method).getProvider(e.document);return t!==void 0?t.send(e):Promise.reject(new Error(`No change provider found for notebook cell document ${e.document.uri.toString()}`))}async sendDidCloseTextDocument(e){let t=this.client.getFeature(_n.DidCloseTextDocumentNotification.method).getProvider(e);return t!==void 0?t.send(e):Promise.reject(new Error(`No close provider found for notebook cell document ${e.uri.toString()}`))}},kr=class{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=Wn.Proposed.NotebookDocumentSyncRegistrationType.type,qt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==kr.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Gi&&o.didOpenNotebookCellTextDocument(r,i)}),qt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let r=t.document;if(r.uri.scheme!==kr.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(r);if(i!==void 0)for(let o of this.registrations.values())o instanceof Gi&&o.didChangeNotebookCellTextDocument(i,t)}),qt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==kr.CellScheme)return;let[r,i]=this.findNotebookDocumentAndCell(t);if(!(r===void 0||i===void 0))for(let o of this.registrations.values())o instanceof Gi&&o.didCloseNotebookCellTextDocument(r,i)})}fillClientCapabilities(e){let t=hg(hg(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let r=t.id??as.generateUuid();this.register({id:r,registerOptions:t})}register(e){if(e.registerOptions.mode==="cellContent"){let t=new gg(this.client,e.registerOptions);this.registrations.set(e.id,t)}else{let t=new Gi(this.client,e.registerOptions);this.registrations.set(e.id,t)}}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}dispose(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}getProvider(e){for(let t of this.registrations.values())if(t.handles(e))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let r of qt.workspace.notebookDocuments)for(let i of r.getCells())if(i.document.uri.toString()===t)return[r,i];return[void 0,void 0]}};ls.NotebookDocumentSyncFeature=kr;kr.CellScheme="vscode-notebook-cell"});var pc=x(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.ProposedFeatures=qr.CommonLanguageClient=void 0;var BD=pt(),GD=Vp(),XD=Da(),QD=Xp(),JD=Jp(),YD=Zp(),ZD=nh(),eS=oh(),tS=ch(),nS=lh(),rS=hh(),iS=mh(),ri=Kh(),oS=Gh(),sS=Yh(),aS=tg(),cS=ig(),Cg=class extends BD.BaseLanguageClient{constructor(e,t,r){super(e,t,r)}registerProposedFeatures(){this.registerFeatures(wg.createAll(this))}registerBuiltinFeatures(){super.registerBuiltinFeatures(),this.registerFeature(new XD.ConfigurationFeature(this)),this.registerFeature(new JD.TypeDefinitionFeature(this)),this.registerFeature(new QD.ImplementationFeature(this)),this.registerFeature(new GD.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new YD.WorkspaceFoldersFeature(this)),this.registerFeature(new ZD.FoldingRangeFeature(this)),this.registerFeature(new eS.DeclarationFeature(this)),this.registerFeature(new tS.SelectionRangeFeature(this)),this.registerFeature(new nS.ProgressFeature(this)),this.registerFeature(new rS.CallHierarchyFeature(this)),this.registerFeature(new iS.SemanticTokensFeature(this)),this.registerFeature(new oS.LinkedEditingFeature(this)),this.registerFeature(new ri.DidCreateFilesFeature(this)),this.registerFeature(new ri.DidRenameFilesFeature(this)),this.registerFeature(new ri.DidDeleteFilesFeature(this)),this.registerFeature(new ri.WillCreateFilesFeature(this)),this.registerFeature(new ri.WillRenameFilesFeature(this)),this.registerFeature(new ri.WillDeleteFilesFeature(this)),this.registerFeature(new sS.TypeHierarchyFeature(this)),this.registerFeature(new aS.InlineValueFeature(this)),this.registerFeature(new cS.InlayHintsFeature(this))}};qr.CommonLanguageClient=Cg;var vg=fg(),yg=mg(),wg;(function(n){function e(i){return[new vg.DiagnosticFeature(i),new yg.NotebookDocumentSyncFeature(i)]}n.createAll=e;function t(i){return new vg.DiagnosticFeature(i)}n.createDiagnosticFeature=t;function r(i){return new yg.NotebookDocumentSyncFeature(i)}n.createNotebookDocumentSyncFeature=r})(wg=qr.ProposedFeatures||(qr.ProposedFeatures={}))});var bg=x(ds=>{"use strict";Object.defineProperty(ds,"__esModule",{value:!0});ds.terminate=void 0;var Rg=require("child_process"),uS=require("path"),lS=process.platform==="win32",dS=process.platform==="darwin",fS=process.platform==="linux";function pS(n,e){if(lS)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Rg.execFileSync("taskkill",["/T","/F","/PID",n.pid.toString()],i),!0}catch{return!1}else if(fS||dS)try{var t=(0,uS.join)(__dirname,"terminateProcess.sh"),r=Rg.spawnSync(t,[n.pid.toString()]);return!r.error}catch{return!1}else return n.kill("SIGKILL"),!0}ds.terminate=pS});var hc=x((lE,Tg)=>{"use strict";Tg.exports=De()});var Dg=x(zn=>{"use strict";var hS=zn&&zn.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),gc=zn&&zn.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&hS(e,n,t)};Object.defineProperty(zn,"__esModule",{value:!0});gc(De(),zn);gc(pt(),zn);gc(pc(),zn)});var fs=x(Ot=>{"use strict";var gS=Ot&&Ot.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Pg=Ot&&Ot.__exportStar||function(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&gS(e,n,t)};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.SettingMonitor=Ot.LanguageClient=Ot.TransportKind=void 0;var Un=require("child_process"),mc=require("fs"),vc=require("path"),Sg=$l(),ar=require("vscode"),Fe=Rn(),mS=pc(),vS=pt(),yS=bg(),$e=hc();Pg(hc(),Ot);Pg(Dg(),Ot);var _g="^1.66.0",Ue;(function(n){n[n.stdio=0]="stdio",n[n.ipc=1]="ipc",n[n.pipe=2]="pipe",n[n.socket=3]="socket"})(Ue=Ot.TransportKind||(Ot.TransportKind={}));var sr;(function(n){function e(t){let r=t;return r&&r.kind===Ue.socket&&Fe.number(r.port)}n.isSocket=e})(sr||(sr={}));var yc;(function(n){function e(t){return Fe.string(t.command)}n.is=e})(yc||(yc={}));var Cc;(function(n){function e(t){return Fe.string(t.module)}n.is=e})(Cc||(Cc={}));var wc;(function(n){function e(t){let r=t;return r&&r.writer!==void 0&&r.reader!==void 0}n.is=e})(wc||(wc={}));var Rc;(function(n){function e(t){let r=t;return r&&r.process!==void 0&&typeof r.detached=="boolean"}n.is=e})(Rc||(Rc={}));var Eg=class extends mS.CommonLanguageClient{constructor(e,t,r,i,o){let s,a,c,l,g;Fe.string(t)?(s=e,a=t,c=r,l=i,g=!!o):(s=e.toLowerCase(),a=e,c=t,l=r,g=i),g===void 0&&(g=!1);super(s,a,l);this._serverOptions=c,this._forceDebug=g,this._isInDebugMode=g;try{this.checkVersion()}catch(v){throw Fe.string(v.message)&&this.outputChannel.appendLine(v.message),v}}checkVersion(){let e=Sg.parse(ar.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${ar.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!Sg.satisfies(e,_g))throw new Error(`The language client requires VS Code version ${_g} but received version ${ar.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),this.start()):this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||setTimeout(()=>{try{process.kill(e.pid,0),(0,yS.terminate)(e)}catch{}},2e3)}handleConnectionClosed(){this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(g,v){if(!g&&!v)return;let h=Object.create(null);return Object.keys(process.env).forEach(C=>h[C]=process.env[C]),v&&(h.ELECTRON_RUN_AS_NODE="1",h.ELECTRON_NO_ASAR="1"),g&&Object.keys(g).forEach(C=>h[C]=g[C]),h}let r=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function o(){let g=process.execArgv;return g?g.some(v=>r.some(h=>v.startsWith(h))||i.some(h=>v===h)):!1}function s(g){if(g.stdin===null||g.stdout===null||g.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Fe.func(a))return a().then(g=>{if(vS.MessageTransports.is(g))return this._isDetached=!!g.detached,g;if(wc.is(g))return this._isDetached=!!g.detached,{reader:new $e.StreamMessageReader(g.reader),writer:new $e.StreamMessageWriter(g.writer)};{let v;return Rc.is(g)?(v=g.process,this._isDetached=g.detached):(v=g,this._isDetached=!1),v.stderr.on("data",h=>this.outputChannel.append(Fe.string(h)?h:h.toString(e))),{reader:new $e.StreamMessageReader(v.stdout),writer:new $e.StreamMessageWriter(v.stdin)}}});let c,l=a;return l.run||l.debug?this._forceDebug||o()?(c=l.debug,this._isInDebugMode=!0):(c=l.run,this._isInDebugMode=!1):c=a,this._getServerWorkingDir(c.options).then(g=>{if(Cc.is(c)&&c.module){let v=c,h=v.transport||Ue.stdio;if(v.runtime){let C=[],b=v.options??Object.create(null);b.execArgv&&b.execArgv.forEach(M=>C.push(M)),C.push(v.module),v.args&&v.args.forEach(M=>C.push(M));let k=Object.create(null);k.cwd=g,k.env=t(b.env,!1);let I=this._getRuntimePath(v.runtime,g),O;if(h===Ue.ipc?(k.stdio=[null,null,null,"ipc"],C.push("--node-ipc")):h===Ue.stdio?C.push("--stdio"):h===Ue.pipe?(O=(0,$e.generateRandomPipeName)(),C.push(`--pipe=${O}`)):sr.isSocket(h)&&C.push(`--socket=${h.port}`),C.push(`--clientProcessId=${process.pid.toString()}`),h===Ue.ipc||h===Ue.stdio){let M=Un.spawn(I,C,k);return!M||!M.pid?ii(M,`Launching server using runtime ${I} failed.`):(this._serverProcess=M,M.stderr.on("data",q=>this.outputChannel.append(Fe.string(q)?q:q.toString(e))),h===Ue.ipc?(M.stdout.on("data",q=>this.outputChannel.append(Fe.string(q)?q:q.toString(e))),Promise.resolve({reader:new $e.IPCMessageReader(M),writer:new $e.IPCMessageWriter(M)})):Promise.resolve({reader:new $e.StreamMessageReader(M.stdout),writer:new $e.StreamMessageWriter(M.stdin)}))}else{if(h===Ue.pipe)return(0,$e.createClientPipeTransport)(O).then(M=>{let q=Un.spawn(I,C,k);return!q||!q.pid?ii(q,`Launching server using runtime ${I} failed.`):(this._serverProcess=q,q.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),q.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),M.onConnected().then($=>({reader:$[0],writer:$[1]})))});if(sr.isSocket(h))return(0,$e.createClientSocketTransport)(h.port).then(M=>{let q=Un.spawn(I,C,k);return!q||!q.pid?ii(q,`Launching server using runtime ${I} failed.`):(this._serverProcess=q,q.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),q.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),M.onConnected().then($=>({reader:$[0],writer:$[1]})))})}}else{let C;return new Promise((b,k)=>{let I=(v.args&&v.args.slice())??[];h===Ue.ipc?I.push("--node-ipc"):h===Ue.stdio?I.push("--stdio"):h===Ue.pipe?(C=(0,$e.generateRandomPipeName)(),I.push(`--pipe=${C}`)):sr.isSocket(h)&&I.push(`--socket=${h.port}`),I.push(`--clientProcessId=${process.pid.toString()}`);let O=v.options??Object.create(null);if(O.env=t(O.env,!0),O.execArgv=O.execArgv||[],O.cwd=g,O.silent=!0,h===Ue.ipc||h===Ue.stdio){let M=Un.fork(v.module,I||[],O);s(M),this._serverProcess=M,M.stderr.on("data",q=>this.outputChannel.append(Fe.string(q)?q:q.toString(e))),h===Ue.ipc?(M.stdout.on("data",q=>this.outputChannel.append(Fe.string(q)?q:q.toString(e))),b({reader:new $e.IPCMessageReader(this._serverProcess),writer:new $e.IPCMessageWriter(this._serverProcess)})):b({reader:new $e.StreamMessageReader(M.stdout),writer:new $e.StreamMessageWriter(M.stdin)})}else h===Ue.pipe?(0,$e.createClientPipeTransport)(C).then(M=>{let q=Un.fork(v.module,I||[],O);s(q),this._serverProcess=q,q.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),q.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),M.onConnected().then($=>{b({reader:$[0],writer:$[1]})},k)},k):sr.isSocket(h)&&(0,$e.createClientSocketTransport)(h.port).then(M=>{let q=Un.fork(v.module,I||[],O);s(q),this._serverProcess=q,q.stderr.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),q.stdout.on("data",$=>this.outputChannel.append(Fe.string($)?$:$.toString(e))),M.onConnected().then($=>{b({reader:$[0],writer:$[1]})},k)},k)})}}else if(yc.is(c)&&c.command){let v=c,h=c.args!==void 0?c.args.slice(0):[],C,b=c.transport;if(b===Ue.stdio)h.push("--stdio");else if(b===Ue.pipe)C=(0,$e.generateRandomPipeName)(),h.push(`--pipe=${C}`);else if(sr.isSocket(b))h.push(`--socket=${b.port}`);else if(b===Ue.ipc)throw new Error("Transport kind ipc is not support for command executable");let k=Object.assign({},v.options);if(k.cwd=k.cwd||g,b===void 0||b===Ue.stdio){let I=Un.spawn(v.command,h,k);return!I||!I.pid?ii(I,`Launching server using command ${v.command} failed.`):(I.stderr.on("data",O=>this.outputChannel.append(Fe.string(O)?O:O.toString(e))),this._serverProcess=I,this._isDetached=!!k.detached,Promise.resolve({reader:new $e.StreamMessageReader(I.stdout),writer:new $e.StreamMessageWriter(I.stdin)}))}else{if(b===Ue.pipe)return(0,$e.createClientPipeTransport)(C).then(I=>{let O=Un.spawn(v.command,h,k);return!O||!O.pid?ii(O,`Launching server using command ${v.command} failed.`):(this._serverProcess=O,this._isDetached=!!k.detached,O.stderr.on("data",M=>this.outputChannel.append(Fe.string(M)?M:M.toString(e))),O.stdout.on("data",M=>this.outputChannel.append(Fe.string(M)?M:M.toString(e))),I.onConnected().then(M=>({reader:M[0],writer:M[1]})))});if(sr.isSocket(b))return(0,$e.createClientSocketTransport)(b.port).then(I=>{let O=Un.spawn(v.command,h,k);return!O||!O.pid?ii(O,`Launching server using command ${v.command} failed.`):(this._serverProcess=O,this._isDetached=!!k.detached,O.stderr.on("data",M=>this.outputChannel.append(Fe.string(M)?M:M.toString(e))),O.stdout.on("data",M=>this.outputChannel.append(Fe.string(M)?M:M.toString(e))),I.onConnected().then(M=>({reader:M[0],writer:M[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))})}_getRuntimePath(e,t){if(vc.isAbsolute(e))return e;let r=this._mainGetRootPath();if(r!==void 0){let i=vc.join(r,e);if(mc.existsSync(i))return i}if(t!==void 0){let i=vc.join(t,e);if(mc.existsSync(i))return i}return e}_mainGetRootPath(){let e=ar.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(r=>{mc.lstat(t,(i,o)=>{r(!i&&o.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}getLocale(){let e=process.env.VSCODE_NLS_CONFIG;if(e===void 0)return"en";let t;try{t=JSON.parse(e)}catch{}return t===void 0||typeof t.locale!="string"?"en":t.locale}};Ot.LanguageClient=Eg;var xg=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return ar.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new ar.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,r=e>=0?this._setting.substr(e+1):void 0,i=r?ar.workspace.getConfiguration(t).get(r,!1):ar.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start():!i&&this._client.needsStop()&&this._client.stop()}};Ot.SettingMonitor=xg;function ii(n,e){return n===null?Promise.reject(e):new Promise((t,r)=>{n.on("error",i=>{r(`${e} ${i}`)}),setImmediate(()=>r(e))})}});var Tc=x((pE,Jg)=>{"use strict";Jg.exports=fs()});var WS={};bv(WS,{activate:()=>pv,deactivate:()=>hv});module.exports=Tv(WS);var pe=qe(require("vscode")),lv=qe(require("os"));var A=qe(require("vscode")),to=qe(fs());var Oe=qe(fs()),kg=new Oe.RequestType("rust-analyzer/analyzerStatus"),qg=new Oe.RequestType0("rust-analyzer/memoryUsage"),Og=new Oe.RequestType0("rust-analyzer/shuffleCrateGraph"),Ig=new Oe.NotificationType("experimental/serverStatus"),Ng=new Oe.RequestType0("rust-analyzer/reloadWorkspace"),Fg=new Oe.RequestType("textDocument/hover"),Lg=new Oe.RequestType("rust-analyzer/syntaxTree"),Ag=new Oe.RequestType("rust-analyzer/viewHir"),Mg=new Oe.RequestType("rust-analyzer/viewFileText"),jg=new Oe.RequestType("rust-analyzer/viewItemTree"),$g=new Oe.RequestType("rust-analyzer/viewCrateGraph"),Hg=new Oe.RequestType("rust-analyzer/expandMacro"),Wg=new Oe.RequestType("experimental/matchingBrace"),zg=new Oe.RequestType("experimental/parentModule"),Ug=new Oe.RequestType("experimental/joinLines"),Kg=new Oe.RequestType("experimental/onEnter"),Vg=new Oe.RequestType("experimental/runnables"),Bg=new Oe.RequestType("rust-analyzer/relatedTests"),bc=new Oe.RequestType("experimental/ssr"),Gg=new Oe.RequestType("experimental/externalDocs"),Xg=new Oe.RequestType("experimental/openCargoToml"),Qg=new Oe.RequestType("experimental/moveItem");var Sm=qe(require("path"));var mn=qe(require("vscode"));var CS=qe(Tc()),hs=qe(require("vscode")),Yg=require("assert"),gs=require("child_process"),Zg=require("util");function Xi(n,e){try{(0,Yg.strict)(n,e)}catch(t){throw Te.error("Assertion failed:",e),t}}var Te=new class{constructor(){this.enabled=!0;this.output=hs.window.createOutputChannel("Rust Analyzer Client")}setEnabled(n){Te.enabled=n}debug(...n){!Te.enabled||Te.write("DEBUG",...n)}info(...n){Te.write("INFO",...n)}warn(...n){debugger;Te.write("WARN",...n)}error(...n){debugger;Te.write("ERROR",...n),Te.output.show(!0)}write(n,...e){let t=e.map(Te.stringify).join(" "),r=new Date().toLocaleString();Te.output.appendLine(`${n} [${r}]: ${t}`)}stringify(n){return typeof n=="string"?n:(0,Zg.inspect)(n,{colors:!1,depth:6})}};function Qi(n){return new Promise(e=>setTimeout(e,n))}function Kn(n){return n.languageId==="rust"&&n.uri.scheme==="file"}function em(n){return n.uri.scheme==="file"&&n.fileName.endsWith("Cargo.toml")}function Pn(n){return Kn(n.document)}function tm(n){Te.debug("Checking availability of a binary at",n);let e=(0,gs.spawnSync)(n,["--version"],{encoding:"utf8"});return(e.error&&e.error.code!=="ENOENT"?Te.warn:Te.debug)(n,"--version:",e),e.status===0}function Dc(n,e){return hs.commands.executeCommand("setContext",n,e)}function nm(n){let e=new Map;return async function(t){let r=e.get(t);if(r)return r;let i=await n.call(this,t);return e.set(t,i),i}}function Sc(n,e){return new Promise((t,r)=>{(0,gs.exec)(n,e,(i,o,s)=>{if(i){r(i);return}if(s){r(new Error(s));return}t(o.trimEnd())})})}async function _c(n){if(n.entries().length===1){let[e,t]=n.entries()[0],r=await rm(e);r&&await ms(r,t);return}for(let[e,t]of n.entries()){let r=await rm(e);r&&await r.edit(i=>{for(let o of t)Xi(!om(o.newText),`bad ws edit: snippet received with multiple edits: ${JSON.stringify(n)}`),i.replace(o.range,o.newText)})}}async function rm(n){var e;return((e=mn.window.activeTextEditor)==null?void 0:e.document.uri)!==n&&await mn.window.showTextDocument(n,{}),mn.window.visibleTextEditors.find(t=>t.document.uri.toString()===n.toString())}async function ms(n,e){let t=[],r=0;await n.edit(i=>{for(let o of e){let s=om(o.newText);if(s){let[a,[c,l]]=s,g=a.substr(0,c),v=g.lastIndexOf(`
`),h=o.range.start.line+r+im(g),C=v===-1?o.range.start.character+c:g.length-v-1,b=C+l;t.push(new mn.Selection(new mn.Position(h,C),new mn.Position(h,b))),i.replace(o.range,a)}else i.replace(o.range,o.newText);r+=im(o.newText)-(o.range.end.line-o.range.start.line)}}),t.length>0&&(n.selections=t),t.length===1&&n.revealRange(t[0],mn.TextEditorRevealType.InCenterIfOutsideViewport)}function om(n){let e=n.match(/\$(0|\{0:([^}]*)\})/);if(!e)return;let t=e[2]??"";if(e.index==null)return;let r=[e.index,t.length];return[n.replace(e[0],t),r]}function im(n){return(n.match(/\n/g)||[]).length}var _m=require("child_process");var Or=qe(require("vscode"));var et=qe(require("vscode"));var sm=qe(require("child_process")),vs=qe(require("os")),ys=qe(require("path")),am=qe(require("readline")),cr=qe(require("vscode"));var Ji=class{constructor(e,t){this.rootFolder=e;this.output=t}static artifactSpec(e){let t=[...e,"--message-format=json"];switch(t[0]){case"run":t[0]="build";break;case"test":{t.includes("--no-run")||t.push("--no-run");break}}let r={cargoArgs:t};return t[0]==="test"&&(r.filter=i=>i.filter(o=>o.isTest)),r}async getArtifacts(e){var r;let t=[];try{await this.runCargo(e.cargoArgs,i=>{if(i.reason==="compiler-artifact"&&i.executable){let o=i.target.crate_types.includes("bin"),s=i.target.kind.includes("custom-build");(o&&!s||i.profile.test)&&t.push({fileName:i.executable,name:i.target.name,kind:i.target.kind[0],isTest:i.profile.test})}else i.reason==="compiler-message"&&this.output.append(i.message.rendered)},i=>this.output.append(i))}catch(i){throw this.output.show(!0),new Error(`Cargo invocation has failed: ${i}`)}return((r=e.filter)==null?void 0:r.call(e,t))??t}async executableFromArgs(e){let t=await this.getArtifacts(Ji.artifactSpec(e));if(t.length===0)throw new Error("No compilation artifacts");if(t.length>1)throw new Error("Multiple compilation artifacts are not supported.");return t[0].fileName}async runCargo(e,t,r){let i=await Pc();return await new Promise((o,s)=>{let a=sm.spawn(i,e,{stdio:["ignore","pipe","pipe"],cwd:this.rootFolder});a.on("error",l=>s(new Error(`could not launch cargo: ${l}`))),a.stderr.on("data",l=>r(l.toString())),am.createInterface({input:a.stdout}).on("line",l=>{let g=JSON.parse(l);t(g)}),a.on("exit",(l,g)=>{l===0?o(l):s(new Error(`exit code: ${l}.`))})})}};async function cm(n){let e=await Ec("rustc");return await Sc(`${e} --print sysroot`,{cwd:n})}async function um(n){let e=await Ec("rustc"),t=await Sc(`${e} -V -v`,{cwd:n});return/commit-hash:\s(.*)$/m.exec(t)[1]}function Pc(){return Ec("cargo")}var Ec=nm(async n=>{{let e=process.env[n.toUpperCase()];if(e)return e}if(await wS(n))return n;try{let e=cr.Uri.joinPath(cr.Uri.file(vs.homedir()),".cargo","bin",n);if(await lm(e))return e.fsPath}catch(e){Te.error("Failed to read the fs info",e)}return n});async function wS(n){let t=(process.env.PATH??"").split(ys.delimiter).flatMap(r=>{let i=ys.join(r,n);return vs.type()==="Windows_NT"?[i,`${i}.exe`]:[i]});for await(let r of t.map(RS))if(r)return!0;return!1}async function RS(n){return lm(cr.Uri.file(n))}async function lm(n){try{return((await cr.workspace.fs.stat(n)).type&cr.FileType.File)!==0}catch{return!1}}var oi="cargo",TS="rust",dm=class{constructor(e){this.config=e}async provideTasks(){let e=[{command:"build",group:et.TaskGroup.Build},{command:"check",group:et.TaskGroup.Build},{command:"clippy",group:et.TaskGroup.Build},{command:"test",group:et.TaskGroup.Test},{command:"clean",group:et.TaskGroup.Clean},{command:"run",group:void 0}],t=[];for(let r of et.workspace.workspaceFolders||[])for(let i of e){let o=await Cs(r,{type:oi,command:i.command},`cargo ${i.command}`,[i.command],this.config.cargoRunner);o.group=i.group,t.push(o)}return t}async resolveTask(e){let t=e.definition;if(t.type===oi&&t.command){let r=[t.command].concat(t.args??[]);return await Cs(e.scope,t,e.name,r,this.config.cargoRunner)}}};async function Cs(n,e,t,r,i,o=!1){let s;if(i){let a=`${i}.buildShellExecution`;try{let c={kind:oi,args:r,cwd:e.cwd,env:e.env},l=await et.commands.executeCommand(a,c);if(l)if(l instanceof et.ShellExecution)s=l;else throw Te.debug("Invalid cargo ShellExecution",l),"Invalid cargo ShellExecution."}catch(c){if(o)throw`Cargo runner '${i}' failed! ${c}`}}if(!s){let a=e.overrideCargo??e.overrideCargo,c=await Pc(),g=[...(a==null?void 0:a.split(" "))??[c],...r];s=new et.ProcessExecution(g[0],g.slice(1),e)}return new et.Task(e,n??et.TaskScope.Workspace,t,TS,s,["$rustc"])}function fm(n){let e=new dm(n);return et.tasks.registerTaskProvider(oi,e)}var pm=qe(require("os")),Vt=qe(require("vscode")),si=qe(require("path"));var ai=Vt.window.createOutputChannel("Debug");async function ws(n,e){var a;let t=(a=n.activeRustEditor)==null?void 0:a.document.uri;if(!t)return;let r=await hm(n,e);if(!r)return;let i=Vt.workspace.getConfiguration("launch",t),o=i.get("configurations")||[],s=o.findIndex(c=>c.name===r.name);if(s!==-1){if(await Vt.window.showErrorMessage(`Launch configuration '${r.name}' already exists!`,"Cancel","Update")==="Cancel")return;o[s]=r}else o.push(r);await i.update("configurations",o)}async function xc(n,e){let t,r="",o=Vt.workspace.getConfiguration("launch").get("configurations")||[],s=o.findIndex(a=>a.name===e.label);return s!==-1?(t=o[s],r=" (from launch.json)",ai.clear()):t=await hm(n,e),t?(ai.appendLine(`Launching debug configuration${r}:`),ai.appendLine(JSON.stringify(t,null,2)),Vt.debug.startDebugging(void 0,t)):!1}async function hm(n,e){if(!n.activeRustEditor)return;let r={"vadimcn.vscode-lldb":_S,"ms-vscode.cpptools":PS},i=n.config.debug,o=null;if(i.engine==="auto"){for(var s in r)if(o=Vt.extensions.getExtension(s),o)break}else o=Vt.extensions.getExtension(i.engine);if(!o){await Vt.window.showErrorMessage("Install [CodeLLDB](https://marketplace.visualstudio.com/items?itemName=vadimcn.vscode-lldb) or [MS C++ tools](https://marketplace.visualstudio.com/items?itemName=ms-vscode.cpptools) extension for debugging.");return}ai.clear(),n.config.debug.openDebugPane&&ai.show(!0);let a=Vt.workspace.workspaceFolders,c=a.length>1,l=a[0],g=!c||!e.args.workspaceRoot?l:a.find(q=>{var $;return($=e.args.workspaceRoot)==null?void 0:$.includes(q.uri.fsPath)})||l,v=si.normalize(g.uri.fsPath),h=c?`:${g.name}`:"";function C(q){return si.normalize(q).replace(v,"${workspaceFolder"+h+"}")}let b=await SS(e),k=kc(e,n.config.runnableEnv),I=i.sourceFileMap;if(I==="auto"){let q=await um(v),$=await cm(v),K=si.normalize($+"/lib/rustlib/src/rust");I={},I[`/rustc/${q}/`]=K}let O=r[o.id](e,C(b),k,I);if(O.type in i.engineSettings){let q=i.engineSettings[O.type];for(var M in q)O[M]=q[M]}return O.name==="run binary"&&(O.name=`run ${si.basename(b)}`),O.cwd&&(O.cwd=C(O.cwd)),O}async function SS(n){return await new Ji(n.args.workspaceRoot||".",ai).executableFromArgs(n.args.cargoArgs)}function _S(n,e,t,r){return{type:"lldb",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceMap:r,sourceLanguages:["rust"],env:t}}function PS(n,e,t,r){return{type:pm.platform()==="win32"?"cppvsdbg":"cppdbg",request:"launch",name:n.label,program:e,args:n.args.executableArgs,cwd:n.args.workspaceRoot,sourceFileMap:r,env:t}}var gm=[{iconPath:new Or.ThemeIcon("save"),tooltip:"Save as a launch.json configurtation."}];async function Yi(n,e,t=!1,r=!0){let i=n.activeRustEditor,o=n.client;if(!i||!o)return;let s={uri:i.document.uri.toString()},a=await o.sendRequest(Vg,{textDocument:s,position:o.code2ProtocolConverter.asPosition(i.selection.active)}),c=[];e&&c.push(e);for(let l of a)e&&JSON.stringify(e.runnable)===JSON.stringify(l)||t&&(l.label.startsWith("doctest")||l.label.startsWith("cargo"))||c.push(new mm(l));if(c.length===0){await Or.window.showErrorMessage("There's no debug target!");return}return await new Promise(l=>{let g=[],v=C=>{l(C),g.forEach(b=>b.dispose())},h=Or.window.createQuickPick();h.items=c,h.title="Select Runnable",r&&(h.buttons=gm),g.push(h.onDidHide(()=>v()),h.onDidAccept(()=>v(h.selectedItems[0])),h.onDidTriggerButton(async C=>{await ws(n,h.activeItems[0].runnable),v()}),h.onDidChangeActive(C=>{r&&C.length>0&&(C[0].label.startsWith("cargo")?h.buttons=[]:h.buttons.length===0&&(h.buttons=gm))}),h),h.show()})}var mm=class{constructor(e){this.runnable=e;this.label=e.label}};function kc(n,e){let t={RUST_BACKTRACE:"short"};if(n.args.expectTest&&(t.UPDATE_EXPECT="1"),Object.assign(t,process.env),e)if(Array.isArray(e))for(let r of e)(!r.mask||new RegExp(r.mask).test(n.label))&&Object.assign(t,r.env);else Object.assign(t,e);return t}async function qc(n,e){if(n.kind!=="cargo")throw`Unexpected runnable kind: ${n.kind}`;let t=Oc(n),r={type:oi,command:t[0],args:t.slice(1),cwd:n.args.workspaceRoot||".",env:kc(n,e.runnableEnv),overrideCargo:n.args.overrideCargo},i=Or.workspace.workspaceFolders[0],o=await Cs(i,r,n.label,t,e.cargoRunner,!0);return o.presentationOptions.clear=!0,o.presentationOptions.focus=!1,o}function Oc(n){let e=[...n.args.cargoArgs];return n.args.cargoExtraArgs&&e.push(...n.args.cargoExtraArgs),n.args.executableArgs.length>0&&e.push("--",...n.args.executableArgs),e}var Be=qe(require("vscode"));var Ic=class{constructor(e){this.astDecorationType=Be.window.createTextEditorDecorationType({borderColor:new Be.ThemeColor("rust_analyzer.syntaxTreeBorder"),borderStyle:"solid",borderWidth:"2px"});this.rust2Ast=new vm(()=>{let e=this.findAstTextEditor();if(!this.rustEditor||!e)return;let t=[];for(let r=0;r<e.document.lineCount;++r){let i=e.document.lineAt(r);if(!(i.text.lastIndexOf('"')>=0))continue;let s=this.parseRustTextRange(this.rustEditor.document,i.text);!s||t.push([s,this.findAstNodeRange(i)])}return t});e.pushCleanup(Be.languages.registerHoverProvider({scheme:"rust-analyzer"},this)),e.pushCleanup(Be.languages.registerDefinitionProvider({language:"rust"},this)),Be.workspace.onDidCloseTextDocument(this.onDidCloseTextDocument,this,e.subscriptions),Be.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,e.subscriptions),Be.window.onDidChangeVisibleTextEditors(this.onDidChangeVisibleTextEditors,this,e.subscriptions),e.pushCleanup(this)}dispose(){this.setRustEditor(void 0)}onDidChangeTextDocument(e){this.rustEditor&&e.document.uri.toString()===this.rustEditor.document.uri.toString()&&this.rust2Ast.reset()}onDidCloseTextDocument(e){this.rustEditor&&e.uri.toString()===this.rustEditor.document.uri.toString()&&this.setRustEditor(void 0)}onDidChangeVisibleTextEditors(e){if(!this.findAstTextEditor()){this.setRustEditor(void 0);return}this.setRustEditor(e.find(Pn))}findAstTextEditor(){return Be.window.visibleTextEditors.find(e=>e.document.uri.scheme==="rust-analyzer")}setRustEditor(e){this.rustEditor&&this.rustEditor!==e&&(this.rustEditor.setDecorations(this.astDecorationType,[]),this.rust2Ast.reset()),this.rustEditor=e}provideDefinition(e,t){var a;if(!this.rustEditor||e.uri.toString()!==this.rustEditor.document.uri.toString())return;let r=this.findAstTextEditor();if(!r)return;let i=(a=this.rust2Ast.get())==null?void 0:a.find(([c,l])=>c.contains(t));if(!i)return;let[o,s]=i;return r.revealRange(s),r.selection=new Be.Selection(s.start,s.end),[{targetRange:s,targetUri:r.document.uri,originSelectionRange:o,targetSelectionRange:s}]}provideHover(e,t){if(!this.rustEditor)return;let r=e.lineAt(t.line),i=this.parseRustTextRange(this.rustEditor.document,r.text);if(!i)return;this.rustEditor.setDecorations(this.astDecorationType,[i]),this.rustEditor.revealRange(i);let o=this.rustEditor.document.getText(i),s=this.findAstNodeRange(r);return new Be.Hover(["```rust\n"+o+"\n```"],s)}findAstNodeRange(e){let t=e.range.start,r=t.translate(void 0,e.firstNonWhitespaceCharacterIndex),i=t.translate(void 0,e.text.trimEnd().length);return new Be.Range(r,i)}parseRustTextRange(e,t){let r=/(\d+)\.\.(\d+)/.exec(t);if(!r)return;let[i,o]=r.slice(1).map(s=>this.positionAt(e,+s));return new Be.Range(i,o)}positionAt(e,t){if(e.eol===Be.EndOfLine.LF)return e.positionAt(t);let r=0,i=0,o=this.cache;for((o==null?void 0:o.doc)===e&&o.offset<=t&&({line:r,offset:i}=o);;){let s=e.lineAt(r).text.length+1;if(i+s>t)return this.cache={doc:e,offset:i,line:r},e.positionAt(t+r);i+=s,r+=1}}},vm=class{constructor(e){this.compute=e}get(){return this.val??(this.val=this.compute())}reset(){this.val=void 0}};var En=qe(Tc()),vn=qe(require("vscode"));var Zi=qe(Rn());var Fc=require("vscode");var At=qe(require("vscode"));var ym=require("path"),ES="nightly",Nc=class{constructor(e){this.extensionId="rust-lang.rust-analyzer";this.rootSection="rust-analyzer";this.requiresReloadOpts=["serverPath","server","cargo","procMacro","files","lens"].map(e=>`${this.rootSection}.${e}`);this.package=At.extensions.getExtension(this.extensionId).packageJSON;this.globalStorageUri=e.globalStorageUri,At.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,e.subscriptions),this.refreshLogging()}refreshLogging(){Te.setEnabled(this.traceExtension),Te.info("Extension version:",this.package.version);let e=Object.entries(this.cfg).filter(([t,r])=>!(r instanceof Function));Te.info("Using configuration",Object.fromEntries(e))}async onDidChangeConfiguration(e){this.refreshLogging();let t=this.requiresReloadOpts.find(i=>e.affectsConfiguration(i));if(!t)return;await At.window.showInformationMessage(`Changing "${t}" requires a reload`,"Reload now")==="Reload now"&&await At.commands.executeCommand("workbench.action.reloadWindow")}get cfg(){return At.workspace.getConfiguration(this.rootSection)}get(e){return this.cfg.get(e)}get serverPath(){return this.get("server.path")??this.get("serverPath")}get serverExtraEnv(){return this.get("server.extraEnv")??{}}get traceExtension(){return this.get("trace.extension")}get cargoRunner(){return this.get("cargoRunner")}get runnableEnv(){return this.get("runnableEnv")}get debug(){let e=this.get("debug.sourceFileMap");if(e!=="auto"){let t=this.get("debug.sourceFileMap"),{["/rustc/<id>"]:r}=t;e=Wc(t,["/rustc/<id>"])}return{engine:this.get("debug.engine"),engineSettings:this.get("debug.engineSettings"),openDebugPane:this.get("debug.openDebugPane"),sourceFileMap:e}}get hoverActions(){return{enable:this.get("hover.actions.enable"),implementations:this.get("hover.actions.implementations.enable"),references:this.get("hover.actions.references.enable"),run:this.get("hover.actions.run.enable"),debug:this.get("hover.actions.debug.enable"),gotoTypeDef:this.get("hover.actions.gotoTypeDef.enable")}}get currentExtensionIsNightly(){return this.package.releaseTag===ES}};async function Cm(n){let e=[["assist.allowMergingIntoGlobImports","imports.merge.glob"],["assist.exprFillDefault","assist.expressionFillDefault"],["assist.importEnforceGranularity","imports.granularity.enforce"],["assist.importGranularity","imports.granularity.group"],["assist.importMergeBehavior","imports.granularity.group"],["assist.importMergeBehaviour","imports.granularity.group"],["assist.importGroup","imports.group.enable"],["assist.importPrefix","imports.prefix"],["primeCaches.enable","cachePriming.enable"],["cache.warmup","cachePriming.enable"],["cargo.loadOutDirsFromCheck","cargo.buildScripts.enable"],["cargo.runBuildScripts","cargo.buildScripts.enable"],["cargo.runBuildScriptsCommand","cargo.buildScripts.overrideCommand"],["cargo.useRustcWrapperForBuildScripts","cargo.buildScripts.useRustcWrapper"],["completion.snippets","completion.snippets.custom"],["diagnostics.enableExperimental","diagnostics.experimental.enable"],["experimental.procAttrMacros","procMacro.attributes.enable"],["highlighting.strings","semanticHighlighting.strings.enable"],["highlightRelated.breakPoints","highlightRelated.breakPoints.enable"],["highlightRelated.exitPoints","highlightRelated.exitPoints.enable"],["highlightRelated.yieldPoints","highlightRelated.yieldPoints.enable"],["highlightRelated.references","highlightRelated.references.enable"],["hover.documentation","hover.documentation.enable"],["hover.linksInHover","hover.links.enable"],["hoverActions.linksInHover","hover.links.enable"],["hoverActions.debug","hover.actions.debug.enable"],["hoverActions.enable","hover.actions.enable.enable"],["hoverActions.gotoTypeDef","hover.actions.gotoTypeDef.enable"],["hoverActions.implementations","hover.actions.implementations.enable"],["hoverActions.references","hover.actions.references.enable"],["hoverActions.run","hover.actions.run.enable"],["inlayHints.chainingHints","inlayHints.chainingHints.enable"],["inlayHints.closureReturnTypeHints","inlayHints.closureReturnTypeHints.enable"],["inlayHints.hideNamedConstructorHints","inlayHints.typeHints.hideNamedConstructor"],["inlayHints.parameterHints","inlayHints.parameterHints.enable"],["inlayHints.reborrowHints","inlayHints.reborrowHints.enable"],["inlayHints.typeHints","inlayHints.typeHints.enable"],["lruCapacity","lru.capacity"],["runnables.cargoExtraArgs","runnables.extraArgs"],["runnables.overrideCargo","runnables.command"],["rustcSource","rustc.source"],["rustfmt.enableRangeFormatting","rustfmt.rangeFormatting.enable"]];for(let[t,r]of e){let i=n.inspect(t);if(i!==void 0){let o=[{val:i.globalValue,langVal:i.globalLanguageValue,target:At.ConfigurationTarget.Global},{val:i.workspaceFolderValue,langVal:i.workspaceFolderLanguageValue,target:At.ConfigurationTarget.WorkspaceFolder},{val:i.workspaceValue,langVal:i.workspaceLanguageValue,target:At.ConfigurationTarget.Workspace}];for(let{val:s,langVal:a,target:c}of o){let l=g=>g!==void 0&&!(typeof g=="object"&&g!==null&&(g.hasOwnProperty("enable")||g.hasOwnProperty("custom")));l(s)&&(await n.update(r,s,c,!1),await n.update(t,void 0,c,!1)),l(a)&&(await n.update(r,a,c,!0),await n.update(t,void 0,c,!0))}}}}function wm(n){let e=new Set,t=new Set(Object.keys(n).map(c=>`env:${c}`)),r=Object.fromEntries(Object.entries(n).map(([c,l])=>{let g=new Set,v=new RegExp(/\${(?<depName>.+?)}/g),h;for(;h=v.exec(l);){let C=h.groups.depName;g.add(C),t.has(C)||e.add(C)}return[`env:${c}`,{deps:[...g],value:l}]})),i=new Set;for(let c of e){let l=/(?<prefix>.*?):(?<body>.+)/.exec(c);if(l){let{prefix:g,body:v}=l.groups;if(g==="env"){let h=v;r[c]={value:process.env[h]??"",deps:[]},i.add(c)}else r[c]={value:"${"+c+"}",deps:[]},i.add(c)}else r[c]={value:Rm(c),deps:[]}}let o=new Set(Object.keys(r)),s;do{s=o.size;for(let c of o)r[c].deps.every(l=>i.has(l))&&(r[c].value=r[c].value.replace(/\${(?<depName>.+?)}/g,(l,g)=>r[g].value),i.add(c),o.delete(c))}while(o.size>0&&o.size<s);let a={};for(let c of Object.keys(n))a[c]=r[`env:${c}`].value;return a}function Rm(n){let e={workspaceFolder:()=>{let t=At.workspace.workspaceFolders??[];return t.length===1||t.length>1?t[0].uri.fsPath:""},workspaceFolderBasename:()=>{let t=Rm("workspaceFolder");return t?ym.basename(t):""},cwd:()=>process.cwd(),execPath:()=>process.env.VSCODE_EXEC_PATH??process.execPath,pathSeparator:()=>ym.sep};return n in e?e[n]():"${"+n+"}"}var bm=require("crypto"),eo=new Map;setInterval(function(){let e=[...eo.keys()],t=e.slice(0,e.length-10);for(let r of t)eo.delete(r)},10*60*1e3);function xS(n){let e=(0,bm.randomUUID)();return eo.set(e,n),`[${n.title}](command:rust-analyzer.linkToCommand?${encodeURIComponent(JSON.stringify([e]))} '${n.tooltip}')`}function kS(n){let e=n.map(r=>(r.title?r.title+" ":"")+r.commands.map(xS).join(" | ")).join("___"),t=new vn.MarkdownString(e);return t.isTrusted=!0,t}async function Tm(n,e,t){let r=wm(Object.assign({},process.env,t)),i={command:n,options:{env:r}},o={run:i,debug:i},s=vn.window.createOutputChannel("Rust Analyzer Language Server Trace"),a=vn.workspace.getConfiguration("rust-analyzer");await Cm(a).catch(g=>{vn.window.showErrorMessage(`Failed updating old config keys: ${g.message}`)}),e.kind==="Detached Files"&&(a=Fr({detachedFiles:e.files.map(g=>g.uri.fsPath)},a));let c={documentSelector:[{scheme:"file",language:"rust"}],initializationOptions:a,diagnosticCollectionName:"rustc",traceOutputChannel:s,middleware:{async provideHover(g,v,h,C){var I;let b=vn.window.activeTextEditor,k=(I=b==null?void 0:b.selection)!=null&&I.contains(v)?l.code2ProtocolConverter.asRange(b.selection):l.code2ProtocolConverter.asPosition(v);return l.sendRequest(Fg,{textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(g),position:k},h).then(O=>{let M=l.protocol2CodeConverter.asHover(O);if(M){let q=O.actions;q&&M.contents.push(kS(q))}return M},O=>(l.handleFailedRequest(En.HoverRequest.type,h,O,null),Promise.resolve(null)))},async provideCodeActions(g,v,h,C,b){let k={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(g),range:l.code2ProtocolConverter.asRange(v),context:await l.code2ProtocolConverter.asCodeActionContext(h,C)};return l.sendRequest(En.CodeActionRequest.type,k,C).then(async I=>{if(I===null)return;let O=[],M=new Map;for(let q of I){if(En.CodeAction.is(q)){Xi(!q.command,"We don't expect to receive commands in CodeActions");let Y=await l.protocol2CodeConverter.asCodeAction(q,C);O.push(Y);continue}Xi(qS(q),"We don't expect edits or commands here");let $=l.protocol2CodeConverter.asCodeActionKind(q.kind),K=new vn.CodeAction(q.title,$),fe=q.group;if(K.command={command:"rust-analyzer.resolveCodeAction",title:q.title,arguments:[q]},K.edit=new Fc.WorkspaceEdit,fe){let Y=M.get(fe);Y||(Y={index:O.length,items:[]},M.set(fe,Y),O.push(K)),Y.items.push(K)}else O.push(K)}for(let[q,{index:$,items:K}]of M)if(K.length===1)O[$]=K[0];else{let fe=new vn.CodeAction(q);fe.kind=K[0].kind,fe.command={command:"rust-analyzer.applyActionGroup",title:"",arguments:[K.map(Y=>({label:Y.title,arguments:Y.command.arguments[0]}))]},fe.edit=new Fc.WorkspaceEdit,O[$]=fe}return O},I=>{})}},markdown:{supportHtml:!0}},l=new En.LanguageClient("rust-analyzer","Rust Analyzer Language Server",o,c);return l.registerFeature(new Dm),l}var Dm=class{fillClientCapabilities(e){let t=e.experimental??{};t.snippetTextEdit=!0,t.codeActionGroup=!0,t.hoverActions=!0,t.serverStatusNotification=!0,t.commands={commands:["rust-analyzer.runSingle","rust-analyzer.debugSingle","rust-analyzer.showReferences","rust-analyzer.gotoLocation","editor.action.triggerParameterHints"]},e.experimental=t}initialize(e,t){}dispose(){}};function qS(n){let e=n;return e&&Zi.string(e.title)&&(e.diagnostics===void 0||Zi.typedArray(e.diagnostics,En.Diagnostic.is))&&(e.kind===void 0||Zi.string(e.kind))&&e.edit===void 0&&e.command===void 0}function Pm(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer-status://status");this.eventEmitter=new A.EventEmitter}provideTextDocumentContent(t){var o;if(!A.window.activeTextEditor)return"";let r={},i=(o=n.activeRustEditor)==null?void 0:o.document;return i!=null&&(r.textDocument=n.client.code2ProtocolConverter.asTextDocumentIdentifier(i)),n.client.sendRequest(kg,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer-status",e)),async()=>{let t=await A.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await A.window.showTextDocument(t,{viewColumn:A.ViewColumn.Two,preserveFocus:!0})}}function Em(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer-memory://memory");this.eventEmitter=new A.EventEmitter}provideTextDocumentContent(t){return A.window.activeTextEditor?n.client.sendRequest(qg).then(r=>`Per-query memory usage:
`+r+`
(note: database has been cleared)`):""}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer-memory",e)),async()=>{e.eventEmitter.fire(e.uri);let t=await A.workspace.openTextDocument(e.uri);return A.window.showTextDocument(t,A.ViewColumn.Two,!0)}}function xm(n){return async()=>{let e=n.client;!e||await e.sendRequest(Og)}}function km(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Wg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),positions:e.selections.map(i=>t.code2ProtocolConverter.asPosition(i.active))});e.selections=e.selections.map((i,o)=>{let s=t.protocol2CodeConverter.asPosition(r[o]),a=i.isEmpty?s:i.anchor;return new A.Selection(a,s)}),e.revealRange(e.selection)}}function qm(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Ug,{ranges:e.selections.map(o=>t.code2ProtocolConverter.asRange(o)),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)}),i=await t.protocol2CodeConverter.asTextEdits(r);await e.edit(o=>{i.forEach(s=>{o.replace(s.range,s.newText)})})}}function Om(n){return Nm(n,"Up")}function Im(n){return Nm(n,"Down")}function Nm(n,e){return async()=>{let t=n.activeRustEditor,r=n.client;if(!t||!r)return;let i=await r.sendRequest(Qg,{range:r.code2ProtocolConverter.asRange(t.selection),textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),direction:e});if(!i)return;let o=await r.protocol2CodeConverter.asTextEdits(i);await ms(t,o)}}function Fm(n){async function e(){let t=n.activeRustEditor,r=n.client;if(!t||!r)return!1;let i=await r.sendRequest(Kg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(t.document),position:r.code2ProtocolConverter.asPosition(t.selection.active)}).catch(s=>null);if(!i)return!1;let o=await r.protocol2CodeConverter.asTextEdits(i);return await ms(t,o),!0}return async()=>{await e()||await A.commands.executeCommand("default:type",{text:`
`})}}function Lm(n){return async()=>{let e=A.window.activeTextEditor,t=n.client;if(!e||!t||!(Kn(e.document)||em(e.document)))return;let r=await t.sendRequest(zg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),position:t.code2ProtocolConverter.asPosition(e.selection.active)});if(!!r)if(r.length===1){let i=r[0],o=t.protocol2CodeConverter.asUri(i.targetUri),s=t.protocol2CodeConverter.asRange(i.targetRange),a=await A.workspace.openTextDocument(o),c=await A.window.showTextDocument(a);c.selection=new A.Selection(s.start,s.start),c.revealRange(s,A.TextEditorRevealType.InCenter)}else{let i=e.document.uri.toString(),o=t.code2ProtocolConverter.asPosition(e.selection.active);await Lc(t,i,o,r.map(s=>to.Location.create(s.targetUri,s.targetRange)))}}}function Am(n){return async()=>{let e=n.activeRustEditor,t=n.client;if(!e||!t)return;let r=await t.sendRequest(Xg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document)});if(!r)return;let i=t.protocol2CodeConverter.asUri(r.uri),o=t.protocol2CodeConverter.asRange(r.range),s=await A.workspace.openTextDocument(i),a=await A.window.showTextDocument(s);a.selection=new A.Selection(o.start,o.start),a.revealRange(o,A.TextEditorRevealType.InCenter)}}function Mm(n){return async()=>{let e=A.window.activeTextEditor,t=n.client;if(!e||!t)return;let r=e.selection.active,i=e.selections,o=n.client.code2ProtocolConverter.asTextDocumentIdentifier(e.document),s={value:"() ==>> ()",prompt:"Enter request, for example 'Foo($a) ==>> Foo::new($a)' ",validateInput:async c=>{try{await t.sendRequest(bc,{query:c,parseOnly:!0,textDocument:o,position:r,selections:i})}catch(l){return l.toString()}return null}},a=await A.window.showInputBox(s);!a||await A.window.withProgress({location:A.ProgressLocation.Notification,title:"Structured search replace in progress...",cancellable:!1},async(c,l)=>{let g=await t.sendRequest(bc,{query:a,parseOnly:!1,textDocument:o,position:r,selections:i});await A.workspace.applyEdit(await t.protocol2CodeConverter.asWorkspaceEdit(g,l))})}}function jm(n){return async()=>{let{stdout:e}=(0,_m.spawnSync)(n.serverPath,["--version"],{encoding:"utf8"}),t=e.slice(14).trim();A.window.showInformationMessage(`rust-analyzer version: ${t}`)}}function $m(n){return async()=>{let e=A.workspace.getConfiguration("editor.inlayHints",{languageId:"rust"}),t=!e.get("enabled");await e.update("enabled",t,A.ConfigurationTarget.Global)}}function Hm(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer://syntaxtree/tree.rast");this.eventEmitter=new A.EventEmitter;A.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),A.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Qi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&Pn(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor;if(!i)return"";let o=t.query==="range=true"&&!i.selection.isEmpty?n.client.code2ProtocolConverter.asRange(i.selection):null,s={textDocument:{uri:i.document.uri.toString()},range:o};return n.client.sendRequest(Lg,s,r)}get onDidChange(){return this.eventEmitter.event}};return new Ic(n),n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),n.pushCleanup(A.languages.setLanguageConfiguration("ra_syntax_tree",{brackets:[["[",")"]]})),async()=>{let t=A.window.activeTextEditor,i=!!t&&!t.selection.isEmpty?A.Uri.parse(`${e.uri.toString()}?range=true`):e.uri,o=await A.workspace.openTextDocument(i);e.eventEmitter.fire(i),await A.window.showTextDocument(o,{viewColumn:A.ViewColumn.Two,preserveFocus:!0})}}function Wm(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer://viewHir/hir.txt");this.eventEmitter=new A.EventEmitter;A.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),A.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Qi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&Pn(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:o.code2ProtocolConverter.asPosition(i.selection.active)};return o.sendRequest(Ag,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await A.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await A.window.showTextDocument(t,{viewColumn:A.ViewColumn.Two,preserveFocus:!0})}}function zm(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer://viewFileText/file.rs");this.eventEmitter=new A.EventEmitter;A.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),A.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Qi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&Pn(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s=o.code2ProtocolConverter.asTextDocumentIdentifier(i.document);return o.sendRequest(Mg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await A.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await A.window.showTextDocument(t,{viewColumn:A.ViewColumn.Two,preserveFocus:!0})}}function Um(n){let e=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer://viewItemTree/itemtree.rs");this.eventEmitter=new A.EventEmitter;A.workspace.onDidChangeTextDocument(this.onDidChangeTextDocument,this,n.subscriptions),A.window.onDidChangeActiveTextEditor(this.onDidChangeActiveTextEditor,this,n.subscriptions)}onDidChangeTextDocument(t){Kn(t.document)&&Qi(10).then(()=>this.eventEmitter.fire(this.uri))}onDidChangeActiveTextEditor(t){t&&Pn(t)&&this.eventEmitter.fire(this.uri)}provideTextDocumentContent(t,r){let i=n.activeRustEditor,o=n.client;if(!i||!o)return"";let s={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(i.document)};return o.sendRequest(jg,s,r)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer",e)),async()=>{let t=await A.workspace.openTextDocument(e.uri);e.eventEmitter.fire(e.uri),await A.window.showTextDocument(t,{viewColumn:A.ViewColumn.Two,preserveFocus:!0})}}function Km(n,e){return async()=>{let t=A.Uri.file(Sm.join(n.extensionPath,"node_modules")),r=A.window.createWebviewPanel("rust-analyzer.crate-graph","rust-analyzer crate graph",A.ViewColumn.Two,{enableScripts:!0,retainContextWhenHidden:!0,localResourceRoots:[t]}),i={full:e},o=await n.client.sendRequest($g,i),s=r.webview.asWebviewUri(t),a=`
            <!DOCTYPE html>
            <meta charset="utf-8">
            <head>
                <style>
                    /* Fill the entire view */
                    html, body { margin:0; padding:0; overflow:hidden }
                    svg { position:fixed; top:0; left:0; height:100%; width:100% }

                    /* Disable the graphviz backgroud and fill the polygons */
                    .graph > polygon { display:none; }
                    :is(.node,.edge) polygon { fill: white; }

                    /* Invert the line colours for dark themes */
                    body:not(.vscode-light) .edge path { stroke: white; }
                </style>
            </head>
            <body>
                <script type="text/javascript" src="${s}/d3/dist/d3.min.js"><\/script>
                <script type="text/javascript" src="${s}/@hpcc-js/wasm/dist/index.min.js"><\/script>
                <script type="text/javascript" src="${s}/d3-graphviz/build/d3-graphviz.min.js"><\/script>
                <div id="graph"></div>
                <script>
                    let graph = d3.select("#graph")
                                  .graphviz()
                                  .fit(true)
                                  .zoomScaleExtent([0.1, Infinity])
                                  .renderDot(\`${o}\`);

                    d3.select(window).on("click", (event) => {
                        if (event.ctrlKey) {
                            graph.resetZoom(d3.transition().duration(100));
                        }
                    });
                <\/script>
            </body>
            `;r.webview.html=a}}function Vm(n){return Km(n,!1)}function Bm(n){return Km(n,!0)}function Gm(n){function e(r){let i=`// Recursive expansion of ${r.name}! macro
`;return i+="// "+"=".repeat(i.length-3),i+=`

`,i+=r.expansion,i}let t=new class{constructor(){this.uri=A.Uri.parse("rust-analyzer://expandMacro/[EXPANSION].rs");this.eventEmitter=new A.EventEmitter}async provideTextDocumentContent(r){let i=A.window.activeTextEditor,o=n.client;if(!i||!o)return"";let s=i.selection.active,a=await o.sendRequest(Hg,{textDocument:n.client.code2ProtocolConverter.asTextDocumentIdentifier(i.document),position:s});return a==null?"Not available":e(a)}get onDidChange(){return this.eventEmitter.event}};return n.pushCleanup(A.workspace.registerTextDocumentContentProvider("rust-analyzer",t)),async()=>{let r=await A.workspace.openTextDocument(t.uri);return t.eventEmitter.fire(t.uri),A.window.showTextDocument(r,A.ViewColumn.Two,!0)}}function Xm(n){return async()=>n.client.sendRequest(Ng)}async function Lc(n,e,t,r){n&&await A.commands.executeCommand("editor.action.showReferences",A.Uri.parse(e),n.protocol2CodeConverter.asPosition(t),r.map(n.protocol2CodeConverter.asLocation))}function Qm(n){return async(e,t,r)=>{await Lc(n.client,e,t,r)}}function Jm(n){return async e=>{let t=await A.window.showQuickPick(e);!t||await A.commands.executeCommand("rust-analyzer.resolveCodeAction",t.arguments)}}function Ym(n){return async e=>{let t=n.client;if(t){let r=t.protocol2CodeConverter.asUri(e.targetUri),i=t.protocol2CodeConverter.asRange(e.targetSelectionRange);i=i.with({end:i.start}),await A.window.showTextDocument(r,{selection:i})}}}function Zm(n){return async()=>{let e=n.client,t=A.window.activeTextEditor;if(!t||!e)return;let r=t.selection.active,i={uri:t.document.uri.toString()},o=await e.sendRequest(Gg,{position:r,textDocument:i});o!=null&&await A.commands.executeCommand("vscode.open",A.Uri.parse(o))}}function ev(n){let e=n.client;return async t=>{var c;t.command=void 0;let r=await e.sendRequest(to.CodeActionResolveRequest.type,t);if(!r.edit)return;let i=r.edit,o=await e.protocol2CodeConverter.asWorkspaceEdit(i),s=io(Fr({},i),{documentChanges:(c=i.documentChanges)==null?void 0:c.filter(l=>"kind"in l)}),a=await e.protocol2CodeConverter.asWorkspaceEdit(s);await A.workspace.applyEdit(a),await _c(o),r.command!=null&&await A.commands.executeCommand(r.command.command,r.command.arguments)}}function tv(n){return async e=>{await _c(e)}}function nv(n){let e;return async()=>{let t=await Yi(n,e);if(!t)return;t.detail="rerun",e=t;let r=await qc(t.runnable,n.config);return await A.tasks.executeTask(r)}}function rv(n){let e=n.client;return async()=>{let t=n.activeRustEditor;!t||!e||await A.window.withProgress({location:A.ProgressLocation.Notification,title:"Looking for tests...",cancellable:!1},async(r,i)=>{let o=t.document.uri.toString(),s=e.code2ProtocolConverter.asPosition(t.selection.active),c=(await e.sendRequest(Bg,{textDocument:{uri:o},position:s})).map(l=>to.Location.create(l.runnable.location.targetUri,l.runnable.location.targetSelectionRange));await Lc(e,o,s,c)})}}function iv(n){return async e=>{if(!n.activeRustEditor)return;let r=await qc(e,n.config);return r.group=A.TaskGroup.Build,r.presentationOptions={reveal:A.TaskRevealKind.Always,panel:A.TaskPanelKind.Dedicated,clear:!0},A.tasks.executeTask(r)}}function ov(n){let e;return async()=>{let t=await Yi(n,e);if(!t)return;let r=Oc(t.runnable),i=["cargo",...r].join(" ");await A.env.clipboard.writeText(i),await A.window.showInformationMessage("Cargo invocation copied to the clipboard.")}}function sv(n){let e;return async()=>{let t=await Yi(n,e,!0);if(!!t)return t.detail="restart",e=t,await xc(n,t.runnable)}}function av(n){return async e=>{await xc(n,e)}}function cv(n){return async()=>{let e=await Yi(n,void 0,!0,!1);!e||await ws(n,e.runnable)}}function uv(n){return async e=>{let t=eo.get(e);if(n.client&&t){let{command:r,arguments:i=[]}=t;await A.commands.executeCommand(r,...i)}}}var yn=qe(require("vscode"));var ci=class{constructor(e,t,r,i,o){this.config=e;this.extCtx=t;this.client=r;this.serverPath=i;this.statusBar=o}static async create(e,t,r,i){let o=await Tm(r,i,e.serverExtraEnv),s=yn.window.createStatusBarItem(yn.StatusBarAlignment.Left);t.subscriptions.push(s),s.text="rust-analyzer",s.tooltip="ready",s.command="rust-analyzer.analyzerStatus",s.show();let a=new ci(e,t,o,r,s);return a.pushCleanup(o.start()),await o.onReady(),o.onNotification(Ig,c=>a.setServerStatus(c)),a}get activeRustEditor(){let e=yn.window.activeTextEditor;return e&&Pn(e)?e:void 0}get visibleRustEditors(){return yn.window.visibleTextEditors.filter(Pn)}registerCommand(e,t){let r=`rust-analyzer.${e}`,i=t(this),o=yn.commands.registerCommand(r,i);this.pushCleanup(o)}get extensionPath(){return this.extCtx.extensionPath}get globalState(){return this.extCtx.globalState}get subscriptions(){return this.extCtx.subscriptions}setServerStatus(e){this.statusBar.tooltip=e.message??"Ready";let t="";switch(e.health){case"ok":this.statusBar.color=void 0;break;case"warning":this.statusBar.tooltip+=`
Click to reload.`,this.statusBar.command="rust-analyzer.reloadWorkspace",this.statusBar.color=new yn.ThemeColor("notificationsWarningIcon.foreground"),t="$(warning) ";break;case"error":this.statusBar.tooltip+=`
Click to reload.`,this.statusBar.command="rust-analyzer.reloadWorkspace",this.statusBar.color=new yn.ThemeColor("notificationsErrorIcon.foreground"),t="$(error) ";break}e.quiescent||(t="$(sync~spin) "),this.statusBar.text=`${t} rust-analyzer`}pushCleanup(e){this.extCtx.subscriptions.push(e)}};var Ac=class{constructor(e){this.globalState=e;let{serverVersion:t}=this;Te.info("PersistentState:",{serverVersion:t})}get serverVersion(){return this.globalState.get("serverVersion")}async updateServerVersion(e){await this.globalState.update("serverVersion",e)}};var dv=require("child_process"),It,fv="inRustProject";async function pv(n){return await IS(n).catch(e=>{throw pe.window.showErrorMessage(`Cannot activate rust-analyzer: ${e.message}`),e})}async function IS(n){let e=new Nc(n),t=new Ac(n.globalState),r=await FS(n,e,t).catch(i=>{let o="bootstrap error. ";throw o+='See the logs in "OUTPUT > Rust Analyzer Client" (should open automatically). ',o+='To enable verbose logs use { "rust-analyzer.trace.extension": true }',Te.error("Bootstrap error",i),new Error(o)});if((pe.workspace.workspaceFolders||[]).length===0){let i=pe.workspace.textDocuments.filter(o=>Kn(o));if(i.length>0)It=await ci.create(e,n,r,{kind:"Detached Files",files:i});else throw new Error("no rust files are opened")}else It=await ci.create(e,n,r,{kind:"Workspace Folder"}),It.pushCleanup(fm(It.config));return await NS(n,It),$S(),It.pushCleanup(HS()),pe.workspace.onDidChangeConfiguration(i=>{var o;return(o=It==null?void 0:It.client)==null?void 0:o.sendNotification("workspace/didChangeConfiguration",{settings:""}).catch(Te.error)},null,It.subscriptions),{client:It.client}}async function NS(n,e){let t=pe.commands.registerCommand("rust-analyzer.onEnter",()=>pe.commands.executeCommand("default:type",{text:`
`}));n.subscriptions.push(t),await Dc(fv,!0),e.registerCommand("reload",r=>async()=>{for(pe.window.showInformationMessage("Reloading rust-analyzer..."),await hv();n.subscriptions.length>0;)try{n.subscriptions.pop().dispose()}catch(i){Te.error("Dispose error:",i)}await pv(n).catch(Te.error)}),e.registerCommand("analyzerStatus",Pm),e.registerCommand("memoryUsage",Em),e.registerCommand("shuffleCrateGraph",xm),e.registerCommand("reloadWorkspace",Xm),e.registerCommand("matchingBrace",km),e.registerCommand("joinLines",qm),e.registerCommand("parentModule",Lm),e.registerCommand("syntaxTree",Hm),e.registerCommand("viewHir",Wm),e.registerCommand("viewFileText",zm),e.registerCommand("viewItemTree",Um),e.registerCommand("viewCrateGraph",Vm),e.registerCommand("viewFullCrateGraph",Bm),e.registerCommand("expandMacro",Gm),e.registerCommand("run",nv),e.registerCommand("copyRunCommandLine",ov),e.registerCommand("debug",sv),e.registerCommand("newDebugConfig",cv),e.registerCommand("openDocs",Zm),e.registerCommand("openCargoToml",Am),e.registerCommand("peekTests",rv),e.registerCommand("moveItemUp",Om),e.registerCommand("moveItemDown",Im),t.dispose(),e.registerCommand("onEnter",Fm),e.registerCommand("ssr",Mm),e.registerCommand("serverVersion",jm),e.registerCommand("toggleInlayHints",$m),e.registerCommand("runSingle",iv),e.registerCommand("debugSingle",av),e.registerCommand("showReferences",Qm),e.registerCommand("applySnippetWorkspaceEdit",tv),e.registerCommand("resolveCodeAction",ev),e.registerCommand("applyActionGroup",Jm),e.registerCommand("gotoLocation",Ym),e.registerCommand("linkToCommand",uv)}async function hv(){await Dc(fv,void 0),await(It==null?void 0:It.client.stop()),It=void 0}async function FS(n,e,t){let r=await AS(n,e,t);if(!r)throw new Error("Rust Analyzer Language Server is not available. Please, ensure its [proper installation](https://rust-analyzer.github.io/manual.html#installation).");if(Te.info("Using server binary at",r),!tm(r))throw e.serverPath?new Error(`Failed to execute ${r} --version. \`config.server.path\` or \`config.serverPath\` has been set explicitly.            Consider removing this config or making a valid server binary available at that path.`):new Error(`Failed to execute ${r} --version`);return r}async function LS(n){await pe.window.withProgress({location:pe.ProgressLocation.Notification,title:"Patching rust-analyzer for NixOS"},async(e,t)=>{let r=`
            {srcStr, pkgs ? import <nixpkgs> {}}:
                pkgs.stdenv.mkDerivation {
                    name = "rust-analyzer";
                    src = /. + srcStr;
                    phases = [ "installPhase" "fixupPhase" ];
                    installPhase = "cp $src $out";
                    fixupPhase = ''
                    chmod 755 $out
                    patchelf --set-interpreter "$(cat $NIX_CC/nix-support/dynamic-linker)" $out
                    '';
                }
            `,i=pe.Uri.file(n.fsPath+"-orig");await pe.workspace.fs.rename(n,i,{overwrite:!0});try{e.report({message:"Patching executable",increment:20}),await new Promise((o,s)=>{var c,l;let a=(0,dv.exec)(`nix-build -E - --argstr srcStr '${i.fsPath}' -o '${n.fsPath}'`,(g,v,h)=>{g!=null?s(Error(h)):o(v)});(c=a.stdin)==null||c.write(r),(l=a.stdin)==null||l.end()})}finally{await pe.workspace.fs.delete(i)}})}async function AS(n,e,t){let r=MS(e);if(r)return r.startsWith("~/")?lv.homedir()+r.slice(1):r;if(e.package.releaseTag===null)return"rust-analyzer";let i=process.platform==="win32"?".exe":"",o=pe.Uri.joinPath(n.extensionUri,"server",`rust-analyzer${i}`);if(await pe.workspace.fs.stat(o).then(()=>!0,()=>!1)){let a=o;if(await jS()){await pe.workspace.fs.createDirectory(e.globalStorageUri).then();let c=pe.Uri.joinPath(e.globalStorageUri,`rust-analyzer${i}`),l=await pe.workspace.fs.stat(c).then(()=>!0,()=>!1);l&&e.package.version!==t.serverVersion&&(await pe.workspace.fs.delete(c),l=!1),l||(await pe.workspace.fs.copy(o,c),await LS(c)),a=c}return await t.updateServerVersion(e.package.version),a.fsPath}await t.updateServerVersion(void 0),await pe.window.showErrorMessage("Unfortunately we don't ship binaries for your platform yet. You need to manually clone the rust-analyzer repository and run `cargo xtask install --server` to build the language server from sources. If you feel that your platform should be supported, please create an issue about that [here](https://github.com/rust-analyzer/rust-analyzer/issues) and we will consider it.")}function MS(n){return process.env.__RA_LSP_SERVER_DEBUG??n.serverPath}async function jS(){try{return((await pe.workspace.fs.readFile(pe.Uri.file("/etc/os-release"))).toString().split(`
`).find(t=>t.startsWith("ID="))||"ID=linux").indexOf("nixos")!==-1}catch{return!1}}function $S(){pe.extensions.getExtension("rust-lang.rust")&&pe.window.showWarningMessage("You have both the rust-analyzer (rust-lang.rust-analyzer) and Rust (rust-lang.rust) plugins enabled. These are known to conflict and cause various functions of both plugins to not work correctly. You should disable one of them.","Got it").then(()=>{},console.error)}function HS(){let n=pe.IndentAction.None;return pe.languages.setLanguageConfiguration("rust",{onEnterRules:[{beforeText:/^\s*\/{3}.*$/,action:{indentAction:n,appendText:"/// "}},{beforeText:/^\s*\/{2}\!.*$/,action:{indentAction:n,appendText:"//! "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,afterText:/^\s*\*\/$/,action:{indentAction:pe.IndentAction.IndentOutdent,appendText:" * "}},{beforeText:/^\s*\/\*(\*|\!)(?!\/)([^\*]|\*(?!\/))*$/,action:{indentAction:n,appendText:" * "}},{beforeText:/^(\ \ )*\ \*(\ ([^\*]|\*(?!\/))*)?$/,action:{indentAction:n,appendText:"* "}},{beforeText:/^(\ \ )*\ \*\/\s*$/,action:{indentAction:n,removeText:1}}]})}0&&(module.exports={activate,deactivate});
